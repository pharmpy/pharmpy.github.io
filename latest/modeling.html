
<!DOCTYPE html>


<html lang="en" data-content_root="./" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Modeling &#8212; Pharmpy 0.105.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d10597a4" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css?v=a5c4661c" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=63439bfe" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script src="_static/documentation_options.js?v=01b3f400"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/thebelab-helper.js"></script>
    <script src="_static/tabs.js?v=3030b3cb"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'modeling';</script>
    <link rel="icon" href="_static/Pharmpy_symbol.svg"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The Pharmpy model" href="model.html" />
    <link rel="prev" title="Model estimation and results" href="modelfit.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Dec 07, 2023"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
    
    <img src="_static/Pharmpy_logo.svg" class="logo__image only-light" alt="Pharmpy 0.105.1 documentation - Home"/>
    <script>document.write(`<img src="_static/Pharmpy_logo_dark.svg" class="logo__image only-dark" alt="Pharmpy 0.105.1 documentation - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="contributors.html">
                        About us
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="getting_started.html">
                        Getting started
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="user_guide.html">
                        User guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="api.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="changelog.html">
                        Changelog
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="contribute.html">
                        Contribute
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="citation.html">
                        References and citation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="license.html">
                        License
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="developers.html">
                        Documentation for developers
                      </a>
                    </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pharmpy/pharmpy" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pharmpy/pharmpy/issues" title="Report issues" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa fa-comments fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Report issues</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="contributors.html">
                        About us
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="getting_started.html">
                        Getting started
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="user_guide.html">
                        User guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="api.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="changelog.html">
                        Changelog
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links-2">
                    More
                </button>
                <ul id="pst-nav-more-links-2" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="contribute.html">
                        Contribute
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="citation.html">
                        References and citation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="license.html">
                        License
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="developers.html">
                        Documentation for developers
                      </a>
                    </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pharmpy/pharmpy" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pharmpy/pharmpy/issues" title="Report issues" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa fa-comments fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Report issues</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="tools.html">Tools</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="amd.html">AMD - automatic model development</a></li>
<li class="toctree-l2"><a class="reference internal" href="modelsearch.html">Modelsearch - search for best structural model for a PK model</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="structsearch.html">Structsearch - search for best structural model for PKPD, drug metabolite and TMDD models</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="pkpd.html">PKPD</a></li>
<li class="toctree-l3"><a class="reference internal" href="tmdd.html">TMDD</a></li>
<li class="toctree-l3"><a class="reference internal" href="drug_metabolite.html">Drug Metabolite</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="iivsearch.html">IIVsearch - search for best IIV structure (both variance and covariance)</a></li>
<li class="toctree-l2"><a class="reference internal" href="iovsearch.html">IOVsearch - search for best IOV structure and trim IIV</a></li>
<li class="toctree-l2"><a class="reference internal" href="covsearch.html">COVsearch - identify covariates that explain some of the IIV</a></li>
<li class="toctree-l2"><a class="reference internal" href="ruvsearch.html">RUVsearch - search for best residual error model</a></li>
<li class="toctree-l2"><a class="reference internal" href="allometry.html">allometry - add allometric scaling</a></li>
<li class="toctree-l2"><a class="reference internal" href="estmethod.html">estmethod - compare estimation methods and/or solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="retries.html">Retries - Rerun a model with tweaked initial estimates</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modelfit.html">Model estimation and results</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">The Pharmpy model</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Datasets in Pharmpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_r.html">Pharmpy in R</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">The Pharmpy command line interface</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="psn_tools.html">PsN with Pharmpy</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="bootstrap.html">Bootstrap</a></li>
<li class="toctree-l2"><a class="reference internal" href="cdd.html">Case deletion diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="crossval.html">Crossval</a></li>
<li class="toctree-l2"><a class="reference internal" href="frem.html">FREM</a></li>
<li class="toctree-l2"><a class="reference internal" href="linearize.html">Linearize</a></li>
<li class="toctree-l2"><a class="reference internal" href="qa.html">QA</a></li>
<li class="toctree-l2"><a class="reference internal" href="psn_resmod.html">resmod</a></li>
<li class="toctree-l2"><a class="reference internal" href="scm.html">scm</a></li>
<li class="toctree-l2"><a class="reference internal" href="simeval.html">Simeval</a></li>
</ul>
</li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="user_guide.html" class="nav-link">User guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Modeling</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="modeling">
<span id="id1"></span><h1>Modeling<a class="headerlink" href="#modeling" title="Link to this heading">#</a></h1>
<p>While the <a class="reference internal" href="api/pharmpy.model.Model.html#pharmpy.model.Model" title="pharmpy.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">pharmpy.model.Model</span></code></a> class can be directly manipulated
with low level operations the modeling module offers higher level operations and transformations for building a model.
These transformations are also available via the Pharmpy command line interface. To read more about these functions
such as how the initial estimates of parameters are chosen, see their respective <a class="reference internal" href="api.html#api-ref"><span class="std std-ref">API documentation</span></a>.</p>
<div class="pharmpy-snippet docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
</div>
</div>
</div>
<section id="basic-functions">
<h2>Basic functions<a class="headerlink" href="#basic-functions" title="Link to this heading">#</a></h2>
<section id="reading-and-writing-models">
<h3>Reading and writing models<a class="headerlink" href="#reading-and-writing-models" title="Link to this heading">#</a></h3>
<p>Pharmpy can read in NONMEM models using the <a class="reference internal" href="api/pharmpy.modeling.read_model.html#pharmpy.modeling.read_model" title="pharmpy.modeling.read_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.read_model()</span></code></a> function:</p>
<div class="pharmpy-snippet docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-0-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-0-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-0-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s1">&#39;pheno.mod&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_model</span><span class="p">(</span><span class="n">path</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s">&#39;pheno.mod&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
</div>
</div>
</div>
<p>To inspect the read in model code, the <a class="reference internal" href="api/pharmpy.modeling.print_model_code.html#pharmpy.modeling.print_model_code" title="pharmpy.modeling.print_model_code"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.print_model_code()</span></code></a> function is available:</p>
<div class="pharmpy-snippet docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-1-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-1-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-1-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">print_model_code</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-1-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print_model_code</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
</div>
</div>
</div>
<p>If the model code is in a string variable it can be read in directly using
<a class="reference internal" href="api/pharmpy.modeling.read_model_from_string.html#pharmpy.modeling.read_model_from_string" title="pharmpy.modeling.read_model_from_string"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.read_model_from_string()</span></code></a>.</p>
<div class="pharmpy-snippet docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-2-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-2-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-2-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;$PROBLEM base model</span><span class="se">\n</span><span class="s1">$INPUT ID DV TIME</span><span class="se">\n</span><span class="s1">$DATA file.csv IGNORE=@</span><span class="se">\n</span><span class="s1">$PRED Y = THETA(1) + ETA(1) + ERR(1)</span><span class="se">\n</span><span class="s1">$THETA 0.1</span><span class="se">\n</span><span class="s1">$OMEGA 0.01</span><span class="se">\n</span><span class="s1">$SIGMA 1</span><span class="se">\n</span><span class="s1">$ESTIMATION METHOD=1&#39;</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">read_model_from_string</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">code</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&#39;$PROBLEM base model\n$INPUT ID DV TIME\n$DATA file.csv IGNORE=@\n$PRED Y &lt;- THETA(1) + ETA(1) + ERR(1)\n$THETA 0.1\n$OMEGA 0.01\n$SIGMA 1\n$ESTIMATION METHOD=1&#39;</span>
<span class="n">model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_model_from_string</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
</div>
</div>
</div>
<p>Finally, any Pharmpy model can be written to a file with <a class="reference internal" href="api/pharmpy.modeling.write_model.html#pharmpy.modeling.write_model" title="pharmpy.modeling.write_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.write_model()</span></code></a>:</p>
<div class="pharmpy-snippet docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-3-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-3-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-3-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">write_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;mymodel.mod&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">write_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;mymodel.mod&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
</div>
</section>
<section id="loading-example-models">
<h3>Loading example models<a class="headerlink" href="#loading-example-models" title="Link to this heading">#</a></h3>
<p>Pharmpy has example models with example datasets that can be accessed using
<a class="reference internal" href="api/pharmpy.modeling.load_example_model.html#pharmpy.modeling.load_example_model" title="pharmpy.modeling.load_example_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.load_example_model()</span></code></a>:</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-4-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-4-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-4-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-4-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-4-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-4-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">load_example_model</span><span class="p">(</span><span class="s1">&#39;pheno&#39;</span><span class="p">)</span>
<span class="n">print_model_code</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-4-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-4-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">load_example_model</span><span class="p">(</span><span class="s">&#39;pheno&#39;</span><span class="p">)</span>
<span class="nf">print_model_code</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>$PROBLEM PHENOBARB SIMPLE MODEL
$DATA &#39;pheno.dta&#39; IGNORE=@
$INPUT ID TIME AMT WGT APGR DV FA1 FA2
$SUBROUTINE ADVAN1 TRANS2

$PK
IF(AMT.GT.0) BTIME=TIME
TAD=TIME-BTIME
TVCL=THETA(1)*WGT
TVV=THETA(2)*WGT
IF(APGR.LT.5) TVV=TVV*(1+THETA(3))
CL=TVCL*EXP(ETA(1))
V=TVV*EXP(ETA(2))
S1=V

$ERROR
W=F
Y=F+W*EPS(1)
IPRED=F
IRES=DV-IPRED
IWRES=IRES/W

$THETA (0,0.00469307) ; PTVCL
$THETA (0,1.00916) ; PTVV
$THETA (-.99,.1)
$OMEGA DIAGONAL(2)
 0.0309626  ;       IVCL
 0.031128  ;        IVV

$SIGMA 0.013241
$ESTIMATION METHOD=1 INTERACTION
$COVARIANCE UNCONDITIONAL
$TABLE ID TIME AMT WGT APGR IPRED PRED TAD CWRES NPDE NOAPPEND
       NOPRINT ONEHEADER FILE=pheno.tab

</pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="converting-models">
<h3>Converting models<a class="headerlink" href="#converting-models" title="Link to this heading">#</a></h3>
<p>Pharmpy supports the estimation software NONMEM, nlmixr2 and rxODE2, and a Pharmpy model can be converted into those
formats using <a class="reference internal" href="api/pharmpy.modeling.convert_model.html#pharmpy.modeling.convert_model" title="pharmpy.modeling.convert_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.convert_model()</span></code></a>:</p>
<div class="pharmpy-snippet docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-5-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-5-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-5-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-5-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-5-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-5-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">model_nlmixr</span> <span class="o">=</span> <span class="n">convert_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;nlmixr&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-5-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-5-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">model_nlmixr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">convert_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;nlmixr&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
</div>
</div>
</div>
<p>Then we can inspect the new model code:</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-6-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-6-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-6-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-6-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-6-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-6-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">print_model_code</span><span class="p">(</span><span class="n">model_nlmixr</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-6-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-6-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print_model_code</span><span class="p">(</span><span class="n">model_nlmixr</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>pheno &lt;- function() {
    ini({
        # --- THETAS ---
        PTVCL &lt;- c(0.0, 0.00469307, Inf)
        PTVV &lt;- c(0.0, 1.00916, Inf)
        THETA_3 &lt;- c(-0.99, 0.1, Inf)
        
        # --- ETAS ---
        ETA_1 ~ 0.0309626
        ETA_2 ~ 0.031128
        
        # --- EPSILONS ---
        SIGMA_1_1 &lt;- c(0.0, 0.013241, Inf)
    })
    model({
        if (amt &gt; 0) {
            Btime &lt;- time
        } else {
            Btime &lt;- 0
        }
        TAD &lt;- -Btime + time
        TVCL &lt;- PTVCL*WGT
        TVV &lt;- PTVV*WGT
        if (APGR &lt; 5) {
            TVV &lt;- TVV*(THETA_3 + 1)
        } else {
            TVV &lt;- TVV
        }
        CL &lt;- TVCL*exp(ETA_1)
        V &lt;- TVV*exp(ETA_2)
        S1 &lt;- V
        
        # --- DIFF EQUATIONS ---
        d/dt(A_CENTRAL) = -CL*A_CENTRAL/V
        
        F &lt;- A_CENTRAL/S1
        W &lt;- F
        Y &lt;- F
        add_error &lt;- 0
        prop_error &lt;- SIGMA_1_1
        Y ~ add(add_error) + prop(prop_error)
        IPRED &lt;- F
        IRES &lt;- DV - IPRED
        IWRES &lt;- IRES/W
    })
}

fit &lt;- nlmixr2(pheno, dataset, est = &quot;focei&quot;)
</pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="create-basic-models">
<span id="basic-models"></span><h2>Create basic models<a class="headerlink" href="#create-basic-models" title="Link to this heading">#</a></h2>
<p>As a starting point for this user guide, we will create a basic PK model using the function
<a class="reference internal" href="api/pharmpy.modeling.create_basic_pk_model.html#pharmpy.modeling.create_basic_pk_model" title="pharmpy.modeling.create_basic_pk_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.create_basic_pk_model()</span></code></a>:</p>
<div class="pharmpy-snippet docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-7-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-7-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-7-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-7-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-7-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-7-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">dataset_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">/</span> <span class="s1">&#39;pheno.dta&#39;</span>
<span class="n">model_start</span> <span class="o">=</span> <span class="n">create_basic_pk_model</span><span class="p">(</span><span class="n">administration</span><span class="o">=</span><span class="s1">&#39;oral&#39;</span><span class="p">,</span>
                                    <span class="n">dataset_path</span><span class="o">=</span><span class="n">dataset_path</span><span class="p">,</span>
                                    <span class="n">cl_init</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
                                    <span class="n">vc_init</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                                    <span class="n">mat_init</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-7-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-7-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">dataset_path</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s">&#39;pheno.dta&#39;</span>
<span class="n">model_start</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">create_basic_pk_model</span><span class="p">(</span><span class="n">administration</span><span class="o">=</span><span class="s">&#39;oral&#39;</span><span class="p">,</span>
<span class="w">                                    </span><span class="n">dataset_path</span><span class="o">=</span><span class="n">dataset_path</span><span class="p">,</span>
<span class="w">                                    </span><span class="n">cl_init</span><span class="o">=</span><span class="m">0.01</span><span class="p">,</span>
<span class="w">                                    </span><span class="n">vc_init</span><span class="o">=</span><span class="m">1.0</span><span class="p">,</span>
<span class="w">                                    </span><span class="n">mat_init</span><span class="o">=</span><span class="m">0.1</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
</div>
</div>
</div>
<p>We can examine the model statements of the model:</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-8-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-8-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-8-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-8-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-8-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-8-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">model_start</span><span class="o">.</span><span class="n">statements</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-8-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-8-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">model_start</span><span class="o">$</span><span class="n">statements</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html">\begin{align*}MAT &= POP_{MAT} \cdot e^{\eta_{MAT}}\\CL &= POP_{CL} \cdot e^{\eta_{CL}}\\VC &= POP_{VC} \cdot e^{\eta_{VC}}\\\end{align*}<pre>Bolus(AMT, admid=1) → DEPOT 
┌─────┐        ┌───────┐        
│DEPOT│──1/MAT→│CENTRAL│──CL/VC→
└─────┘        └───────┘</pre>\begin{align*}IPRED &= \frac{A_{CENTRAL}{\left(t \right)}}{VC}\\IPREDADJ &= \begin{cases} 2.225 \cdot 10^{-16} & \text{for}\: IPRED &= 0 \\IPRED & \text{otherwise} \end{cases}\\Y &= IPRED + IPREDADJ \cdot \epsilon_{p}\\\end{align*}</div></div>
</div>
</div>
<p>We can see that the model is a one compartment model with first order absorption and elimination and no absorption
delay. Examining the random variables:</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-9-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-9-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-9-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-9-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-9-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-9-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">model_start</span><span class="o">.</span><span class="n">random_variables</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-9-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-9-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">model_start</span><span class="o">$</span><span class="n">random_variables</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{align*}
\displaystyle \left[\begin{matrix}\eta_{CL}\\\eta_{VC}\end{matrix}\right] &amp; \sim \mathcal{N} \left(\displaystyle \left[\begin{matrix}0\\0\end{matrix}\right],\displaystyle \left[\begin{matrix}IIV_{CL} &amp; IIV_{CL IIV VC}\\IIV_{CL IIV VC} &amp; IIV_{VC}\end{matrix}\right]\right) \\ \displaystyle \epsilon_{p} &amp; \sim  \mathcal{N} \left(\displaystyle 0,\displaystyle \sigma\right) \\ \displaystyle \eta_{MAT} &amp; \sim  \mathcal{N} \left(\displaystyle 0,\displaystyle IIV_{MAT}\right)\end{align*}\end{split}\]</div>
</div>
</div>
</div>
<p>Next we can convert the start model from a generic Pharmpy model to a NONMEM model:</p>
<div class="pharmpy-snippet docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-10-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-10-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-10-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-10-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-10-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-10-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">model_start</span> <span class="o">=</span> <span class="n">convert_model</span><span class="p">(</span><span class="n">model_start</span><span class="p">,</span> <span class="s1">&#39;nonmem&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-10-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-10-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">model_start</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">convert_model</span><span class="p">(</span><span class="n">model_start</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;nonmem&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
</div>
</div>
</div>
<p>We can then examine the NONMEM model code:</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-11-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-11-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-11-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-11-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-11-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-11-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">print_model_code</span><span class="p">(</span><span class="n">model_start</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-11-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-11-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print_model_code</span><span class="p">(</span><span class="n">model_start</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>$PROBLEM Start model
$INPUT ID TIME AMT WGT APGR DV FA1 FA2
$DATA file.csv IGNORE=@
$SUBROUTINES ADVAN2 TRANS2
$ABBR REPLACE ETA_CL=ETA(1)
$ABBR REPLACE ETA_VC=ETA(2)
$ABBR REPLACE ETA_MAT=ETA(3)
$PK
MAT = THETA(3)*EXP(ETA_MAT)
CL = THETA(1)*EXP(ETA_CL)
VC = THETA(2)*EXP(ETA_VC)
KA = 1/MAT
V = VC
$ERROR
IPRED = A(2)/VC
IF (IPRED.EQ.0) THEN
    IPREDADJ = 2.22500000000000E-16
ELSE
    IPREDADJ = IPRED
END IF
Y = IPRED + EPS(1)*IPREDADJ
$THETA  (0,0.01) ; POP_CL
$THETA  (0,1.0) ; POP_VC
$THETA  (0,0.1) ; POP_MAT
$OMEGA BLOCK(2)
0.1	; IIV_CL
0.01	; IIV_CL_IIV_VC
0.1	; IIV_VC
$OMEGA  0.1 ; IIV_MAT
$SIGMA  0.09 ; sigma
$ESTIMATION METHOD=COND INTER MAXEVAL=99999
$TABLE ID TIME DV CWRES CIPREDI PRED FILE=mytab NOAPPEND NOPRINT
</pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="modeling-transformations">
<h2>Modeling transformations<a class="headerlink" href="#modeling-transformations" title="Link to this heading">#</a></h2>
<p>In Pharmpy there are many different modeling functions that modify the model object. In Pharmpy, the model object and
all its attributes are immutable, meaning that the modeling functions always return a copy of the model object.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To see more information on how initial estimates are chosen etc., please check the <a class="reference internal" href="api.html#api-ref"><span class="std std-ref">API reference</span></a>.</p>
</div>
<section id="structural-model">
<h3>Structural model<a class="headerlink" href="#structural-model" title="Link to this heading">#</a></h3>
<p>There are many functions to change or examine the structural model of a PK dataset. Using the
<a class="reference internal" href="#basic-models"><span class="std std-ref">base model</span></a> from above, we’ll go through how to change different aspects of the structural model
step by step.</p>
<section id="absorption-rate">
<h4>Absorption rate<a class="headerlink" href="#absorption-rate" title="Link to this heading">#</a></h4>
<p>As an example, we’ll set the absorption of the start model to zero order absorption:</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-12-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-12-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-12-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-12-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-12-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-12-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">run1</span> <span class="o">=</span> <span class="n">set_zero_order_absorption</span><span class="p">(</span><span class="n">model_start</span><span class="p">)</span>
<span class="n">run1</span><span class="o">.</span><span class="n">statements</span><span class="o">.</span><span class="n">ode_system</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-12-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-12-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">run1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">set_zero_order_absorption</span><span class="p">(</span><span class="n">model_start</span><span class="p">)</span>
<span class="n">run1</span><span class="o">$</span><span class="n">statements</span><span class="o">$</span><span class="n">ode_system</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><pre>Infusion(AMT, admid=1, duration=D1) → CENTRAL 
┌───────┐       
│CENTRAL│──CL/V→
└───────┘</pre></div></div>
</div>
</div>
<p>And examine the updated NONMEM code:</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-13-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-13-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-13-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-13-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-13-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-13-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">print_model_code</span><span class="p">(</span><span class="n">run1</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-13-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-13-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print_model_code</span><span class="p">(</span><span class="n">run1</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>$PROBLEM Start model
$INPUT ID TIME AMT WGT APGR DV FA1 FA2 RATE
$DATA DUMMYPATH IGNORE=@
$SUBROUTINES ADVAN1 TRANS2
$ABBR REPLACE ETA_CL=ETA(1)
$ABBR REPLACE ETA_VC=ETA(2)
$ABBR REPLACE ETA_MAT=ETA(3)
$PK
MAT = THETA(3)*EXP(ETA_MAT)
CL = THETA(1)*EXP(ETA_CL)
VC = THETA(2)*EXP(ETA_VC)
V = VC
D1 = 2*MAT
$ERROR
IPRED = A(1)/VC
IF (IPRED.EQ.0) THEN
    IPREDADJ = 2.22500000000000E-16
ELSE
    IPREDADJ = IPRED
END IF
Y = IPRED + EPS(1)*IPREDADJ
$THETA  (0,0.01) ; POP_CL
$THETA  (0,1.0) ; POP_VC
$THETA  (0,0.1) ; POP_MAT
$OMEGA BLOCK(2)
0.1	; IIV_CL
0.01	; IIV_CL_IIV_VC
0.1	; IIV_VC
$OMEGA  0.1 ; IIV_MAT
$SIGMA  0.09 ; sigma
$ESTIMATION METHOD=COND INTER MAXEVAL=99999
$TABLE ID TIME DV CWRES CIPREDI PRED FILE=mytab NOAPPEND NOPRINT
</pre></div>
</div>
</div>
</div>
</div>
<p>Note that the ADVAN has been updated.</p>
<p>List of functions to change absorption rate:</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_bolus_absorption()</span></code></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.set_first_order_absorption.html#pharmpy.modeling.set_first_order_absorption" title="pharmpy.modeling.set_first_order_absorption"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_first_order_absorption()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.set_seq_zo_fo_absorption.html#pharmpy.modeling.set_seq_zo_fo_absorption" title="pharmpy.modeling.set_seq_zo_fo_absorption"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_seq_zo_fo_absorption()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.set_zero_order_absorption.html#pharmpy.modeling.set_zero_order_absorption" title="pharmpy.modeling.set_zero_order_absorption"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_zero_order_absorption()</span></code></a></p></li>
</ul>
</section>
<section id="absorption-delay">
<h4>Absorption delay<a class="headerlink" href="#absorption-delay" title="Link to this heading">#</a></h4>
<p>Next, we will add absorption delay.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-14-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-14-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-14-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-14-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-14-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-14-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">run2</span> <span class="o">=</span> <span class="n">add_lag_time</span><span class="p">(</span><span class="n">run1</span><span class="p">)</span>
<span class="n">run2</span><span class="o">.</span><span class="n">statements</span><span class="o">.</span><span class="n">ode_system</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-14-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-14-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">run2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">add_lag_time</span><span class="p">(</span><span class="n">run1</span><span class="p">)</span>
<span class="n">run2</span><span class="o">$</span><span class="n">statements</span><span class="o">$</span><span class="n">ode_system</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><pre>Infusion(AMT, admid=1, duration=D1) → CENTRAL 
┌──────────┐       
│ CENTRAL  │       
│tlag=ALAG1│──CL/V→
└──────────┘</pre></div></div>
</div>
</div>
<p>And examine the model code:</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-15-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-15-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-15-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-15-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-15-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-15-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">print_model_code</span><span class="p">(</span><span class="n">run2</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-15-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-15-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print_model_code</span><span class="p">(</span><span class="n">run2</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>$PROBLEM Start model
$INPUT ID TIME AMT WGT APGR DV FA1 FA2 RATE
$DATA DUMMYPATH IGNORE=@
$SUBROUTINES ADVAN1 TRANS2
$ABBR REPLACE ETA_CL=ETA(1)
$ABBR REPLACE ETA_VC=ETA(2)
$ABBR REPLACE ETA_MAT=ETA(3)
$PK
MDT = THETA(4)
MAT = THETA(3)*EXP(ETA_MAT)
CL = THETA(1)*EXP(ETA_CL)
VC = THETA(2)*EXP(ETA_VC)
V = VC
D1 = 2*MAT
ALAG1 = MDT
$ERROR
IPRED = A(1)/VC
IF (IPRED.EQ.0) THEN
    IPREDADJ = 2.22500000000000E-16
ELSE
    IPREDADJ = IPRED
END IF
Y = IPRED + EPS(1)*IPREDADJ
$THETA  (0,0.01) ; POP_CL
$THETA  (0,1.0) ; POP_VC
$THETA  (0,0.1) ; POP_MAT
$THETA  (0,0.5) ; POP_MDT
$OMEGA BLOCK(2)
0.1	; IIV_CL
0.01	; IIV_CL_IIV_VC
0.1	; IIV_VC
$OMEGA  0.1 ; IIV_MAT
$SIGMA  0.09 ; sigma
$ESTIMATION METHOD=COND INTER MAXEVAL=99999
$TABLE ID TIME DV CWRES CIPREDI PRED FILE=mytab NOAPPEND NOPRINT
</pre></div>
</div>
</div>
</div>
</div>
<p>List of functions to change elimination:</p>
<ul class="simple">
<li><p><a class="reference internal" href="api/pharmpy.modeling.add_lag_time.html#pharmpy.modeling.add_lag_time" title="pharmpy.modeling.add_lag_time"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.add_lag_time()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.remove_lag_time.html#pharmpy.modeling.remove_lag_time" title="pharmpy.modeling.remove_lag_time"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.remove_lag_time()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.set_transit_compartments.html#pharmpy.modeling.set_transit_compartments" title="pharmpy.modeling.set_transit_compartments"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_transit_compartments()</span></code></a></p></li>
</ul>
</section>
<section id="distribution">
<h4>Distribution<a class="headerlink" href="#distribution" title="Link to this heading">#</a></h4>
<p>It is possible to change the number of peripheral compartments. Let us add one peripheral compartment</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-16-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-16-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-16-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-16-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-16-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-16-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">run3</span> <span class="o">=</span> <span class="n">add_peripheral_compartment</span><span class="p">(</span><span class="n">run2</span><span class="p">)</span>
<span class="n">run3</span><span class="o">.</span><span class="n">statements</span><span class="o">.</span><span class="n">ode_system</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-16-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-16-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">run3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">add_peripheral_compartment</span><span class="p">(</span><span class="n">run2</span><span class="p">)</span>
<span class="n">run3</span><span class="o">$</span><span class="n">statements</span><span class="o">$</span><span class="n">ode_system</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><pre>Infusion(AMT, admid=1, duration=D1) → CENTRAL 
┌───────────┐        
│PERIPHERAL1│        
└───────────┘        
  ↑       │          
Q/V1     Q/V2        
  │       ↓          
┌───────────┐        
│  CENTRAL  │        
│tlag=ALAG1 │──CL/V1→
└───────────┘</pre></div></div>
</div>
</div>
<p>And examine the model code:</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-17-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-17-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-17-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-17-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-17-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-17-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">print_model_code</span><span class="p">(</span><span class="n">run3</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-17-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-17-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print_model_code</span><span class="p">(</span><span class="n">run3</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>$PROBLEM Start model
$INPUT ID TIME AMT WGT APGR DV FA1 FA2 RATE
$DATA DUMMYPATH IGNORE=@
$SUBROUTINES ADVAN3 TRANS4
$ABBR REPLACE ETA_CL=ETA(1)
$ABBR REPLACE ETA_VC=ETA(2)
$ABBR REPLACE ETA_MAT=ETA(3)
$PK
VP1 = THETA(6)
QP1 = THETA(5)
MDT = THETA(4)
MAT = THETA(3)*EXP(ETA_MAT)
CL = THETA(1)*EXP(ETA_CL)
VC = THETA(2)*EXP(ETA_VC)
V1 = VC
D1 = 2*MAT
ALAG1 = MDT
Q = QP1
V2 = VP1
$ERROR
IPRED = A(1)/VC
IF (IPRED.EQ.0) THEN
    IPREDADJ = 2.22500000000000E-16
ELSE
    IPREDADJ = IPRED
END IF
Y = IPRED + EPS(1)*IPREDADJ
$THETA  (0,0.01) ; POP_CL
$THETA  (0,1.0) ; POP_VC
$THETA  (0,0.1) ; POP_MAT
$THETA  (0,0.5) ; POP_MDT
$THETA  (0,0.01) ; POP_QP1
$THETA  (0,0.05) ; POP_VP1
$OMEGA BLOCK(2)
0.1	; IIV_CL
0.01	; IIV_CL_IIV_VC
0.1	; IIV_VC
$OMEGA  0.1 ; IIV_MAT
$SIGMA  0.09 ; sigma
$ESTIMATION METHOD=COND INTER MAXEVAL=99999
$TABLE ID TIME DV CWRES CIPREDI PRED FILE=mytab NOAPPEND NOPRINT
</pre></div>
</div>
</div>
</div>
</div>
<p>List of functions to change distribution:</p>
<ul class="simple">
<li><p><a class="reference internal" href="api/pharmpy.modeling.add_peripheral_compartment.html#pharmpy.modeling.add_peripheral_compartment" title="pharmpy.modeling.add_peripheral_compartment"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.add_peripheral_compartment()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.remove_peripheral_compartment.html#pharmpy.modeling.remove_peripheral_compartment" title="pharmpy.modeling.remove_peripheral_compartment"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.remove_peripheral_compartment()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.set_peripheral_compartments.html#pharmpy.modeling.set_peripheral_compartments" title="pharmpy.modeling.set_peripheral_compartments"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_peripheral_compartments()</span></code></a></p></li>
</ul>
</section>
<section id="elimination">
<h4>Elimination<a class="headerlink" href="#elimination" title="Link to this heading">#</a></h4>
<p>Now we will change to non-linear elimination.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-18-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-18-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-18-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-18-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-18-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-18-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">run4</span> <span class="o">=</span> <span class="n">set_michaelis_menten_elimination</span><span class="p">(</span><span class="n">run3</span><span class="p">)</span>
<span class="n">run4</span><span class="o">.</span><span class="n">statements</span><span class="o">.</span><span class="n">ode_system</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-18-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-18-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">run4</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">set_michaelis_menten_elimination</span><span class="p">(</span><span class="n">run3</span><span class="p">)</span>
<span class="n">run4</span><span class="o">$</span><span class="n">statements</span><span class="o">$</span><span class="n">ode_system</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><pre>Infusion(AMT, admid=1, duration=D1) → CENTRAL 
┌───────────┐                                      
│PERIPHERAL1│                                      
└───────────┘                                      
  ↑       │                                        
Q/V1     Q/V2                                      
  │       ↓                                        
┌───────────┐                                      
│  CENTRAL  │                                      
│tlag=ALAG1 │──CLMM*KM/(V1*(KM + A_CENTRAL(t)/V1))→
└───────────┘</pre></div></div>
</div>
</div>
<p>And examine the model code:</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-19-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-19-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-19-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-19-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-19-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-19-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">print_model_code</span><span class="p">(</span><span class="n">run4</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-19-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-19-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print_model_code</span><span class="p">(</span><span class="n">run4</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>$PROBLEM Start model
$INPUT ID TIME AMT WGT APGR DV FA1 FA2 RATE
$DATA DUMMYPATH IGNORE=@
$SUBROUTINES ADVAN13 TOL=9
$MODEL COMPARTMENT=(CENTRAL DEFDOSE) COMPARTMENT=(PERIPHERAL1)
$ABBR REPLACE ETA_CL=ETA(1)
$ABBR REPLACE ETA_VC=ETA(2)
$ABBR REPLACE ETA_MAT=ETA(3)
$PK
KM = THETA(7)
VP1 = THETA(6)
QP1 = THETA(5)
MDT = THETA(4)
MAT = THETA(3)*EXP(ETA_MAT)
CLMM = THETA(1)*EXP(ETA_CL)
VC = THETA(2)*EXP(ETA_VC)
V1 = VC
D1 = 2*MAT
ALAG1 = MDT
Q = QP1
V2 = VP1
$DES
DADT(1) = A(1)*(-CLMM*KM/(V1*(A(1)/V1 + KM)) - Q/V1) + A(2)*Q/V2
DADT(2) = A(1)*Q/V1 - A(2)*Q/V2
$ERROR
IPRED = A(1)/VC
IF (IPRED.EQ.0) THEN
    IPREDADJ = 2.22500000000000E-16
ELSE
    IPREDADJ = IPRED
END IF
Y = IPRED + EPS(1)*IPREDADJ
$THETA  (0,0.01) ; POP_CLMM
$THETA  (0,1.0) ; POP_VC
$THETA  (0,0.1) ; POP_MAT
$THETA  (0,0.5) ; POP_MDT
$THETA  (0,0.01) ; POP_QP1
$THETA  (0,0.05) ; POP_VP1
$THETA  (0,33.95,101.85000000000001) ; POP_KM
$OMEGA BLOCK(2)
0.1	; IIV_CLMM
0.01	; IIV_CLMM_IIV_VC
0.1	; IIV_VC
$OMEGA  0.1 ; IIV_MAT
$SIGMA  0.09 ; sigma
$ESTIMATION METHOD=COND INTER MAXEVAL=99999
$TABLE ID TIME DV CWRES CIPREDI PRED FILE=mytab NOAPPEND NOPRINT
</pre></div>
</div>
</div>
</div>
</div>
<p>List of functions to change elimination:</p>
<ul class="simple">
<li><p><a class="reference internal" href="api/pharmpy.modeling.set_first_order_elimination.html#pharmpy.modeling.set_first_order_elimination" title="pharmpy.modeling.set_first_order_elimination"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_first_order_elimination()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.set_michaelis_menten_elimination.html#pharmpy.modeling.set_michaelis_menten_elimination" title="pharmpy.modeling.set_michaelis_menten_elimination"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_michaelis_menten_elimination()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.set_mixed_mm_fo_elimination.html#pharmpy.modeling.set_mixed_mm_fo_elimination" title="pharmpy.modeling.set_mixed_mm_fo_elimination"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_mixed_mm_fo_elimination()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.set_zero_order_elimination.html#pharmpy.modeling.set_zero_order_elimination" title="pharmpy.modeling.set_zero_order_elimination"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_zero_order_elimination()</span></code></a></p></li>
</ul>
</section>
</section>
<section id="parameter-variability-model">
<h3>Parameter variability model<a class="headerlink" href="#parameter-variability-model" title="Link to this heading">#</a></h3>
<p>Pharmpy has multiple functions to change the parameter variability model. Using the
<a class="reference internal" href="#basic-models"><span class="std std-ref">base model</span></a> from above, we’ll go through different aspects of changing the parameter variability
model.</p>
<section id="adding-and-removing-parameter-variability">
<h4>Adding and removing parameter variability<a class="headerlink" href="#adding-and-removing-parameter-variability" title="Link to this heading">#</a></h4>
<p>It is possible to add and remove inter-individual variability (IIV) and inter-occasion variability (IOV) using
<a class="reference internal" href="api/pharmpy.modeling.add_iiv.html#pharmpy.modeling.add_iiv" title="pharmpy.modeling.add_iiv"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.add_iiv()</span></code></a> and <a class="reference internal" href="api/pharmpy.modeling.add_iov.html#pharmpy.modeling.add_iov" title="pharmpy.modeling.add_iov"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.add_iov()</span></code></a>. Since the start model from
<a class="reference internal" href="#basic-models"><span class="std std-ref">above</span></a> has IIV on all its parameters, we will start by removing an IIV using the
<a class="reference internal" href="api/pharmpy.modeling.remove_iiv.html#pharmpy.modeling.remove_iiv" title="pharmpy.modeling.remove_iiv"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.remove_iiv()</span></code></a> function.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-20-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-20-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-20-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-20-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-20-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-20-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">run1</span> <span class="o">=</span> <span class="n">remove_iiv</span><span class="p">(</span><span class="n">model_start</span><span class="p">,</span> <span class="s1">&#39;MAT&#39;</span><span class="p">)</span>
<span class="n">run1</span><span class="o">.</span><span class="n">random_variables</span><span class="o">.</span><span class="n">iiv</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-20-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-20-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">run1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">remove_iiv</span><span class="p">(</span><span class="n">model_start</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;MAT&#39;</span><span class="p">)</span>
<span class="n">run1</span><span class="o">$</span><span class="n">random_variables</span><span class="o">$</span><span class="n">iiv</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{align*}
\displaystyle \left[\begin{matrix}\eta_{CL}\\\eta_{VC}\end{matrix}\right] &amp; \sim \mathcal{N} \left(\displaystyle \left[\begin{matrix}0\\0\end{matrix}\right],\displaystyle \left[\begin{matrix}IIV_{CL} &amp; IIV_{CL IIV VC}\\IIV_{CL IIV VC} &amp; IIV_{VC}\end{matrix}\right]\right)\end{align*}\end{split}\]</div>
</div>
</div>
</div>
<p>Next, we add an IIV to the same parameter:</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-21-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-21-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-21-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-21-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-21-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-21-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">run2</span> <span class="o">=</span> <span class="n">add_iiv</span><span class="p">(</span><span class="n">run1</span><span class="p">,</span> <span class="s1">&#39;MAT&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">,</span> <span class="n">operation</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
<span class="n">run2</span><span class="o">.</span><span class="n">random_variables</span><span class="o">.</span><span class="n">iiv</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-21-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-21-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">run2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">add_iiv</span><span class="p">(</span><span class="n">run1</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;MAT&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;exp&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">operation</span><span class="o">=</span><span class="s">&#39;*&#39;</span><span class="p">)</span>
<span class="n">run2</span><span class="o">$</span><span class="n">random_variables</span><span class="o">$</span><span class="n">iiv</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{align*}
\displaystyle \left[\begin{matrix}\eta_{CL}\\\eta_{VC}\end{matrix}\right] &amp; \sim \mathcal{N} \left(\displaystyle \left[\begin{matrix}0\\0\end{matrix}\right],\displaystyle \left[\begin{matrix}IIV_{CL} &amp; IIV_{CL IIV VC}\\IIV_{CL IIV VC} &amp; IIV_{VC}\end{matrix}\right]\right) \\ \displaystyle \eta_{MAT} &amp; \sim  \mathcal{N} \left(\displaystyle 0,\displaystyle IIV_{MAT}\right)\end{align*}\end{split}\]</div>
</div>
</div>
</div>
<p>And examine the model code:</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-22-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-22-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-22-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-22-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-22-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-22-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">print_model_code</span><span class="p">(</span><span class="n">run2</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-22-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-22-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print_model_code</span><span class="p">(</span><span class="n">run2</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>$PROBLEM Start model
$INPUT ID TIME AMT WGT APGR DV FA1 FA2
$DATA file.csv IGNORE=@
$SUBROUTINES ADVAN2 TRANS2
$ABBR REPLACE ETA_CL=ETA(1)
$ABBR REPLACE ETA_VC=ETA(2)
$ABBR REPLACE ETA_MAT=ETA(3)
$PK
MAT = THETA(3)*EXP(ETA_MAT)
CL = THETA(1)*EXP(ETA_CL)
VC = THETA(2)*EXP(ETA_VC)
KA = 1/MAT
V = VC
$ERROR
IPRED = A(2)/VC
IF (IPRED.EQ.0) THEN
    IPREDADJ = 2.22500000000000E-16
ELSE
    IPREDADJ = IPRED
END IF
Y = IPRED + EPS(1)*IPREDADJ
$THETA  (0,0.01) ; POP_CL
$THETA  (0,1.0) ; POP_VC
$THETA  (0,0.1) ; POP_MAT
$OMEGA BLOCK(2)
0.1	; IIV_CL
0.01	; IIV_CL_IIV_VC
0.1	; IIV_VC
$OMEGA  0.09 ; IIV_MAT
$SIGMA  0.09 ; sigma
$ESTIMATION METHOD=COND INTER MAXEVAL=99999
$TABLE ID TIME DV CWRES CIPREDI PRED FILE=mytab NOAPPEND NOPRINT
</pre></div>
</div>
</div>
</div>
</div>
<p>List of functions to add and remove parameter variability:</p>
<ul class="simple">
<li><p><a class="reference internal" href="api/pharmpy.modeling.add_iiv.html#pharmpy.modeling.add_iiv" title="pharmpy.modeling.add_iiv"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.add_iiv()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.add_iov.html#pharmpy.modeling.add_iov" title="pharmpy.modeling.add_iov"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.add_iov()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.add_pk_iiv.html#pharmpy.modeling.add_pk_iiv" title="pharmpy.modeling.add_pk_iiv"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.add_pk_iiv()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.remove_iiv.html#pharmpy.modeling.remove_iiv" title="pharmpy.modeling.remove_iiv"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.remove_iiv()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.remove_iov.html#pharmpy.modeling.remove_iov" title="pharmpy.modeling.remove_iov"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.remove_iov()</span></code></a></p></li>
</ul>
</section>
<section id="adding-and-removing-covariance">
<h4>Adding and removing covariance<a class="headerlink" href="#adding-and-removing-covariance" title="Link to this heading">#</a></h4>
<p>As the next example, we will create a joint distribution using <a class="reference internal" href="api/pharmpy.modeling.create_joint_distribution.html#pharmpy.modeling.create_joint_distribution" title="pharmpy.modeling.create_joint_distribution"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.create_joint_distribution()</span></code></a>
where the eta on MAT is included:</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-23-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-23-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-23-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-23-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-23-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-23-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">run3</span> <span class="o">=</span> <span class="n">create_joint_distribution</span><span class="p">(</span><span class="n">run2</span><span class="p">)</span>
<span class="n">run3</span><span class="o">.</span><span class="n">random_variables</span><span class="o">.</span><span class="n">iiv</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-23-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-23-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">run3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">create_joint_distribution</span><span class="p">(</span><span class="n">run2</span><span class="p">)</span>
<span class="n">run3</span><span class="o">$</span><span class="n">random_variables</span><span class="o">$</span><span class="n">iiv</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{align*}
\displaystyle \left[\begin{matrix}\eta_{CL}\\\eta_{VC}\\\eta_{MAT}\end{matrix}\right] &amp; \sim \mathcal{N} \left(\displaystyle \left[\begin{matrix}0\\0\\0\end{matrix}\right],\displaystyle \left[\begin{matrix}IIV_{CL} &amp; IIV_{CL IIV VC} &amp; IIV_{CL IIV MAT}\\IIV_{CL IIV VC} &amp; IIV_{VC} &amp; IIV_{VC IIV MAT}\\IIV_{CL IIV MAT} &amp; IIV_{VC IIV MAT} &amp; IIV_{MAT}\end{matrix}\right]\right)\end{align*}\end{split}\]</div>
</div>
</div>
</div>
<p>And examine the model code:</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-24-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-24-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-24-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-24-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-24-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-24-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">print_model_code</span><span class="p">(</span><span class="n">run3</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-24-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-24-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print_model_code</span><span class="p">(</span><span class="n">run3</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>$PROBLEM Start model
$INPUT ID TIME AMT WGT APGR DV FA1 FA2
$DATA file.csv IGNORE=@
$SUBROUTINES ADVAN2 TRANS2
$ABBR REPLACE ETA_CL=ETA(1)
$ABBR REPLACE ETA_VC=ETA(2)
$ABBR REPLACE ETA_MAT=ETA(3)
$PK
MAT = THETA(3)*EXP(ETA_MAT)
CL = THETA(1)*EXP(ETA_CL)
VC = THETA(2)*EXP(ETA_VC)
KA = 1/MAT
V = VC
$ERROR
IPRED = A(2)/VC
IF (IPRED.EQ.0) THEN
    IPREDADJ = 2.22500000000000E-16
ELSE
    IPREDADJ = IPRED
END IF
Y = IPRED + EPS(1)*IPREDADJ
$THETA  (0,0.01) ; POP_CL
$THETA  (0,1.0) ; POP_VC
$THETA  (0,0.1) ; POP_MAT
$OMEGA BLOCK(3)
0.1	; IIV_CL
0.01	; IIV_CL_IIV_VC
0.1	; IIV_VC
0.0094868	; IIV_CL_IIV_MAT
0.0094868	; IIV_VC_IIV_MAT
0.09	; IIV_MAT
$SIGMA  0.09 ; sigma
$ESTIMATION METHOD=COND INTER MAXEVAL=99999
$TABLE ID TIME DV CWRES CIPREDI PRED FILE=mytab NOAPPEND NOPRINT
</pre></div>
</div>
</div>
</div>
</div>
<p>List of functions to change covariance structure:</p>
<ul class="simple">
<li><p><a class="reference internal" href="api/pharmpy.modeling.create_joint_distribution.html#pharmpy.modeling.create_joint_distribution" title="pharmpy.modeling.create_joint_distribution"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.create_joint_distribution()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.split_joint_distribution.html#pharmpy.modeling.split_joint_distribution" title="pharmpy.modeling.split_joint_distribution"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.split_joint_distribution()</span></code></a></p></li>
</ul>
</section>
<section id="eta-transformations">
<h4>Eta transformations<a class="headerlink" href="#eta-transformations" title="Link to this heading">#</a></h4>
<p>It is also possible to transform the etas using the following functions:</p>
<ul class="simple">
<li><p><a class="reference internal" href="api/pharmpy.modeling.transform_etas_boxcox.html#pharmpy.modeling.transform_etas_boxcox" title="pharmpy.modeling.transform_etas_boxcox"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.transform_etas_boxcox()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.transform_etas_john_draper.html#pharmpy.modeling.transform_etas_john_draper" title="pharmpy.modeling.transform_etas_john_draper"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.transform_etas_john_draper()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.transform_etas_tdist.html#pharmpy.modeling.transform_etas_tdist" title="pharmpy.modeling.transform_etas_tdist"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.transform_etas_tdist()</span></code></a></p></li>
</ul>
</section>
</section>
<section id="covariates-and-allometry">
<h3>Covariates and allometry<a class="headerlink" href="#covariates-and-allometry" title="Link to this heading">#</a></h3>
<p>Covariate effects may be applied to a model using the <a class="reference internal" href="api/pharmpy.modeling.add_covariate_effect.html#pharmpy.modeling.add_covariate_effect" title="pharmpy.modeling.add_covariate_effect"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.add_covariate_effect()</span></code></a>.</p>
<div class="pharmpy-snippet docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-25-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-25-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-25-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-25-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-25-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-25-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">run1</span> <span class="o">=</span> <span class="n">add_covariate_effect</span><span class="p">(</span><span class="n">model_start</span><span class="p">,</span> <span class="s1">&#39;CL&#39;</span><span class="p">,</span> <span class="s1">&#39;WGT&#39;</span><span class="p">,</span> <span class="s1">&#39;pow&#39;</span><span class="p">,</span> <span class="n">operation</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-25-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-25-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">run1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">add_covariate_effect</span><span class="p">(</span><span class="n">model_start</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;CL&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;WGT&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;pow&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">operation</span><span class="o">=</span><span class="s">&#39;*&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
</div>
</div>
</div>
<p>Here, <em>CL</em> indicates the name of the parameter onto which you want to apply the effect, <em>WGT</em> is the name of the
covariate, and <em>pow</em> (power function) is the effect you want to apply. The effect can be either
added or multiplied to the parameter, denoted by ‘*’ or ‘+’ (multiplied is default). We can examine the model code:</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-26-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-26-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-26-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-26-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-26-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-26-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">print_model_code</span><span class="p">(</span><span class="n">run1</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-26-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-26-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print_model_code</span><span class="p">(</span><span class="n">run1</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>$PROBLEM Start model
$INPUT ID TIME AMT WGT APGR DV FA1 FA2
$DATA file.csv IGNORE=@
$SUBROUTINES ADVAN2 TRANS2
$ABBR REPLACE ETA_CL=ETA(1)
$ABBR REPLACE ETA_VC=ETA(2)
$ABBR REPLACE ETA_MAT=ETA(3)
$PK
WGT_MEDIAN = 1.30000
MAT = THETA(3)*EXP(ETA_MAT)
CL = THETA(1)*EXP(ETA_CL)
CLWGT = (WGT/WGT_MEDIAN)**THETA(4)
CL = CL*CLWGT
VC = THETA(2)*EXP(ETA_VC)
KA = 1/MAT
V = VC
$ERROR
IPRED = A(2)/VC
IF (IPRED.EQ.0) THEN
    IPREDADJ = 2.22500000000000E-16
ELSE
    IPREDADJ = IPRED
END IF
Y = IPRED + EPS(1)*IPREDADJ
$THETA  (0,0.01) ; POP_CL
$THETA  (0,1.0) ; POP_VC
$THETA  (0,0.1) ; POP_MAT
$THETA  (-100,0.001,100000) ; POP_CLWGT
$OMEGA BLOCK(2)
0.1	; IIV_CL
0.01	; IIV_CL_IIV_VC
0.1	; IIV_VC
$OMEGA  0.1 ; IIV_MAT
$SIGMA  0.09 ; sigma
$ESTIMATION METHOD=COND INTER MAXEVAL=99999
$TABLE ID TIME DV CWRES CIPREDI PRED FILE=mytab NOAPPEND NOPRINT
</pre></div>
</div>
</div>
</div>
</div>
<p>Pharmpy also supports user formatted covariate effects.</p>
<div class="pharmpy-snippet docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-27-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-27-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-27-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-27-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-27-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-27-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">user_effect</span> <span class="o">=</span> <span class="s1">&#39;((cov/std) - median) * theta&#39;</span>
<span class="n">run2</span> <span class="o">=</span> <span class="n">add_covariate_effect</span><span class="p">(</span><span class="n">model_start</span><span class="p">,</span> <span class="s1">&#39;CL&#39;</span><span class="p">,</span> <span class="s1">&#39;WGT&#39;</span><span class="p">,</span> <span class="n">user_effect</span><span class="p">,</span> <span class="n">operation</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-27-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-27-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">user_effect</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&#39;((cov/std) - median) * theta&#39;</span>
<span class="n">run2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">add_covariate_effect</span><span class="p">(</span><span class="n">model_start</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;CL&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;WGT&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">user_effect</span><span class="p">,</span><span class="w"> </span><span class="n">operation</span><span class="o">=</span><span class="s">&#39;*&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
</div>
</div>
</div>
<p>The covariate is denoted as <em>cov</em>, the theta as <em>theta</em> (or, if multiple thetas: <em>theta1</em>, <em>theta2</em> etc.), and the mean,
median, and standard deviation as <em>mean</em>, <em>median</em>, and <em>std</em> respectively. This is in order for
the names to be substituted with the correct symbols.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-28-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-28-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-28-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-28-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-28-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-28-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">print_model_code</span><span class="p">(</span><span class="n">run2</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-28-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-28-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print_model_code</span><span class="p">(</span><span class="n">run2</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>$PROBLEM Start model
$INPUT ID TIME AMT WGT APGR DV FA1 FA2
$DATA file.csv IGNORE=@
$SUBROUTINES ADVAN2 TRANS2
$ABBR REPLACE ETA_CL=ETA(1)
$ABBR REPLACE ETA_VC=ETA(2)
$ABBR REPLACE ETA_MAT=ETA(3)
$PK
WGT_MEDIAN = 1.30000
WGT_STD = 0.704565
MAT = THETA(3)*EXP(ETA_MAT)
CL = THETA(1)*EXP(ETA_CL)
CLWGT = THETA(4)*(WGT/WGT_STD - WGT_MEDIAN)
CL = CL*CLWGT
VC = THETA(2)*EXP(ETA_VC)
KA = 1/MAT
V = VC
$ERROR
IPRED = A(2)/VC
IF (IPRED.EQ.0) THEN
    IPREDADJ = 2.22500000000000E-16
ELSE
    IPREDADJ = IPRED
END IF
Y = IPRED + EPS(1)*IPREDADJ
$THETA  (0,0.01) ; POP_CL
$THETA  (0,1.0) ; POP_VC
$THETA  (0,0.1) ; POP_MAT
$THETA  (-100000,0.001,100000) ; POP_CLWGT
$OMEGA BLOCK(2)
0.1	; IIV_CL
0.01	; IIV_CL_IIV_VC
0.1	; IIV_VC
$OMEGA  0.1 ; IIV_MAT
$SIGMA  0.09 ; sigma
$ESTIMATION METHOD=COND INTER MAXEVAL=99999
$TABLE ID TIME DV CWRES CIPREDI PRED FILE=mytab NOAPPEND NOPRINT
</pre></div>
</div>
</div>
</div>
</div>
<p>List of functions for covariates and allometry:</p>
<ul class="simple">
<li><p><a class="reference internal" href="api/pharmpy.modeling.add_allometry.html#pharmpy.modeling.add_allometry" title="pharmpy.modeling.add_allometry"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.add_allometry()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.add_covariate_effect.html#pharmpy.modeling.add_covariate_effect" title="pharmpy.modeling.add_covariate_effect"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.add_covariate_effect()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.remove_covariate_effect.html#pharmpy.modeling.remove_covariate_effect" title="pharmpy.modeling.remove_covariate_effect"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.remove_covariate_effect()</span></code></a></p></li>
</ul>
</section>
<section id="population-parameters">
<h3>Population parameters<a class="headerlink" href="#population-parameters" title="Link to this heading">#</a></h3>
<p>There are several functions to simplify changing population parameters, such as functions to change initial estimates
and fixing parameters. As a first example, let us fix some parameters with <a class="reference internal" href="api/pharmpy.modeling.fix_parameters.html#pharmpy.modeling.fix_parameters" title="pharmpy.modeling.fix_parameters"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.fix_parameters()</span></code></a>:</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-29-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-29-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-29-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-29-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-29-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-29-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">run1</span> <span class="o">=</span> <span class="n">fix_parameters</span><span class="p">(</span><span class="n">model_start</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;POP_CL&#39;</span><span class="p">,</span> <span class="s1">&#39;POP_VC&#39;</span><span class="p">])</span>
<span class="n">run1</span><span class="o">.</span><span class="n">parameters</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-29-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-29-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">run1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">fix_parameters</span><span class="p">(</span><span class="n">model_start</span><span class="p">,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;POP_CL&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;POP_VC&#39;</span><span class="p">))</span>
<span class="n">run1</span><span class="o">$</span><span class="n">parameters</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>value</th>
      <th>lower</th>
      <th>upper</th>
      <th>fix</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>POP_CL</th>
      <td>0.01</td>
      <td>0.0</td>
      <td>∞</td>
      <td>True</td>
    </tr>
    <tr>
      <th>POP_VC</th>
      <td>1.00</td>
      <td>0.0</td>
      <td>∞</td>
      <td>True</td>
    </tr>
    <tr>
      <th>IIV_CL</th>
      <td>0.10</td>
      <td>-∞</td>
      <td>∞</td>
      <td>False</td>
    </tr>
    <tr>
      <th>IIV_VC</th>
      <td>0.10</td>
      <td>-∞</td>
      <td>∞</td>
      <td>False</td>
    </tr>
    <tr>
      <th>sigma</th>
      <td>0.09</td>
      <td>-∞</td>
      <td>∞</td>
      <td>False</td>
    </tr>
    <tr>
      <th>IIV_CL_IIV_VC</th>
      <td>0.01</td>
      <td>-∞</td>
      <td>∞</td>
      <td>False</td>
    </tr>
    <tr>
      <th>POP_MAT</th>
      <td>0.10</td>
      <td>0.0</td>
      <td>∞</td>
      <td>False</td>
    </tr>
    <tr>
      <th>IIV_MAT</th>
      <td>0.10</td>
      <td>-∞</td>
      <td>∞</td>
      <td>False</td>
    </tr>
  </tbody>
</table></div></div>
</div>
</div>
<p>Another function that may be useful would be setting the initial estimates with
<a class="reference internal" href="api/pharmpy.modeling.set_initial_estimates.html#pharmpy.modeling.set_initial_estimates" title="pharmpy.modeling.set_initial_estimates"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_initial_estimates()</span></code></a>.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-30-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-30-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-30-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-30-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-30-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-30-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">run2</span> <span class="o">=</span> <span class="n">set_initial_estimates</span><span class="p">(</span><span class="n">run1</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;IIV_CL&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span> <span class="s1">&#39;IIV_VC&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">})</span>
<span class="n">run2</span><span class="o">.</span><span class="n">parameters</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-30-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-30-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">run2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">set_initial_estimates</span><span class="p">(</span><span class="n">run1</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;IIV_CL&#39;</span><span class="o">:</span><span class="w"> </span><span class="m">0.05</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;IIV_VC&#39;</span><span class="o">:</span><span class="w"> </span><span class="m">0.05</span><span class="p">})</span>
<span class="n">run2</span><span class="o">$</span><span class="n">parameters</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>value</th>
      <th>lower</th>
      <th>upper</th>
      <th>fix</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>POP_CL</th>
      <td>0.01</td>
      <td>0.0</td>
      <td>∞</td>
      <td>True</td>
    </tr>
    <tr>
      <th>POP_VC</th>
      <td>1.00</td>
      <td>0.0</td>
      <td>∞</td>
      <td>True</td>
    </tr>
    <tr>
      <th>IIV_CL</th>
      <td>0.05</td>
      <td>-∞</td>
      <td>∞</td>
      <td>False</td>
    </tr>
    <tr>
      <th>IIV_VC</th>
      <td>0.05</td>
      <td>-∞</td>
      <td>∞</td>
      <td>False</td>
    </tr>
    <tr>
      <th>sigma</th>
      <td>0.09</td>
      <td>-∞</td>
      <td>∞</td>
      <td>False</td>
    </tr>
    <tr>
      <th>IIV_CL_IIV_VC</th>
      <td>0.01</td>
      <td>-∞</td>
      <td>∞</td>
      <td>False</td>
    </tr>
    <tr>
      <th>POP_MAT</th>
      <td>0.10</td>
      <td>0.0</td>
      <td>∞</td>
      <td>False</td>
    </tr>
    <tr>
      <th>IIV_MAT</th>
      <td>0.10</td>
      <td>-∞</td>
      <td>∞</td>
      <td>False</td>
    </tr>
  </tbody>
</table></div></div>
</div>
</div>
<p>And then the final model code:</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-31-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-31-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-31-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-31-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-31-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-31-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">print_model_code</span><span class="p">(</span><span class="n">run2</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-31-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-31-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print_model_code</span><span class="p">(</span><span class="n">run2</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>$PROBLEM Start model
$INPUT ID TIME AMT WGT APGR DV FA1 FA2
$DATA file.csv IGNORE=@
$SUBROUTINES ADVAN2 TRANS2
$ABBR REPLACE ETA_CL=ETA(1)
$ABBR REPLACE ETA_VC=ETA(2)
$ABBR REPLACE ETA_MAT=ETA(3)
$PK
MAT = THETA(3)*EXP(ETA_MAT)
CL = THETA(1)*EXP(ETA_CL)
VC = THETA(2)*EXP(ETA_VC)
KA = 1/MAT
V = VC
$ERROR
IPRED = A(2)/VC
IF (IPRED.EQ.0) THEN
    IPREDADJ = 2.22500000000000E-16
ELSE
    IPREDADJ = IPRED
END IF
Y = IPRED + EPS(1)*IPREDADJ
$THETA  (0,0.01) FIX ; POP_CL
$THETA  (0,1.0) FIX ; POP_VC
$THETA  (0,0.1) ; POP_MAT
$OMEGA BLOCK(2)
0.05	; IIV_CL
0.01	; IIV_CL_IIV_VC
0.05	; IIV_VC
$OMEGA  0.1 ; IIV_MAT
$SIGMA  0.09 ; sigma
$ESTIMATION METHOD=COND INTER MAXEVAL=99999
$TABLE ID TIME DV CWRES CIPREDI PRED FILE=mytab NOAPPEND NOPRINT
</pre></div>
</div>
</div>
</div>
</div>
<p>List of functions to change population parameters:</p>
<ul class="simple">
<li><p><a class="reference internal" href="api/pharmpy.modeling.add_population_parameter.html#pharmpy.modeling.add_population_parameter" title="pharmpy.modeling.add_population_parameter"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.add_population_parameter()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.fix_or_unfix_parameters.html#pharmpy.modeling.fix_or_unfix_parameters" title="pharmpy.modeling.fix_or_unfix_parameters"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.fix_or_unfix_parameters()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.fix_parameters.html#pharmpy.modeling.fix_parameters" title="pharmpy.modeling.fix_parameters"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.fix_parameters()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.fix_parameters_to.html#pharmpy.modeling.fix_parameters_to" title="pharmpy.modeling.fix_parameters_to"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.fix_parameters_to()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.set_initial_estimates.html#pharmpy.modeling.set_initial_estimates" title="pharmpy.modeling.set_initial_estimates"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_initial_estimates()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.set_lower_bounds.html#pharmpy.modeling.set_lower_bounds" title="pharmpy.modeling.set_lower_bounds"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_lower_bounds()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.set_upper_bounds.html#pharmpy.modeling.set_upper_bounds" title="pharmpy.modeling.set_upper_bounds"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_upper_bounds()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.unconstrain_parameters.html#pharmpy.modeling.unconstrain_parameters" title="pharmpy.modeling.unconstrain_parameters"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.unconstrain_parameters()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.unfix_parameters.html#pharmpy.modeling.unfix_parameters" title="pharmpy.modeling.unfix_parameters"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.unfix_parameters()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.unfix_parameters_to.html#pharmpy.modeling.unfix_parameters_to" title="pharmpy.modeling.unfix_parameters_to"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.unfix_parameters_to()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.update_inits.html#pharmpy.modeling.update_inits" title="pharmpy.modeling.update_inits"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.update_inits()</span></code></a></p></li>
</ul>
</section>
<section id="error-model">
<h3>Error model<a class="headerlink" href="#error-model" title="Link to this heading">#</a></h3>
<p>Pharmpy supports several error models. As an example, let us set the error model to a combined error model (start
model had proportional error model) using <a class="reference internal" href="api/pharmpy.modeling.set_combined_error_model.html#pharmpy.modeling.set_combined_error_model" title="pharmpy.modeling.set_combined_error_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_combined_error_model()</span></code></a>:</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-32-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-32-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-32-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-32-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-32-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-32-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">run1</span> <span class="o">=</span> <span class="n">set_combined_error_model</span><span class="p">(</span><span class="n">model_start</span><span class="p">)</span>
<span class="n">run1</span><span class="o">.</span><span class="n">statements</span><span class="o">.</span><span class="n">error</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-32-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-32-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">run1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">set_combined_error_model</span><span class="p">(</span><span class="n">model_start</span><span class="p">)</span>
<span class="n">run1</span><span class="o">$</span><span class="n">statements</span><span class="o">$</span><span class="n">error</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html">\begin{align*}IPRED &= \frac{A_{CENTRAL}{\left(t \right)}}{VC}\\IPREDADJ &= \begin{cases} 2.225 \cdot 10^{-16} & \text{for}\: IPRED &= 0 \\IPRED & \text{otherwise} \end{cases}\\Y &= IPRED \cdot \epsilon_{p1} + IPRED + \epsilon_{a}\\\end{align*}</div></div>
</div>
</div>
<p>List of functions to change the error model:</p>
<ul class="simple">
<li><p><a class="reference internal" href="api/pharmpy.modeling.remove_error_model.html#pharmpy.modeling.remove_error_model" title="pharmpy.modeling.remove_error_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.remove_error_model()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.set_additive_error_model.html#pharmpy.modeling.set_additive_error_model" title="pharmpy.modeling.set_additive_error_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_additive_error_model()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.set_combined_error_model.html#pharmpy.modeling.set_combined_error_model" title="pharmpy.modeling.set_combined_error_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_combined_error_model()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.set_dtbs_error_model.html#pharmpy.modeling.set_dtbs_error_model" title="pharmpy.modeling.set_dtbs_error_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_dtbs_error_model()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.set_iiv_on_ruv.html#pharmpy.modeling.set_iiv_on_ruv" title="pharmpy.modeling.set_iiv_on_ruv"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_iiv_on_ruv()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.set_power_on_ruv.html#pharmpy.modeling.set_power_on_ruv" title="pharmpy.modeling.set_power_on_ruv"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_power_on_ruv()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.set_proportional_error_model.html#pharmpy.modeling.set_proportional_error_model" title="pharmpy.modeling.set_proportional_error_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_proportional_error_model()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.set_time_varying_error_model.html#pharmpy.modeling.set_time_varying_error_model" title="pharmpy.modeling.set_time_varying_error_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_time_varying_error_model()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.set_weighted_error_model.html#pharmpy.modeling.set_weighted_error_model" title="pharmpy.modeling.set_weighted_error_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_weighted_error_model()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.use_thetas_for_error_stdev.html#pharmpy.modeling.use_thetas_for_error_stdev" title="pharmpy.modeling.use_thetas_for_error_stdev"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.use_thetas_for_error_stdev()</span></code></a></p></li>
</ul>
</section>
<section id="blq-transformations">
<h3>BLQ transformations<a class="headerlink" href="#blq-transformations" title="Link to this heading">#</a></h3>
<p>It is also possible to perform BLQ transformations using the <a class="reference internal" href="api/pharmpy.modeling.transform_blq.html#pharmpy.modeling.transform_blq" title="pharmpy.modeling.transform_blq"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.transform_blq()</span></code></a> function. If
using the M3 or M4 method the standard deviation statement is derived symbolically.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-33-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-33-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-33-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-33-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-33-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-33-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">run1</span> <span class="o">=</span> <span class="n">transform_blq</span><span class="p">(</span><span class="n">model_start</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;m4&#39;</span><span class="p">,</span> <span class="n">lloq</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">run1</span><span class="o">.</span><span class="n">statements</span><span class="o">.</span><span class="n">error</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-33-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-33-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">run1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">transform_blq</span><span class="p">(</span><span class="n">model_start</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s">&#39;m4&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">lloq</span><span class="o">=</span><span class="m">0.1</span><span class="p">)</span>
<span class="n">run1</span><span class="o">$</span><span class="n">statements</span><span class="o">$</span><span class="n">error</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html">\begin{align*}IPRED &= \frac{A_{CENTRAL}{\left(t \right)}}{VC}\\IPREDADJ &= \begin{cases} 2.225 \cdot 10^{-16} & \text{for}\: IPRED &= 0 \\IPRED & \text{otherwise} \end{cases}\\SD &= \sqrt{\sigma} \cdot \left|{IPREDADJ}\right|\\LLOQ &= 0.1\\F_{FLAG} &= \begin{cases} 0 & \text{for}\: DV \geq LLOQ \\1 & \text{otherwise} \end{cases}\\CUMD &= \phi{\left(\frac{- IPRED + LLOQ}{SD} \right)}\\CUMDZ &= \phi{\left(- \frac{IPRED}{SD} \right)}\\Y &= \begin{cases} IPRED + IPREDADJ \cdot \epsilon_{p} & \text{for}\: DV \geq LLOQ \\\frac{CUMD - CUMDZ}{1 - CUMDZ} & \text{otherwise} \end{cases}\\\end{align*}</div></div>
</div>
</div>
<p>And examine the model code:</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-34-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-34-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-34-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-34-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-34-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-34-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">print_model_code</span><span class="p">(</span><span class="n">run1</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-34-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-34-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print_model_code</span><span class="p">(</span><span class="n">run1</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>$PROBLEM Start model
$INPUT ID TIME AMT WGT APGR DV FA1 FA2
$DATA file.csv IGNORE=@
$SUBROUTINES ADVAN2 TRANS2
$ABBR REPLACE ETA_CL=ETA(1)
$ABBR REPLACE ETA_VC=ETA(2)
$ABBR REPLACE ETA_MAT=ETA(3)
$PK
MAT = THETA(3)*EXP(ETA_MAT)
CL = THETA(1)*EXP(ETA_CL)
VC = THETA(2)*EXP(ETA_VC)
KA = 1/MAT
V = VC
$ERROR
IPRED = A(2)/VC
IF (IPRED.EQ.0) THEN
    IPREDADJ = 2.22500000000000E-16
ELSE
    IPREDADJ = IPRED
END IF
SD = SQRT(SIGMA(1,1))*ABS(IPREDADJ)
LLOQ = 0.100000000000000
IF (DV.GE.LLOQ) THEN
    F_FLAG = 0
ELSE
    F_FLAG = 1
END IF
CUMD = PHI((-IPRED + LLOQ)/SD)
CUMDZ = PHI(-IPRED/SD)
IF (DV.GE.LLOQ) THEN
    Y = IPRED + EPS(1)*IPREDADJ
ELSE
    Y = (CUMD - CUMDZ)/(1 - CUMDZ)
END IF
$THETA  (0,0.01) ; POP_CL
$THETA  (0,1.0) ; POP_VC
$THETA  (0,0.1) ; POP_MAT
$OMEGA BLOCK(2)
0.1	; IIV_CL
0.01	; IIV_CL_IIV_VC
0.1	; IIV_VC
$OMEGA  0.1 ; IIV_MAT
$SIGMA  0.09 ; sigma
$ESTIMATION METHOD=COND LAPLACE INTER MAXEVAL=99999
$TABLE ID TIME DV CWRES CIPREDI PRED FILE=mytab NOAPPEND NOPRINT
</pre></div>
</div>
</div>
</div>
</div>
<p>List of functions to perform BLQ transformations:</p>
<ul class="simple">
<li><p><a class="reference internal" href="api/pharmpy.modeling.transform_blq.html#pharmpy.modeling.transform_blq" title="pharmpy.modeling.transform_blq"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.transform_blq()</span></code></a></p></li>
</ul>
</section>
<section id="estimation-steps">
<h3>Estimation steps<a class="headerlink" href="#estimation-steps" title="Link to this heading">#</a></h3>
<p>Pharmpy can change the estimation steps. As an example, let us change the estimation method from FOCE to IMP and set
how many iterations to output (the <code class="docutils literal notranslate"><span class="pre">PRINT</span></code> option in NONMEM) using the <a class="reference internal" href="api/pharmpy.modeling.set_estimation_step.html#pharmpy.modeling.set_estimation_step" title="pharmpy.modeling.set_estimation_step"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_estimation_step()</span></code></a>
function:</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-35-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-35-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-35-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-35-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-35-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-35-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">run1</span> <span class="o">=</span> <span class="n">set_estimation_step</span><span class="p">(</span><span class="n">model_start</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;imp&#39;</span><span class="p">,</span> <span class="n">keep_every_nth_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">run1</span><span class="o">.</span><span class="n">estimation_steps</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-35-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-35-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">run1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">set_estimation_step</span><span class="p">(</span><span class="n">model_start</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s">&#39;imp&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">keep_every_nth_iter</span><span class="o">=</span><span class="m">10</span><span class="p">)</span>
<span class="n">run1</span><span class="o">$</span><span class="n">estimation_steps</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>method</th>
      <th>interaction</th>
      <th>parameter_uncertainty_method</th>
      <th>evaluation</th>
      <th>maximum_evaluations</th>
      <th>laplace</th>
      <th>isample</th>
      <th>niter</th>
      <th>auto</th>
      <th>keep_every_nth_iter</th>
      <th>tool_options</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>IMP</td>
      <td>True</td>
      <td>None</td>
      <td>False</td>
      <td>99999</td>
      <td>False</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>10</td>
      <td>{}</td>
    </tr>
  </tbody>
</table></div></div>
</div>
</div>
<p>If we then examine the model code:</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-36-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-36-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-36-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-36-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-36-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-36-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">print_model_code</span><span class="p">(</span><span class="n">run1</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-36-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-36-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print_model_code</span><span class="p">(</span><span class="n">run1</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>$PROBLEM Start model
$INPUT ID TIME AMT WGT APGR DV FA1 FA2
$DATA file.csv IGNORE=@
$SUBROUTINES ADVAN2 TRANS2
$ABBR REPLACE ETA_CL=ETA(1)
$ABBR REPLACE ETA_VC=ETA(2)
$ABBR REPLACE ETA_MAT=ETA(3)
$PK
MAT = THETA(3)*EXP(ETA_MAT)
CL = THETA(1)*EXP(ETA_CL)
VC = THETA(2)*EXP(ETA_VC)
KA = 1/MAT
V = VC
$ERROR
IPRED = A(2)/VC
IF (IPRED.EQ.0) THEN
    IPREDADJ = 2.22500000000000E-16
ELSE
    IPREDADJ = IPRED
END IF
Y = IPRED + EPS(1)*IPREDADJ
$THETA  (0,0.01) ; POP_CL
$THETA  (0,1.0) ; POP_VC
$THETA  (0,0.1) ; POP_MAT
$OMEGA BLOCK(2)
0.1	; IIV_CL
0.01	; IIV_CL_IIV_VC
0.1	; IIV_VC
$OMEGA  0.1 ; IIV_MAT
$SIGMA  0.09 ; sigma
$ESTIMATION METHOD=IMP INTER MAXEVAL=99999 PRINT=10
$TABLE ID TIME DV CWRES CIPREDI PRED FILE=mytab NOAPPEND NOPRINT
</pre></div>
</div>
</div>
</div>
</div>
<p>List of functions to change the estimation steps:</p>
<ul class="simple">
<li><p><a class="reference internal" href="api/pharmpy.modeling.add_parameter_uncertainty_step.html#pharmpy.modeling.add_parameter_uncertainty_step" title="pharmpy.modeling.add_parameter_uncertainty_step"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.add_parameter_uncertainty_step()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.add_estimation_step.html#pharmpy.modeling.add_estimation_step" title="pharmpy.modeling.add_estimation_step"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.add_estimation_step()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.append_estimation_step_options.html#pharmpy.modeling.append_estimation_step_options" title="pharmpy.modeling.append_estimation_step_options"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.append_estimation_step_options()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.remove_parameter_uncertainty_step.html#pharmpy.modeling.remove_parameter_uncertainty_step" title="pharmpy.modeling.remove_parameter_uncertainty_step"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.remove_parameter_uncertainty_step()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.remove_estimation_step.html#pharmpy.modeling.remove_estimation_step" title="pharmpy.modeling.remove_estimation_step"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.remove_estimation_step()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.set_estimation_step.html#pharmpy.modeling.set_estimation_step" title="pharmpy.modeling.set_estimation_step"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_estimation_step()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.set_evaluation_step.html#pharmpy.modeling.set_evaluation_step" title="pharmpy.modeling.set_evaluation_step"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_evaluation_step()</span></code></a></p></li>
</ul>
</section>
</section>
<section id="examining-and-modifying-dataset">
<span id="modeling-dataset"></span><h2>Examining and modifying dataset<a class="headerlink" href="#examining-and-modifying-dataset" title="Link to this heading">#</a></h2>
<p>The Pharmpy dataset can be examined and modified with several help functions in Pharmpy. To read more about the
dataset, see the <a class="reference internal" href="data.html#dataset"><span class="std std-ref">dataset documentation</span></a>.</p>
<p>List of dataset functions:</p>
<ul class="simple">
<li><p><a class="reference internal" href="api/pharmpy.modeling.add_time_after_dose.html#pharmpy.modeling.add_time_after_dose" title="pharmpy.modeling.add_time_after_dose"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.add_time_after_dose()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.check_dataset.html#pharmpy.modeling.check_dataset" title="pharmpy.modeling.check_dataset"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.check_dataset()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.deidentify_data.html#pharmpy.modeling.deidentify_data" title="pharmpy.modeling.deidentify_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.deidentify_data()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.drop_columns.html#pharmpy.modeling.drop_columns" title="pharmpy.modeling.drop_columns"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.drop_columns()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.drop_dropped_columns.html#pharmpy.modeling.drop_dropped_columns" title="pharmpy.modeling.drop_dropped_columns"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.drop_dropped_columns()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.expand_additional_doses.html#pharmpy.modeling.expand_additional_doses" title="pharmpy.modeling.expand_additional_doses"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.expand_additional_doses()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.get_baselines.html#pharmpy.modeling.get_baselines" title="pharmpy.modeling.get_baselines"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.get_baselines()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.get_cmt.html#pharmpy.modeling.get_cmt" title="pharmpy.modeling.get_cmt"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.get_cmt()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.get_concentration_parameters_from_data.html#pharmpy.modeling.get_concentration_parameters_from_data" title="pharmpy.modeling.get_concentration_parameters_from_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.get_concentration_parameters_from_data()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.get_covariate_baselines.html#pharmpy.modeling.get_covariate_baselines" title="pharmpy.modeling.get_covariate_baselines"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.get_covariate_baselines()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.get_doseid.html#pharmpy.modeling.get_doseid" title="pharmpy.modeling.get_doseid"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.get_doseid()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.get_doses.html#pharmpy.modeling.get_doses" title="pharmpy.modeling.get_doses"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.get_doses()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.get_evid.html#pharmpy.modeling.get_evid" title="pharmpy.modeling.get_evid"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.get_evid()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.get_ids.html#pharmpy.modeling.get_ids" title="pharmpy.modeling.get_ids"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.get_ids()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.get_mdv.html#pharmpy.modeling.get_mdv" title="pharmpy.modeling.get_mdv"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.get_mdv()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.get_number_of_individuals.html#pharmpy.modeling.get_number_of_individuals" title="pharmpy.modeling.get_number_of_individuals"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.get_number_of_individuals()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.get_number_of_observations.html#pharmpy.modeling.get_number_of_observations" title="pharmpy.modeling.get_number_of_observations"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.get_number_of_observations()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.get_number_of_observations_per_individual.html#pharmpy.modeling.get_number_of_observations_per_individual" title="pharmpy.modeling.get_number_of_observations_per_individual"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.get_number_of_observations_per_individual()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.get_observations.html#pharmpy.modeling.get_observations" title="pharmpy.modeling.get_observations"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.get_observations()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.list_time_varying_covariates.html#pharmpy.modeling.list_time_varying_covariates" title="pharmpy.modeling.list_time_varying_covariates"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.list_time_varying_covariates()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.read_dataset_from_datainfo.html#pharmpy.modeling.read_dataset_from_datainfo" title="pharmpy.modeling.read_dataset_from_datainfo"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.read_dataset_from_datainfo()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.remove_loq_data.html#pharmpy.modeling.remove_loq_data" title="pharmpy.modeling.remove_loq_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.remove_loq_data()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.set_covariates.html#pharmpy.modeling.set_covariates" title="pharmpy.modeling.set_covariates"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_covariates()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.set_dvid.html#pharmpy.modeling.set_dvid" title="pharmpy.modeling.set_dvid"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_dvid()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.translate_nmtran_time.html#pharmpy.modeling.translate_nmtran_time" title="pharmpy.modeling.translate_nmtran_time"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.translate_nmtran_time()</span></code></a></p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.undrop_columns.html#pharmpy.modeling.undrop_columns" title="pharmpy.modeling.undrop_columns"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.undrop_columns()</span></code></a></p></li>
</ul>
<section id="subjects">
<h3>Subjects<a class="headerlink" href="#subjects" title="Link to this heading">#</a></h3>
<p>An array of all subject IDs can be retrieved.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-37-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-37-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-37-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-37-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-37-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-37-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno_real.mod&quot;</span><span class="p">)</span>
<span class="n">get_ids</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-37-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-37-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_model</span><span class="p">(</span><span class="n">path</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s">&quot;pheno_real.mod&quot;</span><span class="p">)</span>
<span class="nf">get_ids</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>[1,
 2,
 3,
 4,
 5,
 6,
 7,
 8,
 9,
 10,
 11,
 12,
 13,
 14,
 15,
 16,
 17,
 18,
 19,
 20,
 21,
 22,
 23,
 24,
 25,
 26,
 27,
 28,
 29,
 30,
 31,
 32,
 33,
 34,
 35,
 36,
 37,
 38,
 39,
 40,
 41,
 42,
 43,
 44,
 45,
 46,
 47,
 48,
 49,
 50,
 51,
 52,
 53,
 54,
 55,
 56,
 57,
 58,
 59]
</pre></div>
</div>
</div>
</div>
</div>
<p>The number of subjects in the dataset could optionally be retrieved directly.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-38-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-38-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-38-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-38-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-38-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-38-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">get_number_of_individuals</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-38-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-38-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">get_number_of_individuals</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>59
</pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="observations">
<h3>Observations<a class="headerlink" href="#observations" title="Link to this heading">#</a></h3>
<p>The observations of the dataset indexed on subject ID and the independent variable can be extracted.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-39-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-39-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-39-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-39-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-39-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-39-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">get_observations</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-39-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-39-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">get_observations</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>ID  TIME 
1   2.0      17.3
    112.5    31.0
2   2.0       9.7
    63.5     24.6
    135.5    33.0
             ... 
58  47.5     27.9
    131.8    31.0
59  1.8      22.6
    73.8     34.3
    146.8    40.2
Name: DV, Length: 155, dtype: float64
</pre></div>
</div>
</div>
</div>
</div>
<p>The total number of observations can optionally be retrieved directly.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-40-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-40-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-40-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-40-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-40-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-40-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">get_number_of_observations</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-40-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-40-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">get_number_of_observations</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>155
</pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="dosing">
<h3>Dosing<a class="headerlink" href="#dosing" title="Link to this heading">#</a></h3>
<section id="extract-dosing-information">
<h4>Extract dosing information<a class="headerlink" href="#extract-dosing-information" title="Link to this heading">#</a></h4>
<p>The doses of the dataset indexed on subject ID and the independent variable can be extracted.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-41-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-41-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-41-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-41-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-41-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-41-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">doses</span> <span class="o">=</span> <span class="n">get_doses</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">doses</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-41-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-41-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">doses</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">get_doses</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">doses</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>ID  TIME 
1   0.0      25.0
    12.5      3.5
    24.5      3.5
    37.0      3.5
    48.0      3.5
             ... 
59  96.0      3.0
    108.3     3.0
    120.5     3.0
    132.3     3.0
    144.8     3.0
Name: AMT, Length: 589, dtype: float64
</pre></div>
</div>
</div>
</div>
</div>
<p>All unique doses can be listed</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-42-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-42-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-42-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-42-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-42-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-42-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">doses</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-42-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-42-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">doses</span><span class="o">$</span><span class="nf">unique</span><span class="p">()</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([25. ,  3.5, 15. ,  3.8, 30. ,  3.7, 18.6,  2.3, 27. ,  3.4, 24. ,
        3. , 19. ,  2.4,  3.2, 26. ,  3.3,  5. , 11. ,  2.8, 22. , 12. ,
        4. , 20. ,  2.5, 10. , 17.5,  4.5, 60. ,  7.5, 63. , 32. ,  1.9,
        1.5,  2. , 70. ,  9. , 35. , 18. , 17. ,  4.3, 34. ,  6. , 56. ,
       28. ,  7. , 14. , 16. , 40. ,  6.7,  1.7,  9.5,  4.4, 22.8])
</pre></div>
</div>
</div>
</div>
</div>
<p>as well as the largest and the smallest dose</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-43-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-43-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-43-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-43-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-43-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-43-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">doses</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-43-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-43-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">doses</span><span class="o">$</span><span class="nf">min</span><span class="p">()</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>1.5
</pre></div>
</div>
</div>
</div>
</div>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-44-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-44-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-44-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-44-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-44-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-44-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">doses</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-44-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-44-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">doses</span><span class="o">$</span><span class="nf">max</span><span class="p">()</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>70.0
</pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="dose-grouping">
<h4>Dose grouping<a class="headerlink" href="#dose-grouping" title="Link to this heading">#</a></h4>
<p>It is possible to create a DOSEID that groups each dose period starting from 1.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-45-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-45-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-45-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-45-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-45-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-45-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">ser</span> <span class="o">=</span> <span class="n">get_doseid</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">ser</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-45-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-45-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">ser</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">get_doseid</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">ser</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>0       1
1       1
2       2
3       3
4       4
       ..
739    10
740    11
741    12
742    13
743    13
Name: DOSEID, Length: 744, dtype: int64
</pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="time-after-dose">
<h4>Time after dose<a class="headerlink" href="#time-after-dose" title="Link to this heading">#</a></h4>
<p>Add a column for time after dose (TAD)</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-46-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-46-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-46-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-46-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-46-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-46-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">add_time_after_dose</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;TAD&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-46-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-46-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">add_time_after_dose</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">model</span><span class="o">$</span><span class="n">dataset</span><span class="p">[</span><span class="s">&#39;TAD&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>0      0.0
1      2.0
2      0.0
3      0.0
4      0.0
      ... 
739    0.0
740    0.0
741    0.0
742    0.0
743    2.0
Name: TAD, Length: 744, dtype: float64
</pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="concentration-parameters">
<h4>Concentration parameters<a class="headerlink" href="#concentration-parameters" title="Link to this heading">#</a></h4>
<p>Extract pharmacokinetic concentration parameters from the dataset</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-47-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-47-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-47-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-47-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-47-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-47-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">get_concentration_parameters_from_data</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-47-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-47-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">get_concentration_parameters_from_data</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Cmax</th>
      <th>Tmax</th>
      <th>Cmin</th>
      <th>Tmin</th>
    </tr>
    <tr>
      <th>ID</th>
      <th>DOSEID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">1</th>
      <th>1</th>
      <td>17.3</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">59</th>
      <th>9</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>12</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>13</th>
      <td>40.2</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>589 rows × 4 columns</p>
</div></div></div>
</div>
</div>
</section>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="modelfit.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Model estimation and results</p>
      </div>
    </a>
    <a class="right-next"
       href="model.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">The Pharmpy model</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">

  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-functions">Basic functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-and-writing-models">Reading and writing models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-example-models">Loading example models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#converting-models">Converting models</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-basic-models">Create basic models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling-transformations">Modeling transformations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#structural-model">Structural model</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#absorption-rate">Absorption rate</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#absorption-delay">Absorption delay</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution">Distribution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#elimination">Elimination</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameter-variability-model">Parameter variability model</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-and-removing-parameter-variability">Adding and removing parameter variability</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-and-removing-covariance">Adding and removing covariance</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#eta-transformations">Eta transformations</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#covariates-and-allometry">Covariates and allometry</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#population-parameters">Population parameters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#error-model">Error model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#blq-transformations">BLQ transformations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estimation-steps">Estimation steps</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examining-and-modifying-dataset">Examining and modifying dataset</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#subjects">Subjects</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#observations">Observations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dosing">Dosing</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-dosing-information">Extract dosing information</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dose-grouping">Dose grouping</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-after-dose">Time after dose</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#concentration-parameters">Concentration parameters</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2018-2023; the Pharmpy development team.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>