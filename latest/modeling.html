
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Modeling &#8212; Pharmpy 0.57.0 documentation</title>
    
    <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
  
    
    <link rel="stylesheet"
      href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">
  
    
      
  
    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/pydata-sphinx-theme.css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    
    <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">
  
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.0-rc.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Modelfit" href="modelfit.html" />
    <link rel="prev" title="Datasets in Pharmpy" href="data.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="index.html">
<p class="title">Pharmpy</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="contributors.html">
  About us
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="getting_started.html">
  Getting started
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="user_guide.html">
  User guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="api.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="changelog.html">
  Changelog
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="contribute.html">
  Contribute
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="citation.html">
  References and citation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="license.html">
  License
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
<h3><a href="index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="contributors.html">About us</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="user_guide.html">User guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="model.html">The Pharmpy model</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html">Datasets in Pharmpy</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="modelfit.html">Modelfit</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="plots.html">Plots in Pharmpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="nonmem_plugin.html">Using the NONMEM plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli.html">The Pharmpy command line interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="using_r.html">Pharmpy in R</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="contribute.html">Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">References and citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/modeling.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basic-modelling">
   Basic modelling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#reading-writing-and-updating-source-models">
     Reading, writing and updating source models
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#read-model-from-file">
       Read model from file
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#read-model-from-string">
       Read model from string
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#getting-the-model-code">
       Getting the model code
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#write-model-to-file">
       Write model to file
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parameters">
     Parameters
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#fix-and-unfix-parameters">
       Fix and unfix parameters
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-parameter">
       Add parameter
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pk-models-and-ode-systems">
   PK models and ODE systems
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#absorption-rate">
     Absorption rate
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#bolus-absorption">
       Bolus absorption
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#zero-order">
       Zero order
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#first-order">
       First order
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sequential-zero-order-then-first-order">
       Sequential zero-order then first-order
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#absorption-delay">
     Absorption delay
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#transit-compartments">
       Transit compartments
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lag-time">
       Lag time
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#elimination-rate">
     Elimination rate
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#first-order-elimination">
       First-order elimination
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#zero-order-elimination">
       Zero-order elimination
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#michaelis-menten-elimination">
       Michaelis-Menten elimination
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mixed-michaelis-menten-first-order-elimination">
       Mixed Michaelis-Menten + First-Order elimination
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#distribution">
     Distribution
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-peripheral-compartment">
       Add peripheral compartment
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#remove-peripheral-compartment">
       Remove peripheral compartment
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#set-the-number-of-peripheral-compartments">
       Set the number of peripheral compartments
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#adding-covariate-effects">
   Adding covariate effects
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#transformation-of-etas">
   Transformation of etas
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#boxcox">
     Boxcox
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#approximate-t-distribution">
     Approximate t-distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#john-draper">
     John Draper
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#adding-new-etas">
   Adding new etas
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adding-iivs">
     Adding IIVs
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adding-iovs">
     Adding IOVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#removing-etas">
   Removing etas
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#remove-iivs">
     Remove IIVs
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#remove-iovs">
     Remove IOVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-error-model">
   The error model
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#removing-the-error-model">
     Removing the error model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setting-an-additive-error-model">
     Setting an additive error model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setting-a-proportional-error-model">
     Setting a proportional error model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setting-a-combined-additive-and-proportional-error-model">
     Setting a combined additive and proportional error model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#applying-iiv-on-ruvs">
     Applying IIV on RUVs
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#power-effects-on-ruvs">
     Power effects on RUVs
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#estimate-standard-deviation-of-epsilons-with-thetas">
     Estimate standard deviation of epsilons with thetas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#weighted-error-model">
     Weighted error model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dtbs-error-model">
     dTBS error model
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-joint-distributions-of-multiple-etas">
   Creating joint distributions of multiple etas
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#remove-covariance-between-etas">
   Remove covariance between etas
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#update-initial-estimates-from-previous-run">
   Update initial estimates from previous run
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fitting-a-model">
   Fitting a model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#getting-results-from-a-psn-run">
   Getting results from a PsN run
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eta-shrinkage">
   Eta shrinkage
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#individual-parameter-calculations">
   Individual parameter calculations
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="modeling">
<span id="id1"></span><h1>Modeling<a class="headerlink" href="#modeling" title="Permalink to this headline">¶</a></h1>
<p>While the <a class="reference internal" href="api/pharmpy.Model.html#pharmpy.Model" title="pharmpy.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">pharmpy.model.Model</span></code></a> class can be directly manipulated
with low level operations the modeling module offers higher level operations and transformations for building a model.
These transformations are also available via the Pharmpy command line interface. To read more about these functions
such as how the initial estimates of parameters are chosen, see their respective API documentation.</p>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
</div>
</div>
<p>The following model is the start model for the examples.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">read_model</span>

<span class="n">model_ref</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_ref</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;Pharmpy model object pheno&gt;
</pre></div>
</div>
</div>
</div>
<section id="basic-modelling">
<h2>Basic modelling<a class="headerlink" href="#basic-modelling" title="Permalink to this headline">¶</a></h2>
<p>Many basic model manipulation tasks that could also be done using methods on model objects have been included in the modeling module. This
makes it possible to do most common model manipulations using a functional interface that is easy to chain into a pipeline.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Note that all manipulations are done in place, i.e. the model referenced by the input argument will be changed.</p>
</div>
<section id="reading-writing-and-updating-source-models">
<h3>Reading, writing and updating source models<a class="headerlink" href="#reading-writing-and-updating-source-models" title="Permalink to this headline">¶</a></h3>
<section id="read-model-from-file">
<h4>Read model from file<a class="headerlink" href="#read-model-from-file" title="Permalink to this headline">¶</a></h4>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s1">&#39;pheno.mod&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</section>
<section id="read-model-from-string">
<h4>Read model from string<a class="headerlink" href="#read-model-from-string" title="Permalink to this headline">¶</a></h4>
<p>If the model code is in a string variable it can be read in directly.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;$PROBLEM base model</span><span class="se">\n</span><span class="s1">$INPUT ID DV TIME</span><span class="se">\n</span><span class="s1">$DATA file.csv IGNORE=@</span><span class="se">\n</span><span class="s1">$PRED Y = THETA(1) + ETA(1) + ERR(1)</span><span class="se">\n</span><span class="s1">$THETA 0.1</span><span class="se">\n</span><span class="s1">$OMEGA 0.01</span><span class="se">\n</span><span class="s1">$SIGMA 1</span><span class="se">\n</span><span class="s1">$ESTIMATION METHOD=1&#39;</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">read_model_from_string</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</section>
<section id="getting-the-model-code">
<h4>Getting the model code<a class="headerlink" href="#getting-the-model-code" title="Permalink to this headline">¶</a></h4>
<p>The model code (e.g. the NONMEM code) can be retrieved using the <cite>model_code</cite> attribute.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s1">&#39;pheno.mod&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">model_code</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</section>
<section id="write-model-to-file">
<h4>Write model to file<a class="headerlink" href="#write-model-to-file" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">write_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;mymodel.mod&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h3>
<section id="fix-and-unfix-parameters">
<h4>Fix and unfix parameters<a class="headerlink" href="#fix-and-unfix-parameters" title="Permalink to this headline">¶</a></h4>
<p>The functions for fixing/unfixing parameters take either a list of parameter names or one single parameter name string.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fix_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;THETA(1)&#39;</span><span class="p">,</span> <span class="s1">&#39;THETA(2)&#39;</span><span class="p">])</span>
<span class="n">unfix_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;THETA(1)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>It is also possible to fix and unfix the parameters to a specified value or to a list of values. If parameter_names
is None, all parameters will be transformed.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fix_parameters_to</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;THETA(1)&#39;</span><span class="p">,</span> <span class="s1">&#39;THETA(2)&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">fix_parameters_to</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;THETA(1)&#39;</span><span class="p">,</span> <span class="s1">&#39;THETA(2)&#39;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">unfix_parameters_to</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;THETA(1)&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">unfix_parameters_to</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</section>
<section id="add-parameter">
<h4>Add parameter<a class="headerlink" href="#add-parameter" title="Permalink to this headline">¶</a></h4>
<p>A new parameter can be added by using the name of the new parameter.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s1">&#39;pheno.mod&#39;</span><span class="p">)</span>
<span class="n">add_individual_parameter</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;MAT&#39;</span><span class="p">)</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>MAT = THETA(3)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$THETA  (0,0.1) ; POP_MAT</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
</section>
</section>
</section>
<section id="pk-models-and-ode-systems">
<h2>PK models and ODE systems<a class="headerlink" href="#pk-models-and-ode-systems" title="Permalink to this headline">¶</a></h2>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>The exact solver to use (corresponding to a specific ADVAN in NONMEM) can be set using the function <cite>set_ode_solver</cite>.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">set_ode_solver</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;LSODA&#39;</span><span class="p">)</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$SUBROUTINE ADVAN13 TOL=3</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$MODEL COMPARTMENT=(CENTRAL DEFDOSE)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$DES</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>DADT(1) = -A(1)*CL/V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
<section id="absorption-rate">
<h3>Absorption rate<a class="headerlink" href="#absorption-rate" title="Permalink to this headline">¶</a></h3>
<section id="bolus-absorption">
<h4>Bolus absorption<a class="headerlink" href="#bolus-absorption" title="Permalink to this headline">¶</a></h4>
<p>Let us use a model with bolus absorption as a starting point.</p>
<div class="graphviz"><object data="_images/graphviz-adca8da70de19450437d47a635f03077ccb5cf2d.svg" type="image/svg+xml" class="graphviz">
<p class="warning">digraph fo {
  rankdir = LR
  node [shape=box]
  S [label=&quot;S&quot;, style=invis, width=0, height=0, margin=0];
  Output [label=&quot;O&quot;, style=invis, width=0, height=0, margin=0];
  &quot;Central&quot; -&gt; Output [label=K];
  S -&gt; &quot;Central&quot; [label=&quot;Bolus&quot;];
}</p></object></div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">set_bolus_absorption</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>This type of absorption can be created with:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">set_bolus_absorption</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
</section>
<section id="zero-order">
<h4>Zero order<a class="headerlink" href="#zero-order" title="Permalink to this headline">¶</a></h4>
<p>Let us now change to zero order absorption.</p>
<div class="graphviz"><object data="_images/graphviz-71151396ff2667b8354e5baf5cf89a78336429f8.svg" type="image/svg+xml" class="graphviz">
<p class="warning">digraph fo {
  rankdir = LR
  node [shape=box]
  S [label=&quot;S&quot;, style=invis, width=0, height=0, margin=0];
  Output [label=&quot;O&quot;, style=invis, width=0, height=0, margin=0];
  &quot;Central&quot; -&gt; Output [label=K];
  S -&gt; &quot;Central&quot; [label=Infusion];
}</p></object></div>
<p>See <a class="reference internal" href="api/pharmpy.modeling.set_zero_order_absorption.html#pharmpy.modeling.set_zero_order_absorption" title="pharmpy.modeling.set_zero_order_absorption"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_zero_order_absorption()</span></code></a>.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">set_zero_order_absorption</span>
<span class="n">set_zero_order_absorption</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$DATA pheno.csv IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$INPUT ID TIME AMT WGT APGR DV RATE</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>MAT = THETA(3)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>D1 = 2*MAT</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$THETA  (0,2.0) ; POP_MAT</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
</section>
<section id="first-order">
<h4>First order<a class="headerlink" href="#first-order" title="Permalink to this headline">¶</a></h4>
<p>First order absorption would mean adding an absorption (depot) compartment like this:</p>
<div class="graphviz"><object data="_images/graphviz-5b17b629be01431a12950eaa3bb907da6806cf40.svg" type="image/svg+xml" class="graphviz">
<p class="warning">digraph fo {
  rankdir = LR
  node [shape=box]
  S [label=&quot;S&quot;, style=invis, width=0, height=0, margin=0];
  Output [label=&quot;O&quot;, style=invis, width=0, height=0, margin=0];
  &quot;Depot&quot; -&gt; &quot;Central&quot; [label=Ka];
  &quot;Central&quot; -&gt; Output [label=K];
  S -&gt; &quot;Depot&quot; [label=Bolus];
}</p></object></div>
<p>See <a class="reference internal" href="api/pharmpy.modeling.set_first_order_absorption.html#pharmpy.modeling.set_first_order_absorption" title="pharmpy.modeling.set_first_order_absorption"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_first_order_absorption()</span></code></a>.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">set_first_order_absorption</span>
<span class="n">set_first_order_absorption</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$DATA pheno.csv IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$SUBROUTINE ADVAN2 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>MAT = THETA(3)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>S2 = V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>KA = 1/MAT</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$THETA  (0,2.0) ; POP_MAT</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
</section>
<section id="sequential-zero-order-then-first-order">
<h4>Sequential zero-order then first-order<a class="headerlink" href="#sequential-zero-order-then-first-order" title="Permalink to this headline">¶</a></h4>
<p>Sequential zero-order absorption followed by first-order absorption will have an infusion dose into the depot compartment.</p>
<div class="graphviz"><object data="_images/graphviz-d2ef2147ca7125c5f934ff3d00d07289b3ee3362.svg" type="image/svg+xml" class="graphviz">
<p class="warning">digraph fo {
  rankdir = LR
  node [shape=box]
  S [label=&quot;S&quot;, style=invis, width=0, height=0, margin=0];
  Output [label=&quot;O&quot;, style=invis, width=0, height=0, margin=0];
  &quot;Depot&quot; -&gt; &quot;Central&quot; [label=Ka];
  &quot;Central&quot; -&gt; Output [label=K];
  S -&gt; &quot;Depot&quot; [label=Infusion];
}</p></object></div>
<p>See <a class="reference internal" href="api/pharmpy.modeling.set_seq_zo_fo_absorption.html#pharmpy.modeling.set_seq_zo_fo_absorption" title="pharmpy.modeling.set_seq_zo_fo_absorption"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_seq_zo_fo_absorption()</span></code></a>.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">set_seq_zo_fo_absorption</span>
<span class="n">set_seq_zo_fo_absorption</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$DATA pheno.csv IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$INPUT ID TIME AMT WGT APGR DV RATE</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$SUBROUTINE ADVAN2 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>MDT = THETA(4)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>MAT = THETA(3)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>S2 = V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>KA = 1/MAT</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>D1 = 2*MDT</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$THETA  (0,2.0) ; POP_MAT</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$THETA  (0,0.5) ; POP_MDT</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
</section>
</section>
<section id="absorption-delay">
<h3>Absorption delay<a class="headerlink" href="#absorption-delay" title="Permalink to this headline">¶</a></h3>
<section id="transit-compartments">
<h4>Transit compartments<a class="headerlink" href="#transit-compartments" title="Permalink to this headline">¶</a></h4>
<p>Transit compartments can be added or removed using the <a class="reference internal" href="api/pharmpy.modeling.set_transit_compartments.html#pharmpy.modeling.set_transit_compartments" title="pharmpy.modeling.set_transit_compartments"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_transit_compartments()</span></code></a> function.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">set_transit_compartments</span>

<span class="n">set_transit_compartments</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$SUBROUTINE ADVAN5 TRANS1</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$MODEL COMPARTMENT=(TRANSIT1 DEFDOSE) COMPARTMENT=(TRANSIT2) COMPARTMENT=(TRANSIT3) COMPARTMENT=(TRANSIT4) COMPARTMENT=(CENTRAL)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>MDT = THETA(3)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>S5 = V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>K12 = 4/MDT</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>K23 = 4/MDT</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>K34 = 4/MDT</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>K45 = 4/MDT</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>K50 = CL/V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$THETA  (0,0.5) ; POP_MDT</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
</section>
<section id="lag-time">
<h4>Lag time<a class="headerlink" href="#lag-time" title="Permalink to this headline">¶</a></h4>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Lag time may be added to a dose compartment of a model.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">add_lag_time</span>
<span class="n">add_lag_time</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>MDT = THETA(3)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>ALAG1 = MDT</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$THETA  (0,0.5) ; POP_MDT</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
<p>Similarly, to remove lag time:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">remove_lag_time</span>
<span class="n">remove_lag_time</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
</section>
</section>
<section id="elimination-rate">
<h3>Elimination rate<a class="headerlink" href="#elimination-rate" title="Permalink to this headline">¶</a></h3>
<p>Pharmpy supports changing a model to first-order, zero-order, Michaelis-Menten, and first-order + Michaelis-Menten
elimination.</p>
<section id="first-order-elimination">
<h4>First-order elimination<a class="headerlink" href="#first-order-elimination" title="Permalink to this headline">¶</a></h4>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">set_first_order_elimination</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
<span class="n">set_first_order_elimination</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
<p>See <a class="reference internal" href="api/pharmpy.modeling.set_first_order_elimination.html#pharmpy.modeling.set_first_order_elimination" title="pharmpy.modeling.set_first_order_elimination"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_first_order_elimination()</span></code></a>.</p>
</section>
<section id="zero-order-elimination">
<h4>Zero-order elimination<a class="headerlink" href="#zero-order-elimination" title="Permalink to this headline">¶</a></h4>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">set_zero_order_elimination</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
<span class="n">set_zero_order_elimination</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$SUBROUTINE ADVAN6 TOL=3</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$MODEL COMPARTMENT=(CENTRAL DEFDOSE)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>KM = THETA(3)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>CLMM = THETA(2)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>V = THETA(1)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$DES</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>DADT(1) = -A(1)*CLMM*KM/(V*(A(1)/V + KM))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$THETA  (0.0,0.00469307) ; POP_CLMM</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$THETA  (0,0.067,1358.0) FIX ; POP_KM</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$OMEGA  0.0309626 ; IIV_CLMM</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
<p>See <a class="reference internal" href="api/pharmpy.modeling.set_zero_order_elimination.html#pharmpy.modeling.set_zero_order_elimination" title="pharmpy.modeling.set_zero_order_elimination"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_zero_order_elimination()</span></code></a>.</p>
</section>
<section id="michaelis-menten-elimination">
<h4>Michaelis-Menten elimination<a class="headerlink" href="#michaelis-menten-elimination" title="Permalink to this headline">¶</a></h4>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">set_michaelis_menten_elimination</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
<span class="n">set_michaelis_menten_elimination</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$SUBROUTINE ADVAN6 TOL=3</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$MODEL COMPARTMENT=(CENTRAL DEFDOSE)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>KM = THETA(3)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>CLMM = THETA(2)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>V = THETA(1)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$DES</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>DADT(1) = -A(1)*CLMM*KM/(V*(A(1)/V + KM))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$THETA  (0.0,0.00469307) ; POP_CLMM</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$THETA  (0,135.8,1358.0) ; POP_KM</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$OMEGA  0.0309626 ; IIV_CLMM</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
<p>See <a class="reference internal" href="api/pharmpy.modeling.set_michaelis_menten_elimination.html#pharmpy.modeling.set_michaelis_menten_elimination" title="pharmpy.modeling.set_michaelis_menten_elimination"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_michaelis_menten_elimination()</span></code></a>.</p>
</section>
<section id="mixed-michaelis-menten-first-order-elimination">
<h4>Mixed Michaelis-Menten + First-Order elimination<a class="headerlink" href="#mixed-michaelis-menten-first-order-elimination" title="Permalink to this headline">¶</a></h4>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">set_mixed_mm_fo_elimination</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
<span class="n">set_mixed_mm_fo_elimination</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$SUBROUTINE ADVAN6 TOL=3</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$MODEL COMPARTMENT=(CENTRAL DEFDOSE)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>CLMM = THETA(4)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>KM = THETA(3)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$DES</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>DADT(1) = -A(1)*(CL + CLMM*KM/(A(1)/V + KM))/V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$THETA  (0,135.8,1358.0) ; POP_KM</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$THETA  (0,0.002346535) ; POP_CLMM</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
<p>See <a class="reference internal" href="api/pharmpy.modeling.set_mixed_mm_fo_elimination.html#pharmpy.modeling.set_mixed_mm_fo_elimination" title="pharmpy.modeling.set_mixed_mm_fo_elimination"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_mixed_mm_fo_elimination()</span></code></a>.</p>
</section>
</section>
<section id="distribution">
<h3>Distribution<a class="headerlink" href="#distribution" title="Permalink to this headline">¶</a></h3>
<section id="add-peripheral-compartment">
<h4>Add peripheral compartment<a class="headerlink" href="#add-peripheral-compartment" title="Permalink to this headline">¶</a></h4>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Adding a peripheral compartment.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">add_peripheral_compartment</span>
<span class="n">add_peripheral_compartment</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$SUBROUTINE ADVAN3 TRANS4</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>VP1 = THETA(4)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>QP1 = THETA(3)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>CL = THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>V1 = THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>S1 = V1</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>Q = QP1</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>V2 = VP1</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$THETA  (0,0.00469307) ; POP_QP1</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$THETA  (0,0.050458) ; POP_VP1</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
</section>
<section id="remove-peripheral-compartment">
<h4>Remove peripheral compartment<a class="headerlink" href="#remove-peripheral-compartment" title="Permalink to this headline">¶</a></h4>
<p>Removing a peripheral compartment.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">remove_peripheral_compartment</span>
<span class="n">remove_peripheral_compartment</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">remove_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">remove_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL = THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V = THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1 = V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.059618) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
</section>
<section id="set-the-number-of-peripheral-compartments">
<span id="cov-effects"></span><h4>Set the number of peripheral compartments<a class="headerlink" href="#set-the-number-of-peripheral-compartments" title="Permalink to this headline">¶</a></h4>
<p>As an alternative to adding or removing one peripheral compartment a certain number of peripheral compartents can be set directly.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">set_peripheral_compartments</span>
<span class="n">set_peripheral_compartments</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">remove_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">remove_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN11 TRANS4</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>VP2 = THETA(6)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>QP2 = THETA(5)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>VP1 = THETA(4)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>QP1 = THETA(3)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL = THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V1 = THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1 = V1</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Q2 = QP1</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V2 = VP1</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Q3 = QP2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V3 = VP2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.059618) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA  (0,0.0022996043) ; POP_QP1</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA  (0,0.0529809) ; POP_VP1</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA  (0,0.0023934657) ; POP_QP2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA  (0,0.0529809) ; POP_VP2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
</section>
</section>
</section>
<section id="adding-covariate-effects">
<h2>Adding covariate effects<a class="headerlink" href="#adding-covariate-effects" title="Permalink to this headline">¶</a></h2>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Covariate effects may be applied to a model.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">add_covariate_effect</span>
<span class="n">add_covariate_effect</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;CL&#39;</span><span class="p">,</span> <span class="s1">&#39;WGT&#39;</span><span class="p">,</span> <span class="s1">&#39;pow&#39;</span><span class="p">,</span> <span class="n">operation</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Here, <em>CL</em> indicates the name of the parameter onto which you want to apply the effect, <em>WGT</em> is the name of the
covariate, and <em>pow</em> (power function) is the effect you want to apply. The effect can be either
added or multiplied to the parameter, denoted by ‘*’ or ‘+’ (multiplied is default).</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>WGT_MEDIAN = 1.30000</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>CLWGT = (WGT/WGT_MEDIAN)**THETA(3)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>CL = CL*CLWGT</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$THETA  (-100,0.001,100000) ; POP_CLWGT</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To see the list of available effects and how the initial estimates for each type of effect is chosen,
see <a class="reference internal" href="api/pharmpy.modeling.add_covariate_effect.html#pharmpy.modeling.add_covariate_effect" title="pharmpy.modeling.add_covariate_effect"><code class="xref py py-class docutils literal notranslate"><span class="pre">pharmpy.modeling.add_covariate_effect</span></code></a>.</p>
</div>
<p>Pharmpy also supports user formatted covariate effects.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
<span class="n">user_effect</span> <span class="o">=</span> <span class="s1">&#39;((cov/std) - median) * theta&#39;</span>
<span class="n">add_covariate_effect</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;CL&#39;</span><span class="p">,</span> <span class="s1">&#39;WGT&#39;</span><span class="p">,</span> <span class="n">user_effect</span><span class="p">,</span> <span class="n">operation</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>The covariate is denoted as <em>cov</em>, the theta as <em>theta</em> (or, if multiple thetas: <em>theta1</em>, <em>theta2</em> etc.), and the mean,
median, and standard deviation as <em>mean</em>, <em>median</em>, and <em>std</em> respectively. This is in order for
the names to be substituted with the correct symbols.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>WGT_MEDIAN = 1.30000</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>WGT_STD = 0.704565</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>CLWGT = THETA(3)*(WGT/WGT_STD - WGT_MEDIAN)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>CL = CL*CLWGT</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$THETA  (-100000,0.001,100000) ; POP_CLWGT</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
</section>
<section id="transformation-of-etas">
<h2>Transformation of etas<a class="headerlink" href="#transformation-of-etas" title="Permalink to this headline">¶</a></h2>
<section id="boxcox">
<h3>Boxcox<a class="headerlink" href="#boxcox" title="Permalink to this headline">¶</a></h3>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>To apply a boxcox transformation, input a list of the etas of interest. See
<a class="reference internal" href="api/pharmpy.modeling.transform_etas_boxcox.html#pharmpy.modeling.transform_etas_boxcox" title="pharmpy.modeling.transform_etas_boxcox"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.transform_etas_boxcox()</span></code></a>.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">transform_etas_boxcox</span>
<span class="n">transform_etas_boxcox</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ETA(1)&#39;</span><span class="p">])</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>ETAB1 = (EXP(ETA(1))**THETA(3) - 1)/THETA(3)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>CL = THETA(1)*EXP(ETAB1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$THETA  (-3,0.01,3) ; lambda1</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
<p>This can be done for one or multiple etas. The new model will have new statements where <em>ETAB1</em> is a boxcox
transformation of <em>ETA(1)</em>.</p>
<p>If no list is provided, all etas will be updated.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
<span class="n">transform_etas_boxcox</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>ETAB1 = (EXP(ETA(1))**THETA(3) - 1)/THETA(3)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>ETAB2 = (EXP(ETA(2))**THETA(4) - 1)/THETA(4)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>CL = THETA(1)*EXP(ETAB1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>V = THETA(2)*EXP(ETAB2)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$THETA  (-3,0.01,3) ; lambda1</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$THETA  (-3,0.01,3) ; lambda2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
</section>
<section id="approximate-t-distribution">
<h3>Approximate t-distribution<a class="headerlink" href="#approximate-t-distribution" title="Permalink to this headline">¶</a></h3>
<p>Applying an approximate t-distribution transformation of etas is analogous to a boxcox transformation. The input
is a list of etas, and if no list is provided all etas will be transformed. See
<a class="reference internal" href="api/pharmpy.modeling.transform_etas_tdist.html#pharmpy.modeling.transform_etas_tdist" title="pharmpy.modeling.transform_etas_tdist"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.transform_etas_tdist()</span></code></a>.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">transform_etas_tdist</span>
<span class="n">transform_etas_tdist</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ETA(1)&#39;</span><span class="p">])</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>ETAT1 = ETA(1)*(1 + (ETA(1)**2 + 1)/(4*THETA(3)) + (5*ETA(1)**4 + 16*ETA(1)**2 + 3)/(96*THETA(3)**2) + (3*ETA(1)**6 + 19*ETA(1)**4 + 17*ETA(1)**2 - 15)/(384*THETA(3)**3))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>CL = THETA(1)*EXP(ETAT1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$THETA  (3,80,100) ; df1</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
</section>
<section id="john-draper">
<h3>John Draper<a class="headerlink" href="#john-draper" title="Permalink to this headline">¶</a></h3>
<p>John Draper transformation is also supported. The function takes a list of etas as input, if no list is
provided all etas will be transformed. See <a class="reference internal" href="api/pharmpy.modeling.transform_etas_john_draper.html#pharmpy.modeling.transform_etas_john_draper" title="pharmpy.modeling.transform_etas_john_draper"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.transform_etas_john_draper()</span></code></a>.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">transform_etas_john_draper</span>
<span class="n">transform_etas_john_draper</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ETA(1)&#39;</span><span class="p">])</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>ETAD1 = ((ABS(ETA(1)) + 1)**THETA(3) - 1)*ABS(ETA(1))/(ETA(1)*THETA(3))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>CL = THETA(1)*EXP(ETAD1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$THETA  (-3,0.01,3) ; lambda1</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
</section>
</section>
<section id="adding-new-etas">
<h2>Adding new etas<a class="headerlink" href="#adding-new-etas" title="Permalink to this headline">¶</a></h2>
<section id="adding-iivs">
<h3>Adding IIVs<a class="headerlink" href="#adding-iivs" title="Permalink to this headline">¶</a></h3>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>IIVs may be added to a model.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">add_iiv</span>
<span class="n">add_iiv</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;S1&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">,</span> <span class="n">operation</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>In this example, <em>S1</em> is the parameter to add the IIV to, <em>exp</em> is the effect on the new eta (see
<a class="reference internal" href="api/pharmpy.modeling.add_iiv.html#pharmpy.modeling.add_iiv" title="pharmpy.modeling.add_iiv"><code class="xref py py-class docutils literal notranslate"><span class="pre">pharmpy.modeling.add_iiv</span></code></a> for available templates and how initial estimates are chosen). The
operation denotes whether the new eta should be added or multiplied (default).</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>S1 = V*EXP(ETA(3))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$OMEGA  0.09 ; IIV_S1</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
<p>For some of the templates, such as proportional etas, the operation can be omitted since it is
already defined by the effect.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
<span class="n">add_iiv</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;S1&#39;</span><span class="p">,</span> <span class="s1">&#39;prop&#39;</span><span class="p">)</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>S1 = ETA(3)*V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$OMEGA  0.09 ; IIV_S1</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
<p>A list of parameter names can also be used as input. In that case, the effect and the operation (if not omitted) must
be either a string (in that case, all new IIVs will have those settings) or be a list of the same size.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
<span class="n">add_iiv</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;S1&#39;</span><span class="p">],</span> <span class="s1">&#39;exp&#39;</span><span class="p">)</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>V = THETA(2)*EXP(ETA(2))*EXP(ETA(3))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>S1 = V*EXP(ETA(4))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$OMEGA  0.09 ; IIV_V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$OMEGA  0.09 ; IIV_S1</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
<p>Similarly to when you <a class="reference internal" href="#cov-effects"><span class="std std-ref">add a covariate effect</span></a>, you can add user
specified effects.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
<span class="n">user_effect</span> <span class="o">=</span> <span class="s1">&#39;eta_new**2&#39;</span>
<span class="n">add_iiv</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;S1&#39;</span><span class="p">,</span> <span class="n">user_effect</span><span class="p">,</span> <span class="n">operation</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>The new etas need to be denoted as <em>eta_new</em>.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>S1 = ETA(3)**2*V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$OMEGA  0.09 ; IIV_S1</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
<p>You can also provide a custom eta name, i.e the name of the internal representation of the eta in Pharmpy. For
example, if you want to be able to use the NONMEM name.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
<span class="n">add_iiv</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;S1&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">,</span> <span class="n">eta_names</span><span class="o">=</span><span class="s1">&#39;ETA(3)&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">random_variables</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{align*}
\displaystyle ETA(1) &amp; \sim  \mathcal{N} \left(\displaystyle 0,\displaystyle OMEGA(1,1)\right) \\ \displaystyle ETA(2) &amp; \sim  \mathcal{N} \left(\displaystyle 0,\displaystyle OMEGA(2,2)\right) \\ \displaystyle EPS(1) &amp; \sim  \mathcal{N} \left(\displaystyle 0,\displaystyle SIGMA(1,1)\right) \\ \displaystyle ETA(3) &amp; \sim  \mathcal{N} \left(\displaystyle 0,\displaystyle IIV_{S1}\right)\end{align*}\end{split}\]</div>
</div>
</div>
</section>
<section id="adding-iovs">
<h3>Adding IOVs<a class="headerlink" href="#adding-iovs" title="Permalink to this headline">¶</a></h3>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
</div>
</div>
<p>Similarly, you can also add IOVs to your model.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">add_iov</span>
<span class="n">add_iov</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;FA1&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ETA(1)&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>In this example, <em>FA1</em> is the name of the occasion column, and the etas on which you wish to add the IOV on are
provided as a list. See <a class="reference internal" href="api/pharmpy.modeling.add_iov.html#pharmpy.modeling.add_iov" title="pharmpy.modeling.add_iov"><code class="xref py py-class docutils literal notranslate"><span class="pre">pharmpy.modeling.add_iov</span></code></a> for information on how initial estimates are chosen.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>IOV_1 = 0</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>IF (FA1.EQ.0) IOV_1 = ETA(3)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>IF (FA1.EQ.1) IOV_1 = ETA(4)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>ETAI1 = IOV_1 + ETA(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>CL = THETA(1)*EXP(ETAI1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$OMEGA  BLOCK(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>0.00309626 ; OMEGA_IOV_1</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$OMEGA  BLOCK(1) SAME ; OMEGA_IOV_1</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
<p>The name of the parameter may also be provided as an argument, and a mix of eta names and parameter names is
supported.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">add_iov</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;FA1&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;CL&#39;</span><span class="p">,</span> <span class="s1">&#39;ETA(2)&#39;</span><span class="p">])</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>IOV_1 = 0</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>IF (FA1.EQ.0) IOV_1 = ETA(3)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>IF (FA1.EQ.1) IOV_1 = ETA(4)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>IOV_2 = 0</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>IF (FA1.EQ.0) IOV_2 = ETA(5)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>IF (FA1.EQ.1) IOV_2 = ETA(6)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>ETAI1 = IOV_1 + ETA(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>ETAI2 = IOV_2 + ETA(2)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>CL = THETA(1)*EXP(ETAI1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>V = THETA(2)*EXP(ETAI2)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$OMEGA  BLOCK(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>0.00309626 ; OMEGA_IOV_1</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$OMEGA  BLOCK(1) SAME ; OMEGA_IOV_1</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$OMEGA  BLOCK(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>0.0031128 ; OMEGA_IOV_2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$OMEGA  BLOCK(1) SAME ; OMEGA_IOV_2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
<p id="add-iov-custom-names">Custom eta names are supported, meaning that the internal representation of the eta in Pharmpy can be set via
the eta_names argument. For example, if you want to be able to use the NONMEM name.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The number of names must be equal to the number of created etas (i.e. the number of
input etas times the number of categories for occasion).</p>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">add_iov</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;FA1&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ETA(1)&#39;</span><span class="p">],</span> <span class="n">eta_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ETA(3)&#39;</span><span class="p">,</span> <span class="s1">&#39;ETA(4)&#39;</span><span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">random_variables</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{align*}
\displaystyle ETA(1) &amp; \sim  \mathcal{N} \left(\displaystyle 0,\displaystyle OMEGA(1,1)\right) \\ \displaystyle ETA(2) &amp; \sim  \mathcal{N} \left(\displaystyle 0,\displaystyle OMEGA(2,2)\right) \\ \displaystyle EPS(1) &amp; \sim  \mathcal{N} \left(\displaystyle 0,\displaystyle SIGMA(1,1)\right) \\ \displaystyle ETA(3) &amp; \sim  \mathcal{N} \left(\displaystyle 0,\displaystyle \omega_{IOV 1}\right) \\ \displaystyle ETA(4) &amp; \sim  \mathcal{N} \left(\displaystyle 0,\displaystyle \omega_{IOV 1}\right)\end{align*}\end{split}\]</div>
</div>
</div>
</section>
</section>
<section id="removing-etas">
<h2>Removing etas<a class="headerlink" href="#removing-etas" title="Permalink to this headline">¶</a></h2>
<section id="remove-iivs">
<h3>Remove IIVs<a class="headerlink" href="#remove-iivs" title="Permalink to this headline">¶</a></h3>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Etas can also be removed by providing a list of etas and/or name of parameters to remove IIV from. See
<a class="reference internal" href="api/pharmpy.modeling.remove_iiv.html#pharmpy.modeling.remove_iiv" title="pharmpy.modeling.remove_iiv"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.remove_iiv()</span></code></a>.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">remove_iiv</span>
<span class="n">remove_iiv</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ETA(1)&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">])</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>DUMMYETA = ETA(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>CL = THETA(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>V = THETA(2)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$OMEGA  0 FIX ; DUMMYOMEGA</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
<p>If you want to remove all etas, leave argument empty.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">remove_iiv</span>
<span class="n">remove_iiv</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>DUMMYETA = ETA(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>CL = THETA(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>V = THETA(2)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$OMEGA  0 FIX ; DUMMYOMEGA</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
</section>
<section id="remove-iovs">
<h3>Remove IOVs<a class="headerlink" href="#remove-iovs" title="Permalink to this headline">¶</a></h3>
<p>You can remove IOVs as well, however all IOV omegas will be removed. See
<a class="reference internal" href="api/pharmpy.modeling.remove_iov.html#pharmpy.modeling.remove_iov" title="pharmpy.modeling.remove_iov"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.remove_iov()</span></code></a>.</p>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">remove_iov</span>
<span class="n">remove_iov</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</section>
</section>
<section id="the-error-model">
<h2>The error model<a class="headerlink" href="#the-error-model" title="Permalink to this headline">¶</a></h2>
<section id="removing-the-error-model">
<h3>Removing the error model<a class="headerlink" href="#removing-the-error-model" title="Permalink to this headline">¶</a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Removing all epsilons might lead to a model that isn’t runnable.</p>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>The error model can be removed.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">remove_error_model</span>

<span class="n">remove_error_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>Y = F</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
</section>
<section id="setting-an-additive-error-model">
<h3>Setting an additive error model<a class="headerlink" href="#setting-an-additive-error-model" title="Permalink to this headline">¶</a></h3>
<p>The additive error model is <span class="math notranslate nohighlight">\(y = f + \epsilon_a\)</span>. In the case of log transformed data the
same error model can be approximated to <span class="math notranslate nohighlight">\(y = \log f + \frac{\epsilon_a}{f}\)</span>. This because</p>
<div class="math notranslate nohighlight">
\[\log (f + \epsilon_a) = \log (f(1+\frac{\epsilon_a}{f})) = \log f + \log(1 + \frac{\epsilon_a}{f}) \approx \log f + \frac{\epsilon_a}{f}\]</div>
<p>where the approximation is the first term of the Taylor expansion of <span class="math notranslate nohighlight">\(\log(1 + x)\)</span>.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>To set an additive error model:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">set_additive_error_model</span>

<span class="n">set_additive_error_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">statements</span><span class="o">.</span><span class="n">find_assignment</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle Y := \displaystyle F + \epsilon_{a}\]</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>Y = F + EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$SIGMA  11.2225 ; sigma</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
<p>To set an additive error model with log transformed data:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">set_additive_error_model</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
<span class="n">set_additive_error_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data_trans</span><span class="o">=</span><span class="s1">&#39;log(Y)&#39;</span><span class="p">)</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>Y = LOG(F) + EPS(1)/F</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$SIGMA  11.2225 ; sigma</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
<p>or set the <cite>data_transformation</cite> attribute on the model.</p>
<p>See <a class="reference internal" href="api/pharmpy.modeling.set_additive_error_model.html#pharmpy.modeling.set_additive_error_model" title="pharmpy.modeling.set_additive_error_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_additive_error_model()</span></code></a>.</p>
</section>
<section id="setting-a-proportional-error-model">
<h3>Setting a proportional error model<a class="headerlink" href="#setting-a-proportional-error-model" title="Permalink to this headline">¶</a></h3>
<p>The proportinal error model is <span class="math notranslate nohighlight">\(y = f + f \epsilon_p\)</span>. In the case of log transformed data the
same error model can be approximated to <span class="math notranslate nohighlight">\(y = \log f + \epsilon_p\)</span>. This because</p>
<div class="math notranslate nohighlight">
\[\log (f + f\epsilon_p) = \log (f(1+\epsilon_p)) = \log f + \log(1+ \epsilon_p) \approx \log f + \epsilon_p\]</div>
<p>where again the approximation is the first term of the Taylor expansion of <span class="math notranslate nohighlight">\(\log(1 + x)\)</span>.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>To set a proportional error model:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">set_proportional_error_model</span>

<span class="n">set_proportional_error_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">statements</span><span class="o">.</span><span class="n">find_assignment</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle Y := \displaystyle EPS(1) F + F\]</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
<p>To set a proportional error model with log transformed data:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">set_proportional_error_model</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
<span class="n">set_proportional_error_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data_trans</span><span class="o">=</span><span class="s1">&#39;log(Y)&#39;</span><span class="p">)</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
<p>See <a class="reference internal" href="api/pharmpy.modeling.set_proportional_error_model.html#pharmpy.modeling.set_proportional_error_model" title="pharmpy.modeling.set_proportional_error_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_proportional_error_model()</span></code></a>.</p>
</section>
<section id="setting-a-combined-additive-and-proportional-error-model">
<h3>Setting a combined additive and proportional error model<a class="headerlink" href="#setting-a-combined-additive-and-proportional-error-model" title="Permalink to this headline">¶</a></h3>
<p>The combined error model is <span class="math notranslate nohighlight">\(y = f + f \epsilon_p + \epsilon_a\)</span>. In the case of log transformed data the
same error model can be approximated to <span class="math notranslate nohighlight">\(y = \log f + \epsilon_p + \frac{\epsilon_a}{f}\)</span>. This because</p>
<div class="math notranslate nohighlight">
\[\log (f + f\epsilon_p + \epsilon_a) = \log (f(1+\epsilon_p+\frac{\epsilon_a}{f})) = \log f + \log(1 + \epsilon_p + \frac{\epsilon_a}{f}) \approx \log f + \epsilon_p + \frac{\epsilon_a}{f}\]</div>
<p>where again the approximation is the first term of the Taylor expansion of <span class="math notranslate nohighlight">\(\log(1 + x)\)</span>.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>To set a combined error model:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">set_combined_error_model</span>

<span class="n">set_combined_error_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">statements</span><span class="o">.</span><span class="n">find_assignment</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle Y := \displaystyle F \epsilon_{p} + F + \epsilon_{a}\]</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>Y = F + EPS(1)*F + EPS(2)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$SIGMA  0.09 ; sigma_prop</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$SIGMA  11.2225 ; sigma_add</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
<p>To set a combined error model with log transformed data:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">set_combined_error_model</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
<span class="n">set_combined_error_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data_trans</span><span class="o">=</span><span class="s1">&#39;log(Y)&#39;</span><span class="p">)</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>Y = LOG(F) + EPS(2)/F + EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$SIGMA  0.09 ; sigma_prop</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$SIGMA  11.2225 ; sigma_add</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
<p>See <a class="reference internal" href="api/pharmpy.modeling.set_combined_error_model.html#pharmpy.modeling.set_combined_error_model" title="pharmpy.modeling.set_combined_error_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_combined_error_model()</span></code></a>.</p>
</section>
<section id="applying-iiv-on-ruvs">
<h3>Applying IIV on RUVs<a class="headerlink" href="#applying-iiv-on-ruvs" title="Permalink to this headline">¶</a></h3>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>IIVs can be added to RUVs by multiplying epsilons with an exponential new eta.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">set_iiv_on_ruv</span>

<span class="n">set_iiv_on_ruv</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;EPS(1)&#39;</span><span class="p">])</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>Y = F + EPS(1)*F*EXP(ETA(3))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$OMEGA  0.09 ; IIV_RUV1</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
<p>Input a list of the epsilons you wish to transform, leave argument empty if all epsilons should be
transformed.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
<span class="n">set_iiv_on_ruv</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>Y = F + EPS(1)*F*EXP(ETA(3))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$OMEGA  0.09 ; IIV_RUV1</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
<p>See <a class="reference internal" href="api/pharmpy.modeling.set_iiv_on_ruv.html#pharmpy.modeling.set_iiv_on_ruv" title="pharmpy.modeling.set_iiv_on_ruv"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_iiv_on_ruv()</span></code></a>.</p>
<p>Custom eta names are supported the same way as when <a class="reference internal" href="#add-iov-custom-names"><span class="std std-ref">adding IOVs</span></a>.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
<span class="n">set_iiv_on_ruv</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;EPS(1)&#39;</span><span class="p">],</span> <span class="n">eta_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ETA(3)&#39;</span><span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">random_variables</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{align*}
\displaystyle ETA(1) &amp; \sim  \mathcal{N} \left(\displaystyle 0,\displaystyle OMEGA(1,1)\right) \\ \displaystyle ETA(2) &amp; \sim  \mathcal{N} \left(\displaystyle 0,\displaystyle OMEGA(2,2)\right) \\ \displaystyle EPS(1) &amp; \sim  \mathcal{N} \left(\displaystyle 0,\displaystyle SIGMA(1,1)\right) \\ \displaystyle ETA(3) &amp; \sim  \mathcal{N} \left(\displaystyle 0,\displaystyle IIV_{RUV1}\right)\end{align*}\end{split}\]</div>
</div>
</div>
</section>
<section id="power-effects-on-ruvs">
<h3>Power effects on RUVs<a class="headerlink" href="#power-effects-on-ruvs" title="Permalink to this headline">¶</a></h3>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">set_power_on_ruv</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
<span class="n">set_power_on_ruv</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;EPS(1)&#39;</span><span class="p">])</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>Y = F + EPS(1)*F**THETA(3)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$THETA  (0.01,1) ; power1</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
<p>A power effect will be applied to all provided epsilons, leave argument empty if all
epsilons should be transformed.</p>
<p>See <a class="reference internal" href="api/pharmpy.modeling.set_power_on_ruv.html#pharmpy.modeling.set_power_on_ruv" title="pharmpy.modeling.set_power_on_ruv"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.set_power_on_ruv()</span></code></a>.</p>
</section>
<section id="estimate-standard-deviation-of-epsilons-with-thetas">
<h3>Estimate standard deviation of epsilons with thetas<a class="headerlink" href="#estimate-standard-deviation-of-epsilons-with-thetas" title="Permalink to this headline">¶</a></h3>
<p>Someimes it is useful to estimate a theta instead of a sigma. This can be done by fixing the sigma to 1 and multiplying the
correspondng epsilon with a theta. This way the theta will represent the standard deviation of the epsilon.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">use_thetas_for_error_stdev</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
<span class="n">use_thetas_for_error_stdev</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>Y = F + EPS(1)*F*THETA(3)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$THETA  (0,0.11506954418958998) ; SD_EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$SIGMA 1 FIX</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
</section>
<section id="weighted-error-model">
<h3>Weighted error model<a class="headerlink" href="#weighted-error-model" title="Permalink to this headline">¶</a></h3>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">set_weighted_error_model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
<span class="n">set_weighted_error_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>W = F</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>Y = F + EPS(1)*W</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
</section>
<section id="dtbs-error-model">
<h3>dTBS error model<a class="headerlink" href="#dtbs-error-model" title="Permalink to this headline">¶</a></h3>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">set_weighted_error_model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
<span class="n">set_dtbs_error_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>W = SQRT(F**2*THETA(3)**2)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>W = F**THETA(5)*W</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>IF (F.NE.0.AND.THETA(4).NE.0) THEN</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>    IPRED = (F**THETA(4) - 1)/THETA(4)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>ELSE IF (THETA(4).EQ.0.AND.F.NE.0) THEN</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>    IPRED = LOG(F)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>ELSE IF (F.EQ.0.AND.THETA(4).EQ.0) THEN</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>    IPRED = -1/THETA(4)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>ELSE</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>    IPRED = -1000000000</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>END IF</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>Y = IPRED + EPS(1)*W</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$THETA  (0,0.11506954418958998) ; SD_EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$THETA  1 ; tbs_lambda</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$THETA  0.001 ; tbs_zeta</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$SIGMA 1 FIX</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
</section>
</section>
<section id="creating-joint-distributions-of-multiple-etas">
<h2>Creating joint distributions of multiple etas<a class="headerlink" href="#creating-joint-distributions-of-multiple-etas" title="Permalink to this headline">¶</a></h2>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Pharmpy supports the joining of multiple etas into a joint distribution. See
<a class="reference internal" href="api/pharmpy.modeling.create_joint_distribution.html#pharmpy.modeling.create_joint_distribution" title="pharmpy.modeling.create_joint_distribution"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.create_joint_distribution()</span></code></a>.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">create_joint_distribution</span>

<span class="n">create_joint_distribution</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ETA(1)&#39;</span><span class="p">,</span> <span class="s1">&#39;ETA(2)&#39;</span><span class="p">])</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$OMEGA BLOCK(2)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>0.0309626   ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>0.0176047   ; IIV_CL_IIV_V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>0.031128    ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
<p>The listed etas will be combined into a new distribution. Valid etas must be IIVs and cannot be
fixed. If no list is provided as input, all etas would be included in the same distribution.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
<span class="n">create_joint_distribution</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_ref</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$OMEGA BLOCK(2)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>0.0309626   ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>0.0176047   ; IIV_CL_IIV_V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>0.031128    ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you already have a joint distribution and wish to include another eta, note that you need to have all etas from that
distribution as input argument, any that are not included will be separated from that distribution.</p>
</div>
</section>
<section id="remove-covariance-between-etas">
<h2>Remove covariance between etas<a class="headerlink" href="#remove-covariance-between-etas" title="Permalink to this headline">¶</a></h2>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Covariance can be removed between etas using the function <a class="reference internal" href="api/pharmpy.modeling.split_joint_distribution.html#pharmpy.modeling.split_joint_distribution" title="pharmpy.modeling.split_joint_distribution"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.split_joint_distribution()</span></code></a>. If we have
the model:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">copy_model</span><span class="p">,</span> <span class="n">create_joint_distribution</span>

<span class="n">create_joint_distribution</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">model_block</span> <span class="o">=</span> <span class="n">copy_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;Pharmpy model object pheno&gt;
</pre></div>
</div>
</div>
</div>
<p>Provide etas as a list.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">split_joint_distribution</span>

<span class="n">split_joint_distribution</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ETA(1)&#39;</span><span class="p">])</span>
<span class="n">print_model_diff</span><span class="p">(</span><span class="n">model_block</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style=line-height:120%><text style=font-style:normal;font-size:80%;font-family:monospace;>$PROBLEM PHENOBARB SIMPLE MODEL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$DATA pheno.dta IGNORE=@</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$INPUT ID TIME AMT WGT APGR DV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SUBROUTINE ADVAN1 TRANS2</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$PK</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>CL=THETA(1)*EXP(ETA(1))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>V=THETA(2)*EXP(ETA(2))</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>S1=V</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ERROR</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>Y=F+F*EPS(1)</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,0.00469307) ; TVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$THETA (0,1.00916) ; TVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$OMEGA 0.0309626  ; IVCL</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;background-color:#DEF4FD>$OMEGA 0.031128  ; IVV</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$SIGMA 0.013241</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br><text style=font-style:normal;font-size:80%;font-family:monospace;>$ESTIMATION METHOD=1 INTERACTION</text><br><text style=font-style:normal;font-size:80%;font-family:monospace;></text><br></p></div></div>
</div>
<p>If no list of etas is provided, all block structures will be split.</p>
</section>
<section id="update-initial-estimates-from-previous-run">
<h2>Update initial estimates from previous run<a class="headerlink" href="#update-initial-estimates-from-previous-run" title="Permalink to this headline">¶</a></h2>
<p>If there are results from a previous run, those can be used for initial estimates in your
pharmpy model. See <a class="reference internal" href="api/pharmpy.modeling.update_inits.html#pharmpy.modeling.update_inits" title="pharmpy.modeling.update_inits"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.update_inits()</span></code></a>.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">read_model</span><span class="p">,</span> <span class="n">update_inits</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;pheno.mod&quot;</span><span class="p">)</span>

<span class="n">update_inits</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">force_individual_estimates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><hr>\begin{align*}\displaystyle CL &:= \displaystyle THETA(1) e^{ETA(1)}\\\displaystyle V &:= \displaystyle THETA(2) e^{ETA(2)}\\\displaystyle S_{1} &:= \displaystyle V\\\end{align*}<pre>Bolus(AMT)
┌───────┐       ┌──────┐
│CENTRAL│──CL/V→│OUTPUT│
└───────┘       └──────┘</pre>\begin{align*}\displaystyle F &:= \displaystyle \frac{A_{CENTRAL}}{S_{1}}\\\displaystyle Y &:= \displaystyle EPS(1) F + F\\\end{align*}<hr>$\begin{align*}
\displaystyle ETA(1) & \sim  \mathcal{N} \left(\displaystyle 0,\displaystyle OMEGA(1,1)\right) \\ \displaystyle ETA(2) & \sim  \mathcal{N} \left(\displaystyle 0,\displaystyle OMEGA(2,2)\right) \\ \displaystyle EPS(1) & \sim  \mathcal{N} \left(\displaystyle 0,\displaystyle SIGMA(1,1)\right)\end{align*}$<hr><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>value</th>
      <th>lower</th>
      <th>upper</th>
      <th>fix</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>THETA(1)</th>
      <td>0.005818</td>
      <td>0.0</td>
      <td>1000000</td>
      <td>False</td>
    </tr>
    <tr>
      <th>THETA(2)</th>
      <td>1.445550</td>
      <td>0.0</td>
      <td>1000000</td>
      <td>False</td>
    </tr>
    <tr>
      <th>OMEGA(1,1)</th>
      <td>0.111053</td>
      <td>0.0</td>
      <td>oo</td>
      <td>False</td>
    </tr>
    <tr>
      <th>OMEGA(2,2)</th>
      <td>0.201526</td>
      <td>0.0</td>
      <td>oo</td>
      <td>False</td>
    </tr>
    <tr>
      <th>SIGMA(1,1)</th>
      <td>0.016418</td>
      <td>0.0</td>
      <td>oo</td>
      <td>False</td>
    </tr>
  </tbody>
</table><hr></div></div>
</div>
</section>
<section id="fitting-a-model">
<h2>Fitting a model<a class="headerlink" href="#fitting-a-model" title="Permalink to this headline">¶</a></h2>
<p>Pharmpy is designed to be able to do fitting of models to data using different external tools. Currently only NONMEM is supported.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">fit</span>
<span class="n">fit</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="getting-results-from-a-psn-run">
<h2>Getting results from a PsN run<a class="headerlink" href="#getting-results-from-a-psn-run" title="Permalink to this headline">¶</a></h2>
<p>Pharmpy can create results objects from PsN run directories for some of the PsN tools. The result objects is a collection of different
results from the tool and can be saved as either json or csv.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">create_results</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">create_results</span><span class="p">(</span><span class="s2">&quot;bootstrap_dir1&quot;</span><span class="p">)</span>
<span class="n">res</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s2">&quot;bootstrap_dir1/results.json&quot;</span><span class="p">)</span>
<span class="n">res</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;bootstrap_dir1/results.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="eta-shrinkage">
<h2>Eta shrinkage<a class="headerlink" href="#eta-shrinkage" title="Permalink to this headline">¶</a></h2>
<p>Eta shrinkage can be calculated either on the standard deviation scale or on the variance scale</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">calculate_eta_shrinkage</span>

<span class="n">calculate_eta_shrinkage</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>ETA(1)    0.597341
ETA(2)    0.039061
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">calculate_eta_shrinkage</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">sd</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>ETA(1)    0.365446
ETA(2)    0.019725
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="individual-parameter-calculations">
<h2>Individual parameter calculations<a class="headerlink" href="#individual-parameter-calculations" title="Permalink to this headline">¶</a></h2>
<p>Pharmpy has functions to calculate statistics for individual parameters that are either defined
in the model code or that can be defined expressions containing dataset columns and/or variables
from the model code.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">calculate_individual_parameter_statistics</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s1">&#39;secondary_parameters&#39;</span><span class="o">/</span> <span class="s1">&#39;run2.mod&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="data.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Datasets in Pharmpy</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="modelfit.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Modelfit</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
    <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2018-2021; the Pharmpy development team.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.4.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>