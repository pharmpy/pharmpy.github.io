
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>sympy.stats.crv_types &#8212; Pharmpy 0.14.0 documentation</title>
    
  <link rel="stylesheet" href="../../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/language_data.js"></script>
    <script src="../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
<div class="container-xl">

    <a class="navbar-brand" href="../../../index.html">
    
      <p class="title">Pharmpy</p>
    
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="../../../getting_started.html">Getting started</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../../user_guide.html">User guide</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../../reference/modules.html">API reference</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../../development.html">Contribute</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../../changelog.html">Changelog</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../../license.html">License</a>
        </li>
        
        
      </ul>


      

      <ul class="navbar-nav">
        
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
<h3><a href="../../../index.html">Table of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../user_guide.html">User guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/modules.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../development.html">Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">License</a></li>
</ul>

          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
    </ul>
</nav>


              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <h1>Source code for sympy.stats.crv_types</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Continuous Random Variables - Prebuilt variables</span>

<span class="sd">Contains</span>
<span class="sd">========</span>
<span class="sd">Arcsin</span>
<span class="sd">Benini</span>
<span class="sd">Beta</span>
<span class="sd">BetaNoncentral</span>
<span class="sd">BetaPrime</span>
<span class="sd">BoundedPareto</span>
<span class="sd">Cauchy</span>
<span class="sd">Chi</span>
<span class="sd">ChiNoncentral</span>
<span class="sd">ChiSquared</span>
<span class="sd">Dagum</span>
<span class="sd">Erlang</span>
<span class="sd">ExGaussian</span>
<span class="sd">Exponential</span>
<span class="sd">ExponentialPower</span>
<span class="sd">FDistribution</span>
<span class="sd">FisherZ</span>
<span class="sd">Frechet</span>
<span class="sd">Gamma</span>
<span class="sd">GammaInverse</span>
<span class="sd">Gumbel</span>
<span class="sd">Gompertz</span>
<span class="sd">Kumaraswamy</span>
<span class="sd">Laplace</span>
<span class="sd">Levy</span>
<span class="sd">Logistic</span>
<span class="sd">LogLogistic</span>
<span class="sd">LogNormal</span>
<span class="sd">Lomax</span>
<span class="sd">Maxwell</span>
<span class="sd">Moyal</span>
<span class="sd">Nakagami</span>
<span class="sd">Normal</span>
<span class="sd">Pareto</span>
<span class="sd">PowerFunction</span>
<span class="sd">QuadraticU</span>
<span class="sd">RaisedCosine</span>
<span class="sd">Rayleigh</span>
<span class="sd">Reciprocal</span>
<span class="sd">ShiftedGompertz</span>
<span class="sd">StudentT</span>
<span class="sd">Trapezoidal</span>
<span class="sd">Triangular</span>
<span class="sd">Uniform</span>
<span class="sd">UniformSum</span>
<span class="sd">VonMises</span>
<span class="sd">Wald</span>
<span class="sd">Weibull</span>
<span class="sd">WignerSemicircle</span>
<span class="sd">&quot;&quot;&quot;</span>



<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">beta</span> <span class="k">as</span> <span class="n">beta_fn</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">tan</span><span class="p">,</span> <span class="n">atan</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">besseli</span><span class="p">,</span> <span class="n">besselj</span><span class="p">,</span> <span class="n">besselk</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="p">(</span><span class="n">log</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Dummy</span><span class="p">,</span> <span class="n">Interval</span><span class="p">,</span> <span class="n">sympify</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">sign</span><span class="p">,</span>
                   <span class="n">Piecewise</span><span class="p">,</span> <span class="n">And</span><span class="p">,</span> <span class="n">Eq</span><span class="p">,</span> <span class="n">binomial</span><span class="p">,</span> <span class="n">factorial</span><span class="p">,</span> <span class="n">Sum</span><span class="p">,</span> <span class="n">floor</span><span class="p">,</span> <span class="n">Abs</span><span class="p">,</span>
                   <span class="n">Lambda</span><span class="p">,</span> <span class="n">Basic</span><span class="p">,</span> <span class="n">lowergamma</span><span class="p">,</span> <span class="n">erf</span><span class="p">,</span> <span class="n">erfc</span><span class="p">,</span> <span class="n">erfi</span><span class="p">,</span> <span class="n">erfinv</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">asin</span><span class="p">,</span>
                   <span class="n">hyper</span><span class="p">,</span> <span class="n">uppergamma</span><span class="p">,</span> <span class="n">sinh</span><span class="p">,</span> <span class="n">Ne</span><span class="p">,</span> <span class="n">expint</span><span class="p">,</span> <span class="n">Rational</span><span class="p">,</span> <span class="n">integrate</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">sympy.matrices</span> <span class="kn">import</span> <span class="n">MatrixBase</span><span class="p">,</span> <span class="n">MatrixExpr</span>
<span class="kn">from</span> <span class="nn">sympy.stats.crv</span> <span class="kn">import</span> <span class="n">SingleContinuousPSpace</span><span class="p">,</span> <span class="n">SingleContinuousDistribution</span>
<span class="kn">from</span> <span class="nn">sympy.stats.rv</span> <span class="kn">import</span> <span class="n">_value_check</span><span class="p">,</span> <span class="n">is_random</span>

<span class="n">oo</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ContinuousRV&#39;</span><span class="p">,</span>
<span class="s1">&#39;Arcsin&#39;</span><span class="p">,</span>
<span class="s1">&#39;Benini&#39;</span><span class="p">,</span>
<span class="s1">&#39;Beta&#39;</span><span class="p">,</span>
<span class="s1">&#39;BetaNoncentral&#39;</span><span class="p">,</span>
<span class="s1">&#39;BetaPrime&#39;</span><span class="p">,</span>
<span class="s1">&#39;BoundedPareto&#39;</span><span class="p">,</span>
<span class="s1">&#39;Cauchy&#39;</span><span class="p">,</span>
<span class="s1">&#39;Chi&#39;</span><span class="p">,</span>
<span class="s1">&#39;ChiNoncentral&#39;</span><span class="p">,</span>
<span class="s1">&#39;ChiSquared&#39;</span><span class="p">,</span>
<span class="s1">&#39;Dagum&#39;</span><span class="p">,</span>
<span class="s1">&#39;Erlang&#39;</span><span class="p">,</span>
<span class="s1">&#39;ExGaussian&#39;</span><span class="p">,</span>
<span class="s1">&#39;Exponential&#39;</span><span class="p">,</span>
<span class="s1">&#39;ExponentialPower&#39;</span><span class="p">,</span>
<span class="s1">&#39;FDistribution&#39;</span><span class="p">,</span>
<span class="s1">&#39;FisherZ&#39;</span><span class="p">,</span>
<span class="s1">&#39;Frechet&#39;</span><span class="p">,</span>
<span class="s1">&#39;Gamma&#39;</span><span class="p">,</span>
<span class="s1">&#39;GammaInverse&#39;</span><span class="p">,</span>
<span class="s1">&#39;Gompertz&#39;</span><span class="p">,</span>
<span class="s1">&#39;Gumbel&#39;</span><span class="p">,</span>
<span class="s1">&#39;Kumaraswamy&#39;</span><span class="p">,</span>
<span class="s1">&#39;Laplace&#39;</span><span class="p">,</span>
<span class="s1">&#39;Levy&#39;</span><span class="p">,</span>
<span class="s1">&#39;Logistic&#39;</span><span class="p">,</span>
<span class="s1">&#39;LogLogistic&#39;</span><span class="p">,</span>
<span class="s1">&#39;LogNormal&#39;</span><span class="p">,</span>
<span class="s1">&#39;Lomax&#39;</span><span class="p">,</span>
<span class="s1">&#39;Maxwell&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moyal&#39;</span><span class="p">,</span>
<span class="s1">&#39;Nakagami&#39;</span><span class="p">,</span>
<span class="s1">&#39;Normal&#39;</span><span class="p">,</span>
<span class="s1">&#39;GaussianInverse&#39;</span><span class="p">,</span>
<span class="s1">&#39;Pareto&#39;</span><span class="p">,</span>
<span class="s1">&#39;PowerFunction&#39;</span><span class="p">,</span>
<span class="s1">&#39;QuadraticU&#39;</span><span class="p">,</span>
<span class="s1">&#39;RaisedCosine&#39;</span><span class="p">,</span>
<span class="s1">&#39;Rayleigh&#39;</span><span class="p">,</span>
<span class="s1">&#39;Reciprocal&#39;</span><span class="p">,</span>
<span class="s1">&#39;StudentT&#39;</span><span class="p">,</span>
<span class="s1">&#39;ShiftedGompertz&#39;</span><span class="p">,</span>
<span class="s1">&#39;Trapezoidal&#39;</span><span class="p">,</span>
<span class="s1">&#39;Triangular&#39;</span><span class="p">,</span>
<span class="s1">&#39;Uniform&#39;</span><span class="p">,</span>
<span class="s1">&#39;UniformSum&#39;</span><span class="p">,</span>
<span class="s1">&#39;VonMises&#39;</span><span class="p">,</span>
<span class="s1">&#39;Wald&#39;</span><span class="p">,</span>
<span class="s1">&#39;Weibull&#39;</span><span class="p">,</span>
<span class="s1">&#39;WignerSemicircle&#39;</span><span class="p">,</span>
<span class="p">]</span>


<span class="nd">@is_random</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">MatrixBase</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">_</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">any</span><span class="p">([</span><span class="n">is_random</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">rv</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">sympify</span><span class="p">,</span> <span class="n">args</span><span class="p">))</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;check&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
        <span class="n">dist</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="n">pspace</span> <span class="o">=</span> <span class="n">SingleContinuousPSpace</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">is_random</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sympy.stats.compound_rv</span> <span class="kn">import</span> <span class="n">CompoundPSpace</span><span class="p">,</span> <span class="n">CompoundDistribution</span>
        <span class="n">pspace</span> <span class="o">=</span> <span class="n">CompoundPSpace</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="n">CompoundDistribution</span><span class="p">(</span><span class="n">dist</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">pspace</span><span class="o">.</span><span class="n">value</span>


<span class="k">class</span> <span class="nc">ContinuousDistributionHandmade</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;pdf&#39;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="nb">set</span><span class="o">=</span><span class="n">Interval</span><span class="p">(</span><span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="n">oo</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">Basic</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="nb">set</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">pdf</span><span class="p">,</span> <span class="nb">set</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">set</span><span class="p">))</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="n">S</span><span class="o">.</span><span class="n">false</span><span class="p">,</span> <span class="s2">&quot;The pdf on the given set is incorrect.&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">ContinuousRV</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="nb">set</span><span class="o">=</span><span class="n">Interval</span><span class="p">(</span><span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="n">oo</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a Continuous Random Variable given the following:</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    symbol : Symbol</span>
<span class="sd">        Represents name of the random variable.</span>
<span class="sd">    density : Expression containing symbol</span>
<span class="sd">        Represents probability density function.</span>
<span class="sd">    set : set/Interval</span>
<span class="sd">        Represents the region where the pdf is valid, by default is real line.</span>
<span class="sd">    check : bool</span>
<span class="sd">        If True, it will check whether the given density</span>
<span class="sd">        integrates to 1 over the given set. If False, it</span>
<span class="sd">        will not perform this check. Default is False.</span>


<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Many common continuous random variable types are already implemented.</span>
<span class="sd">    This function should be necessary only very rarely.</span>


<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, sqrt, exp, pi</span>
<span class="sd">    &gt;&gt;&gt; from sympy.stats import ContinuousRV, P, E</span>

<span class="sd">    &gt;&gt;&gt; x = Symbol(&quot;x&quot;)</span>

<span class="sd">    &gt;&gt;&gt; pdf = sqrt(2)*exp(-x**2/2)/(2*sqrt(pi)) # Normal distribution</span>
<span class="sd">    &gt;&gt;&gt; X = ContinuousRV(x, pdf)</span>

<span class="sd">    &gt;&gt;&gt; E(X)</span>
<span class="sd">    0</span>
<span class="sd">    &gt;&gt;&gt; P(X&gt;0)</span>
<span class="sd">    1/2</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pdf</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">((</span><span class="n">density</span><span class="p">,</span> <span class="nb">set</span><span class="o">.</span><span class="n">as_relational</span><span class="p">(</span><span class="n">symbol</span><span class="p">)),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>
    <span class="n">pdf</span> <span class="o">=</span> <span class="n">Lambda</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="n">pdf</span><span class="p">)</span>
    <span class="c1"># have a default of False while `rv` should have a default of True</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;check&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;check&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">symbol</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">ContinuousDistributionHandmade</span><span class="p">,</span> <span class="p">(</span><span class="n">pdf</span><span class="p">,</span> <span class="nb">set</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="c1">########################################</span>
<span class="c1"># Continuous Probability Distributions #</span>
<span class="c1">########################################</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Arcsin distribution ----------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">ArcsinDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Interval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">sqrt</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">x</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">(</span>
            <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">a</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">asin</span><span class="p">(</span><span class="n">sqrt</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)))</span><span class="o">/</span><span class="n">pi</span><span class="p">,</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">),</span>
            <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">Arcsin</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a Continuous Random Variable with an arcsin distribution.</span>

<span class="sd">    The density of the arcsin distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{1}{\pi\sqrt{(x-a)(b-x)}}</span>

<span class="sd">    with :math:`x \in (a,b)`. It must hold that :math:`-\infty &lt; a &lt; b &lt; \infty`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    a : Real number, the left interval boundary</span>
<span class="sd">    b : Real number, the right interval boundary</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import Arcsin, density, cdf</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol</span>

<span class="sd">    &gt;&gt;&gt; a = Symbol(&quot;a&quot;, real=True)</span>
<span class="sd">    &gt;&gt;&gt; b = Symbol(&quot;b&quot;, real=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = Arcsin(&quot;x&quot;, a, b)</span>

<span class="sd">    &gt;&gt;&gt; density(X)(z)</span>
<span class="sd">    1/(pi*sqrt((-a + z)*(b - z)))</span>

<span class="sd">    &gt;&gt;&gt; cdf(X)(z)</span>
<span class="sd">    Piecewise((0, a &gt; z),</span>
<span class="sd">            (2*asin(sqrt((-a + z)/(-a + b)))/pi, b &gt;= z),</span>
<span class="sd">            (1, True))</span>


<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Arcsine_distribution</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">ArcsinDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Benini distribution ----------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">BeniniDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">,</span> <span class="s1">&#39;sigma&#39;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Shape parameter Alpha must be positive.&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">beta</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Shape parameter Beta must be positive.&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">sigma</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Scale parameter Sigma must be positive.&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Interval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">sigma</span><span class="p">)</span> <span class="o">-</span> <span class="n">beta</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">sigma</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
               <span class="o">*</span><span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">sigma</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_moment_generating_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;The moment generating function of the &#39;</span>
                                  <span class="s1">&#39;Benini distribution does not exist.&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">Benini</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a Continuous Random Variable with a Benini distribution.</span>

<span class="sd">    The density of the Benini distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := e^{-\alpha\log{\frac{x}{\sigma}}</span>
<span class="sd">                -\beta\log^2\left[{\frac{x}{\sigma}}\right]}</span>
<span class="sd">                \left(\frac{\alpha}{x}+\frac{2\beta\log{\frac{x}{\sigma}}}{x}\right)</span>

<span class="sd">    This is a heavy-tailed distribution and is also known as the log-Rayleigh</span>
<span class="sd">    distribution.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    alpha : Real number, `\alpha &gt; 0`, a shape</span>
<span class="sd">    beta : Real number, `\beta &gt; 0`, a shape</span>
<span class="sd">    sigma : Real number, `\sigma &gt; 0`, a scale</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import Benini, density, cdf</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, pprint</span>

<span class="sd">    &gt;&gt;&gt; alpha = Symbol(&quot;alpha&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; beta = Symbol(&quot;beta&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; sigma = Symbol(&quot;sigma&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = Benini(&quot;x&quot;, alpha, beta, sigma)</span>

<span class="sd">    &gt;&gt;&gt; D = density(X)(z)</span>
<span class="sd">    &gt;&gt;&gt; pprint(D, use_unicode=False)</span>
<span class="sd">    /                  /  z  \\             /  z  \            2/  z  \</span>
<span class="sd">    |        2*beta*log|-----||  - alpha*log|-----| - beta*log  |-----|</span>
<span class="sd">    |alpha             \sigma/|             \sigma/             \sigma/</span>
<span class="sd">    |----- + -----------------|*e</span>
<span class="sd">    \  z             z        /</span>

<span class="sd">    &gt;&gt;&gt; cdf(X)(z)</span>
<span class="sd">    Piecewise((1 - exp(-alpha*log(z/sigma) - beta*log(z/sigma)**2), sigma &lt;= z),</span>
<span class="sd">            (0, True))</span>


<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Benini_distribution</span>
<span class="sd">    .. [2] http://reference.wolfram.com/legacy/v8/ref/BeniniDistribution.html</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">BeniniDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">sigma</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Beta distribution ------------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">BetaDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">)</span>

    <span class="nb">set</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Shape parameter Alpha must be positive.&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">beta</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Shape parameter Beta must be positive.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="n">alpha</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">beta</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">beta_fn</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_characteristic_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">hyper</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">,),</span> <span class="n">I</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_moment_generating_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">hyper</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">,),</span> <span class="n">t</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">Beta</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a Continuous Random Variable with a Beta distribution.</span>

<span class="sd">    The density of the Beta distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{x^{\alpha-1}(1-x)^{\beta-1}} {\mathrm{B}(\alpha,\beta)}</span>

<span class="sd">    with :math:`x \in [0,1]`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    alpha : Real number, `\alpha &gt; 0`, a shape</span>
<span class="sd">    beta : Real number, `\beta &gt; 0`, a shape</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import Beta, density, E, variance</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, simplify, pprint, factor</span>

<span class="sd">    &gt;&gt;&gt; alpha = Symbol(&quot;alpha&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; beta = Symbol(&quot;beta&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = Beta(&quot;x&quot;, alpha, beta)</span>

<span class="sd">    &gt;&gt;&gt; D = density(X)(z)</span>
<span class="sd">    &gt;&gt;&gt; pprint(D, use_unicode=False)</span>
<span class="sd">     alpha - 1        beta - 1</span>
<span class="sd">    z         *(1 - z)</span>
<span class="sd">    --------------------------</span>
<span class="sd">          B(alpha, beta)</span>

<span class="sd">    &gt;&gt;&gt; simplify(E(X))</span>
<span class="sd">    alpha/(alpha + beta)</span>

<span class="sd">    &gt;&gt;&gt; factor(simplify(variance(X)))</span>
<span class="sd">    alpha*beta/((alpha + beta)**2*(alpha + beta + 1))</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Beta_distribution</span>
<span class="sd">    .. [2] http://mathworld.wolfram.com/BetaDistribution.html</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">BetaDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Noncentral Beta distribution ------------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">BetaNoncentralDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">,</span> <span class="s1">&#39;lamda&#39;</span><span class="p">)</span>

    <span class="nb">set</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">lamda</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Shape parameter Alpha must be positive.&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">beta</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Shape parameter Beta must be positive.&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">lamda</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Noncentrality parameter Lambda must be positive&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">lamda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lamda</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">(</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Sum</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">lamda</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">lamda</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="n">k</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="n">alpha</span> <span class="o">+</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span><span class="p">(</span>
            <span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">beta</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="n">beta_fn</span><span class="p">(</span><span class="n">alpha</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span> <span class="n">beta</span><span class="p">)),</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">BetaNoncentral</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">lamda</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a Continuous Random Variable with a Type I Noncentral Beta distribution.</span>

<span class="sd">    The density of the Noncentral Beta distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \sum_{k=0}^\infty e^{-\lambda/2}\frac{(\lambda/2)^k}{k!}</span>
<span class="sd">                \frac{x^{\alpha+k-1}(1-x)^{\beta-1}}{\mathrm{B}(\alpha+k,\beta)}</span>

<span class="sd">    with :math:`x \in [0,1]`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    alpha : Real number, `\alpha &gt; 0`, a shape</span>
<span class="sd">    beta : Real number, `\beta &gt; 0`, a shape</span>
<span class="sd">    lamda: Real number, `\lambda &gt;= 0`, noncentrality parameter</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import BetaNoncentral, density, cdf</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, pprint</span>

<span class="sd">    &gt;&gt;&gt; alpha = Symbol(&quot;alpha&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; beta = Symbol(&quot;beta&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; lamda = Symbol(&quot;lamda&quot;, nonnegative=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = BetaNoncentral(&quot;x&quot;, alpha, beta, lamda)</span>

<span class="sd">    &gt;&gt;&gt; D = density(X)(z)</span>
<span class="sd">    &gt;&gt;&gt; pprint(D, use_unicode=False)</span>
<span class="sd">      oo</span>
<span class="sd">    _____</span>
<span class="sd">    \    `</span>
<span class="sd">     \                                              -lamda</span>
<span class="sd">      \                          k                  -------</span>
<span class="sd">       \    k + alpha - 1 /lamda\         beta - 1     2</span>
<span class="sd">        )  z             *|-----| *(1 - z)        *e</span>
<span class="sd">       /                  \  2  /</span>
<span class="sd">      /    ------------------------------------------------</span>
<span class="sd">     /                  B(k + alpha, beta)*k!</span>
<span class="sd">    /____,</span>
<span class="sd">    k = 0</span>

<span class="sd">    Compute cdf with specific &#39;x&#39;, &#39;alpha&#39;, &#39;beta&#39; and &#39;lamda&#39; values as follows :</span>
<span class="sd">    &gt;&gt;&gt; cdf(BetaNoncentral(&quot;x&quot;, 1, 1, 1), evaluate=False)(2).doit()</span>
<span class="sd">    2*exp(1/2)</span>

<span class="sd">    The argument evaluate=False prevents an attempt at evaluation</span>
<span class="sd">    of the sum for general x, before the argument 2 is passed.</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Noncentral_beta_distribution</span>
<span class="sd">    .. [2] https://reference.wolfram.com/language/ref/NoncentralBetaDistribution.html</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">BetaNoncentralDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">lamda</span><span class="p">))</span>


<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Beta prime distribution ------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">BetaPrimeDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Shape parameter Alpha must be positive.&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">beta</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Shape parameter Beta must be positive.&quot;</span><span class="p">)</span>

    <span class="nb">set</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="n">alpha</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span> <span class="o">-</span> <span class="n">beta</span><span class="p">)</span><span class="o">/</span><span class="n">beta_fn</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">BetaPrime</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with a Beta prime distribution.</span>

<span class="sd">    The density of the Beta prime distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{x^{\alpha-1} (1+x)^{-\alpha -\beta}}{B(\alpha,\beta)}</span>

<span class="sd">    with :math:`x &gt; 0`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    alpha : Real number, `\alpha &gt; 0`, a shape</span>
<span class="sd">    beta : Real number, `\beta &gt; 0`, a shape</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import BetaPrime, density</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, pprint</span>

<span class="sd">    &gt;&gt;&gt; alpha = Symbol(&quot;alpha&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; beta = Symbol(&quot;beta&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = BetaPrime(&quot;x&quot;, alpha, beta)</span>

<span class="sd">    &gt;&gt;&gt; D = density(X)(z)</span>
<span class="sd">    &gt;&gt;&gt; pprint(D, use_unicode=False)</span>
<span class="sd">     alpha - 1        -alpha - beta</span>
<span class="sd">    z         *(z + 1)</span>
<span class="sd">    -------------------------------</span>
<span class="sd">             B(alpha, beta)</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Beta_prime_distribution</span>
<span class="sd">    .. [2] http://mathworld.wolfram.com/BetaPrimeDistribution.html</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">BetaPrimeDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Bounded Pareto Distribution --------------------------------------------------</span>
<span class="k">class</span> <span class="nc">BoundedParetoDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Interval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">):</span>
        <span class="n">_value_check</span> <span class="p">(</span><span class="n">alpha</span><span class="o">.</span><span class="n">is_positive</span><span class="p">,</span> <span class="s2">&quot;Shape must be positive.&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span> <span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">is_positive</span><span class="p">,</span> <span class="s2">&quot;Left value should be positive.&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span> <span class="p">(</span><span class="n">right</span> <span class="o">&gt;</span> <span class="n">left</span><span class="p">,</span> <span class="s2">&quot;Right should be greater than left.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">alpha</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">right</span>
        <span class="n">num</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="n">left</span><span class="o">**</span><span class="n">alpha</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="o">-</span> <span class="n">alpha</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">den</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">left</span><span class="o">/</span><span class="n">right</span><span class="p">)</span><span class="o">**</span><span class="n">alpha</span>
        <span class="k">return</span> <span class="n">num</span><span class="o">/</span><span class="n">den</span>

<span class="k">def</span> <span class="nf">BoundedPareto</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with a Bounded Pareto distribution.</span>

<span class="sd">    The density of the Bounded Pareto distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{\alpha L^{\alpha}x^{-\alpha-1}}{1-(\frac{L}{H})^{\alpha}}</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    alpha : Real Number, `alpha &gt; 0`</span>
<span class="sd">        Shape parameter</span>
<span class="sd">    left : Real Number, `left &gt; 0`</span>
<span class="sd">        Location parameter</span>
<span class="sd">    right : Real Number, `right &gt; left`</span>
<span class="sd">        Location parameter</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import BoundedPareto, density, cdf, E</span>
<span class="sd">    &gt;&gt;&gt; from sympy import symbols</span>
<span class="sd">    &gt;&gt;&gt; L, H = symbols(&#39;L, H&#39;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; X = BoundedPareto(&#39;X&#39;, 2, L, H)</span>
<span class="sd">    &gt;&gt;&gt; x = symbols(&#39;x&#39;)</span>
<span class="sd">    &gt;&gt;&gt; density(X)(x)</span>
<span class="sd">    2*L**2/(x**3*(1 - L**2/H**2))</span>
<span class="sd">    &gt;&gt;&gt; cdf(X)(x)</span>
<span class="sd">    Piecewise((-H**2*L**2/(x**2*(H**2 - L**2)) + H**2/(H**2 - L**2), L &lt;= x), (0, True))</span>
<span class="sd">    &gt;&gt;&gt; E(X).simplify()</span>
<span class="sd">    2*H*L/(H + L)</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Pareto_distribution#Bounded_Pareto_distribution</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">rv</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">BoundedParetoDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">))</span>

<span class="c1"># ------------------------------------------------------------------------------</span>
<span class="c1"># Cauchy distribution ----------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">CauchyDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;x0&#39;</span><span class="p">,</span> <span class="s1">&#39;gamma&#39;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">gamma</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">gamma</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Scale parameter Gamma must be positive.&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">x0</span><span class="o">.</span><span class="n">is_real</span><span class="p">,</span> <span class="s2">&quot;Location parameter must be real.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">atan</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="n">gamma</span><span class="p">)</span> <span class="o">+</span> <span class="n">S</span><span class="o">.</span><span class="n">Half</span>

    <span class="k">def</span> <span class="nf">_characteristic_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x0</span> <span class="o">*</span> <span class="n">I</span> <span class="o">*</span> <span class="n">t</span> <span class="o">-</span>  <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">*</span> <span class="n">Abs</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_moment_generating_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;The moment generating function for the &quot;</span>
                                  <span class="s2">&quot;Cauchy distribution does not exist.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_quantile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="o">*</span><span class="n">tan</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">Cauchy</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">gamma</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with a Cauchy distribution.</span>

<span class="sd">    The density of the Cauchy distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{1}{\pi \gamma [1 + {(\frac{x-x_0}{\gamma})}^2]}</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    x0 : Real number, the location</span>
<span class="sd">    gamma : Real number, `\gamma &gt; 0`, a scale</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import Cauchy, density</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol</span>

<span class="sd">    &gt;&gt;&gt; x0 = Symbol(&quot;x0&quot;)</span>
<span class="sd">    &gt;&gt;&gt; gamma = Symbol(&quot;gamma&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = Cauchy(&quot;x&quot;, x0, gamma)</span>

<span class="sd">    &gt;&gt;&gt; density(X)(z)</span>
<span class="sd">    1/(pi*gamma*(1 + (-x0 + z)**2/gamma**2))</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Cauchy_distribution</span>
<span class="sd">    .. [2] http://mathworld.wolfram.com/CauchyDistribution.html</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">CauchyDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">gamma</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Chi distribution -------------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">ChiDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">k</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Number of degrees of freedom (k) must be positive.&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">is_integer</span><span class="p">,</span> <span class="s2">&quot;Number of degrees of freedom (k) must be an integer.&quot;</span><span class="p">)</span>

    <span class="nb">set</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">gamma</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_characteristic_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>

        <span class="n">part_1</span> <span class="o">=</span> <span class="n">hyper</span><span class="p">((</span><span class="n">k</span><span class="o">/</span><span class="mi">2</span><span class="p">,),</span> <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">,),</span> <span class="o">-</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">part_2</span> <span class="o">=</span> <span class="n">I</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">gamma</span><span class="p">((</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">gamma</span><span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">part_3</span> <span class="o">=</span> <span class="n">hyper</span><span class="p">(((</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,),</span> <span class="p">(</span><span class="n">Rational</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),),</span> <span class="o">-</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">part_1</span> <span class="o">+</span> <span class="n">part_2</span><span class="o">*</span><span class="n">part_3</span>

    <span class="k">def</span> <span class="nf">_moment_generating_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>

        <span class="n">part_1</span> <span class="o">=</span> <span class="n">hyper</span><span class="p">((</span><span class="n">k</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,),</span> <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">,),</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">part_2</span> <span class="o">=</span> <span class="n">t</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">gamma</span><span class="p">((</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">gamma</span><span class="p">(</span><span class="n">k</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">part_3</span> <span class="o">=</span> <span class="n">hyper</span><span class="p">(((</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,),</span> <span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,),</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">part_1</span> <span class="o">+</span> <span class="n">part_2</span> <span class="o">*</span> <span class="n">part_3</span>

<span class="k">def</span> <span class="nf">Chi</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with a Chi distribution.</span>

<span class="sd">    The density of the Chi distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{2^{1-k/2}x^{k-1}e^{-x^2/2}}{\Gamma(k/2)}</span>

<span class="sd">    with :math:`x \geq 0`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    k : Positive integer, The number of degrees of freedom</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import Chi, density, E</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, simplify</span>

<span class="sd">    &gt;&gt;&gt; k = Symbol(&quot;k&quot;, integer=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = Chi(&quot;x&quot;, k)</span>

<span class="sd">    &gt;&gt;&gt; density(X)(z)</span>
<span class="sd">    2**(1 - k/2)*z**(k - 1)*exp(-z**2/2)/gamma(k/2)</span>

<span class="sd">    &gt;&gt;&gt; simplify(E(X))</span>
<span class="sd">    sqrt(2)*gamma(k/2 + 1/2)/gamma(k/2)</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Chi_distribution</span>
<span class="sd">    .. [2] http://mathworld.wolfram.com/ChiDistribution.html</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">ChiDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">k</span><span class="p">,))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Non-central Chi distribution -------------------------------------------------</span>


<span class="k">class</span> <span class="nc">ChiNoncentralDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">k</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Number of degrees of freedom (k) must be positive.&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">is_integer</span><span class="p">,</span> <span class="s2">&quot;Number of degrees of freedom (k) must be an integer.&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">l</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Shift parameter Lambda must be positive.&quot;</span><span class="p">)</span>

    <span class="nb">set</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">k</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">l</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">l</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">k</span><span class="o">*</span><span class="n">l</span> <span class="o">/</span> <span class="p">(</span><span class="n">l</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">besseli</span><span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">ChiNoncentral</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with a non-central Chi distribution.</span>

<span class="sd">    The density of the non-central Chi distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{e^{-(x^2+\lambda^2)/2} x^k\lambda}</span>
<span class="sd">                {(\lambda x)^{k/2}} I_{k/2-1}(\lambda x)</span>

<span class="sd">    with `x \geq 0`. Here, `I_\nu (x)` is the</span>
<span class="sd">    :ref:`modified Bessel function of the first kind &lt;besseli&gt;`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    k : A positive Integer, `k &gt; 0`, the number of degrees of freedom</span>
<span class="sd">    lambda : Real number, `\lambda &gt; 0`, Shift parameter</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import ChiNoncentral, density</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol</span>

<span class="sd">    &gt;&gt;&gt; k = Symbol(&quot;k&quot;, integer=True)</span>
<span class="sd">    &gt;&gt;&gt; l = Symbol(&quot;l&quot;)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = ChiNoncentral(&quot;x&quot;, k, l)</span>

<span class="sd">    &gt;&gt;&gt; density(X)(z)</span>
<span class="sd">    l*z**k*(l*z)**(-k/2)*exp(-l**2/2 - z**2/2)*besseli(k/2 - 1, l*z)</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Noncentral_chi_distribution</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">ChiNoncentralDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Chi squared distribution -----------------------------------------------------</span>


<span class="k">class</span> <span class="nc">ChiSquaredDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">k</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Number of degrees of freedom (k) must be positive.&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">is_integer</span><span class="p">,</span> <span class="s2">&quot;Number of degrees of freedom (k) must be an integer.&quot;</span><span class="p">)</span>

    <span class="nb">set</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">gamma</span><span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">(</span>
                <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="o">/</span><span class="n">gamma</span><span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">lowergamma</span><span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_characteristic_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span>  <span class="nf">_moment_generating_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">ChiSquared</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with a Chi-squared distribution.</span>

<span class="sd">    The density of the Chi-squared distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{1}{2^{\frac{k}{2}}\Gamma\left(\frac{k}{2}\right)}</span>
<span class="sd">                x^{\frac{k}{2}-1} e^{-\frac{x}{2}}</span>

<span class="sd">    with :math:`x \geq 0`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    k : Positive integer, The number of degrees of freedom</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import ChiSquared, density, E, variance, moment</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol</span>

<span class="sd">    &gt;&gt;&gt; k = Symbol(&quot;k&quot;, integer=True, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = ChiSquared(&quot;x&quot;, k)</span>

<span class="sd">    &gt;&gt;&gt; density(X)(z)</span>
<span class="sd">    2**(-k/2)*z**(k/2 - 1)*exp(-z/2)/gamma(k/2)</span>

<span class="sd">    &gt;&gt;&gt; E(X)</span>
<span class="sd">    k</span>

<span class="sd">    &gt;&gt;&gt; variance(X)</span>
<span class="sd">    2*k</span>

<span class="sd">    &gt;&gt;&gt; moment(X, 3)</span>
<span class="sd">    k**3 + 6*k**2 + 8*k</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Chi_squared_distribution</span>
<span class="sd">    .. [2] http://mathworld.wolfram.com/Chi-SquaredDistribution.html</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">ChiSquaredDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Dagum distribution -----------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">DagumDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>

    <span class="nb">set</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">p</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Shape parameter p must be positive.&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Shape parameter a must be positive.&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">b</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Scale parameter b must be positive.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">p</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">p</span><span class="o">/</span><span class="n">x</span><span class="o">*</span><span class="p">((</span><span class="n">x</span><span class="o">/</span><span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="o">/</span><span class="p">(((</span><span class="n">x</span><span class="o">/</span><span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">p</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">(((</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">+</span> <span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">b</span><span class="p">)</span><span class="o">**-</span><span class="n">a</span><span class="p">)</span><span class="o">**-</span><span class="n">p</span><span class="p">,</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">),</span>
                    <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">Dagum</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with a Dagum distribution.</span>

<span class="sd">    The density of the Dagum distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{a p}{x} \left( \frac{\left(\tfrac{x}{b}\right)^{a p}}</span>
<span class="sd">                {\left(\left(\tfrac{x}{b}\right)^a + 1 \right)^{p+1}} \right)</span>

<span class="sd">    with :math:`x &gt; 0`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    p : Real number, `p &gt; 0`, a shape</span>
<span class="sd">    a : Real number, `a &gt; 0`, a shape</span>
<span class="sd">    b : Real number, `b &gt; 0`, a scale</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import Dagum, density, cdf</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol</span>

<span class="sd">    &gt;&gt;&gt; p = Symbol(&quot;p&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; a = Symbol(&quot;a&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; b = Symbol(&quot;b&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = Dagum(&quot;x&quot;, p, a, b)</span>

<span class="sd">    &gt;&gt;&gt; density(X)(z)</span>
<span class="sd">    a*p*(z/b)**(a*p)*((z/b)**a + 1)**(-p - 1)/z</span>

<span class="sd">    &gt;&gt;&gt; cdf(X)(z)</span>
<span class="sd">    Piecewise(((1 + (z/b)**(-a))**(-p), z &gt;= 0), (0, True))</span>


<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Dagum_distribution</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">DagumDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Erlang distribution ----------------------------------------------------------</span>


<span class="k">def</span> <span class="nf">Erlang</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with an Erlang distribution.</span>

<span class="sd">    The density of the Erlang distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{\lambda^k x^{k-1} e^{-\lambda x}}{(k-1)!}</span>

<span class="sd">    with :math:`x \in [0,\infty]`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    k : Positive integer</span>
<span class="sd">    l : Real number, `\lambda &gt; 0`, the rate</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import Erlang, density, cdf, E, variance</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, simplify, pprint</span>

<span class="sd">    &gt;&gt;&gt; k = Symbol(&quot;k&quot;, integer=True, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; l = Symbol(&quot;l&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = Erlang(&quot;x&quot;, k, l)</span>

<span class="sd">    &gt;&gt;&gt; D = density(X)(z)</span>
<span class="sd">    &gt;&gt;&gt; pprint(D, use_unicode=False)</span>
<span class="sd">     k  k - 1  -l*z</span>
<span class="sd">    l *z     *e</span>
<span class="sd">    ---------------</span>
<span class="sd">        Gamma(k)</span>

<span class="sd">    &gt;&gt;&gt; C = cdf(X)(z)</span>
<span class="sd">    &gt;&gt;&gt; pprint(C, use_unicode=False)</span>
<span class="sd">    /lowergamma(k, l*z)</span>
<span class="sd">    |------------------  for z &gt; 0</span>
<span class="sd">    &lt;     Gamma(k)</span>
<span class="sd">    |</span>
<span class="sd">    \        0           otherwise</span>


<span class="sd">    &gt;&gt;&gt; E(X)</span>
<span class="sd">    k/l</span>

<span class="sd">    &gt;&gt;&gt; simplify(variance(X))</span>
<span class="sd">    k/l**2</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Erlang_distribution</span>
<span class="sd">    .. [2] http://mathworld.wolfram.com/ErlangDistribution.html</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">GammaDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="o">/</span><span class="n">l</span><span class="p">))</span>

<span class="c1"># -------------------------------------------------------------------------------</span>
<span class="c1"># ExGaussian distribution -----------------------------------------------------</span>


<span class="k">class</span> <span class="nc">ExGaussianDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;rate&#39;</span><span class="p">)</span>

    <span class="nb">set</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">rate</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span>
            <span class="n">std</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Standard deviation of ExGaussian must be positive.&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">rate</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Rate of ExGaussian must be positive.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate</span>
        <span class="n">term1</span> <span class="o">=</span> <span class="n">rate</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">term2</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">rate</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">mean</span> <span class="o">+</span> <span class="n">rate</span> <span class="o">*</span> <span class="n">std</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">term3</span> <span class="o">=</span> <span class="n">erfc</span><span class="p">((</span><span class="n">mean</span> <span class="o">+</span> <span class="n">rate</span><span class="o">*</span><span class="n">std</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">std</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">term1</span><span class="o">*</span><span class="n">term2</span><span class="o">*</span><span class="n">term3</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sympy.stats</span> <span class="kn">import</span> <span class="n">cdf</span>
        <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">rate</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">rate</span><span class="o">*</span><span class="n">std</span>
        <span class="n">GaussianCDF1</span> <span class="o">=</span> <span class="n">cdf</span><span class="p">(</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">v</span><span class="p">))(</span><span class="n">u</span><span class="p">)</span>
        <span class="n">GaussianCDF2</span> <span class="o">=</span> <span class="n">cdf</span><span class="p">(</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">v</span><span class="p">))(</span><span class="n">u</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">GaussianCDF1</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">u</span> <span class="o">+</span> <span class="p">(</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">GaussianCDF2</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_characteristic_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate</span>
        <span class="n">term1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">I</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">rate</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">term2</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">mean</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">std</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">term1</span> <span class="o">*</span> <span class="n">term2</span>

    <span class="k">def</span> <span class="nf">_moment_generating_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate</span>
        <span class="n">term1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t</span><span class="o">/</span><span class="n">rate</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">term2</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">mean</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">std</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">term1</span><span class="o">*</span><span class="n">term2</span>


<span class="k">def</span> <span class="nf">ExGaussian</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">rate</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with an Exponentially modified</span>
<span class="sd">    Gaussian (EMG) distribution.</span>

<span class="sd">    The density of the exponentially modified Gaussian distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{\lambda}{2}e^{\frac{\lambda}{2}(2\mu+\lambda\sigma^2-2x)}</span>
<span class="sd">            \text{erfc}(\frac{\mu + \lambda\sigma^2 - x}{\sqrt{2}\sigma})</span>

<span class="sd">    with `x &gt; 0`. Note that the expected value is `1/\lambda`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    mu : A Real number, the mean of Gaussian component</span>
<span class="sd">    std: A positive Real number,</span>
<span class="sd">        :math: `\sigma^2 &gt; 0` the variance of Gaussian component</span>
<span class="sd">    lambda: A positive Real number,</span>
<span class="sd">        :math: `\lambda &gt; 0` the rate of Exponential component</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import ExGaussian, density, cdf, E</span>
<span class="sd">    &gt;&gt;&gt; from sympy.stats import variance, skewness</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, pprint, simplify</span>

<span class="sd">    &gt;&gt;&gt; mean = Symbol(&quot;mu&quot;)</span>
<span class="sd">    &gt;&gt;&gt; std = Symbol(&quot;sigma&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; rate = Symbol(&quot;lamda&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>
<span class="sd">    &gt;&gt;&gt; X = ExGaussian(&quot;x&quot;, mean, std, rate)</span>

<span class="sd">    &gt;&gt;&gt; pprint(density(X)(z), use_unicode=False)</span>
<span class="sd">                 /           2             \</span>
<span class="sd">           lamda*\lamda*sigma  + 2*mu - 2*z/</span>
<span class="sd">           ---------------------------------     /  ___ /           2         \\</span>
<span class="sd">                           2                     |\/ 2 *\lamda*sigma  + mu - z/|</span>
<span class="sd">    lamda*e                                 *erfc|-----------------------------|</span>
<span class="sd">                                                 \           2*sigma           /</span>
<span class="sd">    ----------------------------------------------------------------------------</span>
<span class="sd">                                         2</span>

<span class="sd">    &gt;&gt;&gt; cdf(X)(z)</span>
<span class="sd">    -(erf(sqrt(2)*(-lamda**2*sigma**2 + lamda*(-mu + z))/(2*lamda*sigma))/2 + 1/2)*exp(lamda**2*sigma**2/2 - lamda*(-mu + z)) + erf(sqrt(2)*(-mu + z)/(2*sigma))/2 + 1/2</span>

<span class="sd">    &gt;&gt;&gt; E(X)</span>
<span class="sd">    (lamda*mu + 1)/lamda</span>

<span class="sd">    &gt;&gt;&gt; simplify(variance(X))</span>
<span class="sd">    sigma**2 + lamda**(-2)</span>

<span class="sd">    &gt;&gt;&gt; simplify(skewness(X))</span>
<span class="sd">    2/(lamda**2*sigma**2 + 1)**(3/2)</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Exponentially_modified_Gaussian_distribution</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">ExGaussianDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">rate</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Exponential distribution -----------------------------------------------------</span>


<span class="k">class</span> <span class="nc">ExponentialDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;rate&#39;</span><span class="p">,)</span>

    <span class="nb">set</span>  <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">rate</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">rate</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Rate must be positive.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">rate</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">(</span>
                <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">rate</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_characteristic_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate</span>
        <span class="k">return</span> <span class="n">rate</span> <span class="o">/</span> <span class="p">(</span><span class="n">rate</span> <span class="o">-</span> <span class="n">I</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_moment_generating_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate</span>
        <span class="k">return</span> <span class="n">rate</span> <span class="o">/</span> <span class="p">(</span><span class="n">rate</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_quantile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">rate</span>

<span class="k">def</span> <span class="nf">Exponential</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">rate</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with an Exponential distribution.</span>

<span class="sd">    The density of the exponential distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \lambda \exp(-\lambda x)</span>

<span class="sd">    with `x &gt; 0`. Note that the expected value is `1/\lambda`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    rate : A positive Real number, `\lambda &gt; 0`, the rate (or inverse scale/inverse mean)</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import Exponential, density, cdf, E</span>
<span class="sd">    &gt;&gt;&gt; from sympy.stats import variance, std, skewness, quantile</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol</span>

<span class="sd">    &gt;&gt;&gt; l = Symbol(&quot;lambda&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>
<span class="sd">    &gt;&gt;&gt; p = Symbol(&quot;p&quot;)</span>
<span class="sd">    &gt;&gt;&gt; X = Exponential(&quot;x&quot;, l)</span>

<span class="sd">    &gt;&gt;&gt; density(X)(z)</span>
<span class="sd">    lambda*exp(-lambda*z)</span>

<span class="sd">    &gt;&gt;&gt; cdf(X)(z)</span>
<span class="sd">    Piecewise((1 - exp(-lambda*z), z &gt;= 0), (0, True))</span>

<span class="sd">    &gt;&gt;&gt; quantile(X)(p)</span>
<span class="sd">    -log(1 - p)/lambda</span>

<span class="sd">    &gt;&gt;&gt; E(X)</span>
<span class="sd">    1/lambda</span>

<span class="sd">    &gt;&gt;&gt; variance(X)</span>
<span class="sd">    lambda**(-2)</span>

<span class="sd">    &gt;&gt;&gt; skewness(X)</span>
<span class="sd">    2</span>

<span class="sd">    &gt;&gt;&gt; X = Exponential(&#39;x&#39;, 10)</span>

<span class="sd">    &gt;&gt;&gt; density(X)(z)</span>
<span class="sd">    10*exp(-10*z)</span>

<span class="sd">    &gt;&gt;&gt; E(X)</span>
<span class="sd">    1/10</span>

<span class="sd">    &gt;&gt;&gt; std(X)</span>
<span class="sd">    1/10</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Exponential_distribution</span>
<span class="sd">    .. [2] http://mathworld.wolfram.com/ExponentialDistribution.html</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">ExponentialDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">rate</span><span class="p">,</span> <span class="p">))</span>


<span class="c1"># -------------------------------------------------------------------------------</span>
<span class="c1"># Exponential Power distribution -----------------------------------------------------</span>

<span class="k">class</span> <span class="nc">ExponentialPowerDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;mu&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">)</span>

    <span class="nb">set</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Scale parameter alpha must be positive.&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">beta</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Shape parameter beta must be positive.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span>
        <span class="n">num</span> <span class="o">=</span> <span class="n">beta</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">Abs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span><span class="p">)</span><span class="o">**</span><span class="n">beta</span><span class="p">)</span>
        <span class="n">den</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">gamma</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">beta</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">num</span><span class="o">/</span><span class="n">den</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span>
        <span class="n">num</span> <span class="o">=</span> <span class="n">lowergamma</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">beta</span><span class="p">,</span> <span class="p">(</span><span class="n">Abs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span> <span class="o">/</span> <span class="n">alpha</span><span class="p">)</span><span class="o">**</span><span class="n">beta</span><span class="p">)</span>
        <span class="n">den</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">gamma</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">beta</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sign</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">*</span><span class="n">num</span><span class="o">/</span><span class="n">den</span> <span class="o">+</span> <span class="n">S</span><span class="o">.</span><span class="n">Half</span>


<span class="k">def</span> <span class="nf">ExponentialPower</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a Continuous Random Variable with Exponential Power distribution.</span>
<span class="sd">    This distribution is known also as Generalized Normal</span>
<span class="sd">    distribution version 1</span>

<span class="sd">    The density of the Exponential Power distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{\beta}{2\alpha\Gamma(\frac{1}{\beta})}</span>
<span class="sd">            e^{{-(\frac{|x - \mu|}{\alpha})^{\beta}}}</span>

<span class="sd">    with :math:`x \in [ - \infty, \infty ]`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    mu : Real number, &#39;mu&#39; is a location</span>
<span class="sd">    alpha : Real number, &#39;alpha &gt; 0&#39; is a scale</span>
<span class="sd">    beta : Real number, &#39;beta &gt; 0&#39; is a shape</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import ExponentialPower, density, cdf</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, pprint</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>
<span class="sd">    &gt;&gt;&gt; mu = Symbol(&quot;mu&quot;)</span>
<span class="sd">    &gt;&gt;&gt; alpha = Symbol(&quot;alpha&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; beta = Symbol(&quot;beta&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; X = ExponentialPower(&quot;x&quot;, mu, alpha, beta)</span>
<span class="sd">    &gt;&gt;&gt; pprint(density(X)(z), use_unicode=False)</span>
<span class="sd">                     beta</span>
<span class="sd">           /|mu - z|\</span>
<span class="sd">          -|--------|</span>
<span class="sd">           \ alpha  /</span>
<span class="sd">    beta*e</span>
<span class="sd">    ---------------------</span>
<span class="sd">                  / 1  \</span>
<span class="sd">     2*alpha*Gamma|----|</span>
<span class="sd">                  \beta/</span>
<span class="sd">    &gt;&gt;&gt; cdf(X)(z)</span>
<span class="sd">    1/2 + lowergamma(1/beta, (Abs(mu - z)/alpha)**beta)*sign(-mu + z)/(2*gamma(1/beta))</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://reference.wolfram.com/language/ref/ExponentialPowerDistribution.html</span>
<span class="sd">    .. [2] https://en.wikipedia.org/wiki/Generalized_normal_distribution#Version_1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">ExponentialPowerDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">))</span>


<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># F distribution ---------------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">FDistributionDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;d1&#39;</span><span class="p">,</span> <span class="s1">&#39;d2&#39;</span><span class="p">)</span>

    <span class="nb">set</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">((</span><span class="n">d1</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">d1</span><span class="o">.</span><span class="n">is_integer</span><span class="p">),</span>
            <span class="s2">&quot;Degrees of freedom d1 must be positive integer.&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">((</span><span class="n">d2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">d2</span><span class="o">.</span><span class="n">is_integer</span><span class="p">),</span>
            <span class="s2">&quot;Degrees of freedom d2 must be positive integer.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">d1</span><span class="p">,</span> <span class="n">d2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">d1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d2</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">sqrt</span><span class="p">((</span><span class="n">d1</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="n">d1</span><span class="o">*</span><span class="n">d2</span><span class="o">**</span><span class="n">d2</span> <span class="o">/</span> <span class="p">(</span><span class="n">d1</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">d2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">d1</span><span class="o">+</span><span class="n">d2</span><span class="p">))</span>
               <span class="o">/</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">beta_fn</span><span class="p">(</span><span class="n">d1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">d2</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_moment_generating_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;The moment generating function for the &#39;</span>
                                  <span class="s1">&#39;F-distribution does not exist.&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">FDistribution</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with a F distribution.</span>

<span class="sd">    The density of the F distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{\sqrt{\frac{(d_1 x)^{d_1} d_2^{d_2}}</span>
<span class="sd">                {(d_1 x + d_2)^{d_1 + d_2}}}}</span>
<span class="sd">                {x \mathrm{B} \left(\frac{d_1}{2}, \frac{d_2}{2}\right)}</span>

<span class="sd">    with :math:`x &gt; 0`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    d1 : `d_1 &gt; 0`, where d_1 is the degrees of freedom (n_1 - 1)</span>
<span class="sd">    d2 : `d_2 &gt; 0`, where d_2 is the degrees of freedom (n_2 - 1)</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import FDistribution, density</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, pprint</span>

<span class="sd">    &gt;&gt;&gt; d1 = Symbol(&quot;d1&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; d2 = Symbol(&quot;d2&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = FDistribution(&quot;x&quot;, d1, d2)</span>

<span class="sd">    &gt;&gt;&gt; D = density(X)(z)</span>
<span class="sd">    &gt;&gt;&gt; pprint(D, use_unicode=False)</span>
<span class="sd">      d2</span>
<span class="sd">      --    ______________________________</span>
<span class="sd">      2    /       d1            -d1 - d2</span>
<span class="sd">    d2  *\/  (d1*z)  *(d1*z + d2)</span>
<span class="sd">    --------------------------------------</span>
<span class="sd">                    /d1  d2\</span>
<span class="sd">                 z*B|--, --|</span>
<span class="sd">                    \2   2 /</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/F-distribution</span>
<span class="sd">    .. [2] http://mathworld.wolfram.com/F-Distribution.html</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">FDistributionDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Fisher Z distribution --------------------------------------------------------</span>

<span class="k">class</span> <span class="nc">FisherZDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;d1&#39;</span><span class="p">,</span> <span class="s1">&#39;d2&#39;</span><span class="p">)</span>

    <span class="nb">set</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">d1</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Degree of freedom d1 must be positive.&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">d2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Degree of freedom d2 must be positive.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">d1</span><span class="p">,</span> <span class="n">d2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">d1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d2</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">d1</span><span class="o">**</span><span class="p">(</span><span class="n">d1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">d2</span><span class="o">**</span><span class="p">(</span><span class="n">d2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">beta_fn</span><span class="p">(</span><span class="n">d1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">d2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span>
               <span class="n">exp</span><span class="p">(</span><span class="n">d1</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">d1</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">d2</span><span class="p">)</span><span class="o">**</span><span class="p">((</span><span class="n">d1</span><span class="o">+</span><span class="n">d2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">FisherZ</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a Continuous Random Variable with an Fisher&#39;s Z distribution.</span>

<span class="sd">    The density of the Fisher&#39;s Z distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{2d_1^{d_1/2} d_2^{d_2/2}} {\mathrm{B}(d_1/2, d_2/2)}</span>
<span class="sd">                \frac{e^{d_1z}}{\left(d_1e^{2z}+d_2\right)^{\left(d_1+d_2\right)/2}}</span>


<span class="sd">    .. TODO - What is the difference between these degrees of freedom?</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    d1 : `d_1 &gt; 0`, degree of freedom</span>
<span class="sd">    d2 : `d_2 &gt; 0`, degree of freedom</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import FisherZ, density</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, pprint</span>

<span class="sd">    &gt;&gt;&gt; d1 = Symbol(&quot;d1&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; d2 = Symbol(&quot;d2&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = FisherZ(&quot;x&quot;, d1, d2)</span>

<span class="sd">    &gt;&gt;&gt; D = density(X)(z)</span>
<span class="sd">    &gt;&gt;&gt; pprint(D, use_unicode=False)</span>
<span class="sd">                                d1   d2</span>
<span class="sd">        d1   d2               - -- - --</span>
<span class="sd">        --   --                 2    2</span>
<span class="sd">        2    2  /    2*z     \           d1*z</span>
<span class="sd">    2*d1  *d2  *\d1*e    + d2/         *e</span>
<span class="sd">    -----------------------------------------</span>
<span class="sd">                     /d1  d2\</span>
<span class="sd">                    B|--, --|</span>
<span class="sd">                     \2   2 /</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Fisher%27s_z-distribution</span>
<span class="sd">    .. [2] http://mathworld.wolfram.com/Fishersz-Distribution.html</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">FisherZDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Frechet distribution ---------------------------------------------------------</span>

<span class="k">class</span> <span class="nc">FrechetDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span>

    <span class="nb">set</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Shape parameter alpha must be positive.&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">s</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Scale parameter s must be positive.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">sympify</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">m</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">Basic</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">/</span><span class="n">s</span> <span class="o">*</span> <span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">m</span><span class="p">)</span><span class="o">/</span><span class="n">s</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">m</span><span class="p">)</span><span class="o">/</span><span class="n">s</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">((</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">m</span><span class="p">)</span><span class="o">/</span><span class="n">s</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="p">)),</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="n">m</span><span class="p">),</span>
                        <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">Frechet</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with a Frechet distribution.</span>

<span class="sd">    The density of the Frechet distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{\alpha}{s} \left(\frac{x-m}{s}\right)^{-1-\alpha}</span>
<span class="sd">                 e^{-(\frac{x-m}{s})^{-\alpha}}</span>

<span class="sd">    with :math:`x \geq m`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    a : Real number, :math:`a \in \left(0, \infty\right)` the shape</span>
<span class="sd">    s : Real number, :math:`s \in \left(0, \infty\right)` the scale</span>
<span class="sd">    m : Real number, :math:`m \in \left(-\infty, \infty\right)` the minimum</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import Frechet, density, cdf</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol</span>

<span class="sd">    &gt;&gt;&gt; a = Symbol(&quot;a&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; s = Symbol(&quot;s&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; m = Symbol(&quot;m&quot;, real=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = Frechet(&quot;x&quot;, a, s, m)</span>

<span class="sd">    &gt;&gt;&gt; density(X)(z)</span>
<span class="sd">    a*((-m + z)/s)**(-a - 1)*exp(-((-m + z)/s)**(-a))/s</span>

<span class="sd">    &gt;&gt;&gt; cdf(X)(z)</span>
<span class="sd">     Piecewise((exp(-((-m + z)/s)**(-a)), m &lt;= z), (0, True))</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Fr%C3%A9chet_distribution</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">FrechetDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">m</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Gamma distribution -----------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">GammaDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;theta&#39;</span><span class="p">)</span>

    <span class="nb">set</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">k</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;k must be positive&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">theta</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Theta must be positive&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">k</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="n">theta</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">gamma</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">theta</span><span class="o">**</span><span class="n">k</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">k</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">lowergamma</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">S</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">theta</span><span class="p">)</span><span class="o">/</span><span class="n">gamma</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">),</span>
                    <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_characteristic_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_moment_generating_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">Gamma</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with a Gamma distribution.</span>

<span class="sd">    The density of the Gamma distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{1}{\Gamma(k) \theta^k} x^{k - 1} e^{-\frac{x}{\theta}}</span>

<span class="sd">    with :math:`x \in [0,1]`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    k : Real number, `k &gt; 0`, a shape</span>
<span class="sd">    theta : Real number, `\theta &gt; 0`, a scale</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import Gamma, density, cdf, E, variance</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, pprint, simplify</span>

<span class="sd">    &gt;&gt;&gt; k = Symbol(&quot;k&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; theta = Symbol(&quot;theta&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = Gamma(&quot;x&quot;, k, theta)</span>

<span class="sd">    &gt;&gt;&gt; D = density(X)(z)</span>
<span class="sd">    &gt;&gt;&gt; pprint(D, use_unicode=False)</span>
<span class="sd">                      -z</span>
<span class="sd">                    -----</span>
<span class="sd">         -k  k - 1  theta</span>
<span class="sd">    theta  *z     *e</span>
<span class="sd">    ---------------------</span>
<span class="sd">           Gamma(k)</span>

<span class="sd">    &gt;&gt;&gt; C = cdf(X, meijerg=True)(z)</span>
<span class="sd">    &gt;&gt;&gt; pprint(C, use_unicode=False)</span>
<span class="sd">    /            /     z  \</span>
<span class="sd">    |k*lowergamma|k, -----|</span>
<span class="sd">    |            \   theta/</span>
<span class="sd">    &lt;----------------------  for z &gt;= 0</span>
<span class="sd">    |     Gamma(k + 1)</span>
<span class="sd">    |</span>
<span class="sd">    \          0             otherwise</span>

<span class="sd">    &gt;&gt;&gt; E(X)</span>
<span class="sd">    k*theta</span>

<span class="sd">    &gt;&gt;&gt; V = simplify(variance(X))</span>
<span class="sd">    &gt;&gt;&gt; pprint(V, use_unicode=False)</span>
<span class="sd">           2</span>
<span class="sd">    k*theta</span>


<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Gamma_distribution</span>
<span class="sd">    .. [2] http://mathworld.wolfram.com/GammaDistribution.html</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">GammaDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">theta</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Inverse Gamma distribution ---------------------------------------------------</span>


<span class="k">class</span> <span class="nc">GammaInverseDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>

    <span class="nb">set</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;alpha must be positive&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">b</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;beta must be positive&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="k">return</span> <span class="n">b</span><span class="o">**</span><span class="n">a</span><span class="o">/</span><span class="n">gamma</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">b</span><span class="o">/</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">((</span><span class="n">uppergamma</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">/</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">gamma</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">),</span>
                        <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_characteristic_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">I</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">a</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">besselk</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">t</span><span class="p">))</span> <span class="o">/</span> <span class="n">gamma</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_moment_generating_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;The moment generating function for the &#39;</span>
                                  <span class="s1">&#39;gamma inverse distribution does not exist.&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">GammaInverse</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with an inverse Gamma distribution.</span>

<span class="sd">    The density of the inverse Gamma distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{\beta^\alpha}{\Gamma(\alpha)} x^{-\alpha - 1}</span>
<span class="sd">                \exp\left(\frac{-\beta}{x}\right)</span>

<span class="sd">    with :math:`x &gt; 0`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    a : Real number, `a &gt; 0` a shape</span>
<span class="sd">    b : Real number, `b &gt; 0` a scale</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import GammaInverse, density, cdf</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, pprint</span>

<span class="sd">    &gt;&gt;&gt; a = Symbol(&quot;a&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; b = Symbol(&quot;b&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = GammaInverse(&quot;x&quot;, a, b)</span>

<span class="sd">    &gt;&gt;&gt; D = density(X)(z)</span>
<span class="sd">    &gt;&gt;&gt; pprint(D, use_unicode=False)</span>
<span class="sd">                -b</span>
<span class="sd">                ---</span>
<span class="sd">     a  -a - 1   z</span>
<span class="sd">    b *z      *e</span>
<span class="sd">    ---------------</span>
<span class="sd">       Gamma(a)</span>

<span class="sd">    &gt;&gt;&gt; cdf(X)(z)</span>
<span class="sd">    Piecewise((uppergamma(a, b/z)/gamma(a), z &gt; 0), (0, True))</span>


<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Inverse-gamma_distribution</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">GammaInverseDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>


<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Gumbel distribution (Maximum and Minimum) --------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">GumbelDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;beta&#39;</span><span class="p">,</span> <span class="s1">&#39;mu&#39;</span><span class="p">,</span> <span class="s1">&#39;minimum&#39;</span><span class="p">)</span>

    <span class="nb">set</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">minimum</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">beta</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Scale parameter beta must be positive.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">beta</span><span class="p">,</span> <span class="n">mu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span>
        <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">beta</span>
        <span class="n">f_max</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">beta</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">z</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="p">))</span>
        <span class="n">f_min</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">beta</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">((</span><span class="n">f_min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimum</span><span class="p">),</span> <span class="p">(</span><span class="n">f_max</span><span class="p">,</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimum</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">beta</span><span class="p">,</span> <span class="n">mu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span>
        <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">beta</span>
        <span class="n">F_max</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="p">))</span>
        <span class="n">F_min</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">((</span><span class="n">F_min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimum</span><span class="p">),</span> <span class="p">(</span><span class="n">F_max</span><span class="p">,</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimum</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_characteristic_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">cf_max</span> <span class="o">=</span> <span class="n">gamma</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">I</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
        <span class="n">cf_min</span> <span class="o">=</span> <span class="n">gamma</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">I</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">((</span><span class="n">cf_min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimum</span><span class="p">),</span> <span class="p">(</span><span class="n">cf_max</span><span class="p">,</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimum</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_moment_generating_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">mgf_max</span> <span class="o">=</span> <span class="n">gamma</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
        <span class="n">mgf_min</span> <span class="o">=</span> <span class="n">gamma</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">((</span><span class="n">mgf_min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimum</span><span class="p">),</span> <span class="p">(</span><span class="n">mgf_max</span><span class="p">,</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimum</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">Gumbel</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">minimum</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a Continuous Random Variable with Gumbel distribution.</span>

<span class="sd">    The density of the Gumbel distribution is given by</span>

<span class="sd">    For Maximum</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \dfrac{1}{\beta} \exp \left( -\dfrac{x-\mu}{\beta}</span>
<span class="sd">                - \exp \left( -\dfrac{x - \mu}{\beta} \right) \right)</span>

<span class="sd">    with :math:`x \in [ - \infty, \infty ]`.</span>

<span class="sd">    For Minimum</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{e^{- e^{\frac{- \mu + x}{\beta}} + \frac{- \mu + x}{\beta}}}{\beta}</span>

<span class="sd">    with :math:`x \in [ - \infty, \infty ]`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    mu : Real number, &#39;mu&#39; is a location</span>
<span class="sd">    beta : Real number, &#39;beta &gt; 0&#39; is a scale</span>
<span class="sd">    minimum : Boolean, by default, False, set to True for enabling minimum distribution</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import Gumbel, density, cdf</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol</span>
<span class="sd">    &gt;&gt;&gt; x = Symbol(&quot;x&quot;)</span>
<span class="sd">    &gt;&gt;&gt; mu = Symbol(&quot;mu&quot;)</span>
<span class="sd">    &gt;&gt;&gt; beta = Symbol(&quot;beta&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; X = Gumbel(&quot;x&quot;, beta, mu)</span>
<span class="sd">    &gt;&gt;&gt; density(X)(x)</span>
<span class="sd">    exp(-exp(-(-mu + x)/beta) - (-mu + x)/beta)/beta</span>
<span class="sd">    &gt;&gt;&gt; cdf(X)(x)</span>
<span class="sd">    exp(-exp(-(-mu + x)/beta))</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] http://mathworld.wolfram.com/GumbelDistribution.html</span>
<span class="sd">    .. [2] https://en.wikipedia.org/wiki/Gumbel_distribution</span>
<span class="sd">    .. [3] http://www.mathwave.com/help/easyfit/html/analyses/distributions/gumbel_max.html</span>
<span class="sd">    .. [4] http://www.mathwave.com/help/easyfit/html/analyses/distributions/gumbel_min.html</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">GumbelDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">minimum</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Gompertz distribution --------------------------------------------------------</span>

<span class="k">class</span> <span class="nc">GompertzDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;eta&#39;</span><span class="p">)</span>

    <span class="nb">set</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">eta</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">b</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;b must be positive&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">eta</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;eta must be positive&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">eta</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="k">return</span> <span class="n">b</span><span class="o">*</span><span class="n">eta</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">eta</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">eta</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">eta</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="n">eta</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">eta</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_moment_generating_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">eta</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="k">return</span> <span class="n">eta</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="n">eta</span><span class="p">)</span> <span class="o">*</span> <span class="n">expint</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="n">b</span><span class="p">,</span> <span class="n">eta</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">Gompertz</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">eta</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a Continuous Random Variable with Gompertz distribution.</span>

<span class="sd">    The density of the Gompertz distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := b \eta e^{b x} e^{\eta} \exp \left(-\eta e^{bx} \right)</span>

<span class="sd">    with :math: &#39;x \in [0, \inf)&#39;.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    b: Real number, &#39;b &gt; 0&#39; a scale</span>
<span class="sd">    eta: Real number, &#39;eta &gt; 0&#39; a shape</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import Gompertz, density</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol</span>

<span class="sd">    &gt;&gt;&gt; b = Symbol(&quot;b&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; eta = Symbol(&quot;eta&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = Gompertz(&quot;x&quot;, b, eta)</span>

<span class="sd">    &gt;&gt;&gt; density(X)(z)</span>
<span class="sd">    b*eta*exp(eta)*exp(b*z)*exp(-eta*exp(b*z))</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Gompertz_distribution</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">GompertzDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">eta</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Kumaraswamy distribution -----------------------------------------------------</span>


<span class="k">class</span> <span class="nc">KumaraswamyDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>

    <span class="nb">set</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;a must be positive&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">b</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;b must be positive&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">(</span>
            <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="n">b</span><span class="p">,</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">),</span>
            <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">Kumaraswamy</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a Continuous Random Variable with a Kumaraswamy distribution.</span>

<span class="sd">    The density of the Kumaraswamy distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := a b x^{a-1} (1-x^a)^{b-1}</span>

<span class="sd">    with :math:`x \in [0,1]`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    a : Real number, `a &gt; 0` a shape</span>
<span class="sd">    b : Real number, `b &gt; 0` a shape</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import Kumaraswamy, density, cdf</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, pprint</span>

<span class="sd">    &gt;&gt;&gt; a = Symbol(&quot;a&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; b = Symbol(&quot;b&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = Kumaraswamy(&quot;x&quot;, a, b)</span>

<span class="sd">    &gt;&gt;&gt; D = density(X)(z)</span>
<span class="sd">    &gt;&gt;&gt; pprint(D, use_unicode=False)</span>
<span class="sd">                       b - 1</span>
<span class="sd">         a - 1 /     a\</span>
<span class="sd">    a*b*z     *\1 - z /</span>

<span class="sd">    &gt;&gt;&gt; cdf(X)(z)</span>
<span class="sd">    Piecewise((0, z &lt; 0), (1 - (1 - z**a)**b, z &lt;= 1), (1, True))</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Kumaraswamy_distribution</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">KumaraswamyDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Laplace distribution ---------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">LaplaceDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;mu&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>

    <span class="nb">set</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">b</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Scale parameter b must be positive.&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">mu</span><span class="o">.</span><span class="n">is_real</span><span class="p">,</span> <span class="s2">&quot;Location parameter mu should be real&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Abs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">b</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="o">*</span><span class="n">exp</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">b</span><span class="p">),</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">mu</span><span class="p">),</span>
                    <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">-</span> <span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">b</span><span class="p">),</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="n">mu</span><span class="p">)</span>
                        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_characteristic_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_moment_generating_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">Laplace</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with a Laplace distribution.</span>

<span class="sd">    The density of the Laplace distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{1}{2 b} \exp \left(-\frac{|x-\mu|}b \right)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    mu : Real number or a list/matrix, the location (mean) or the</span>
<span class="sd">        location vector</span>
<span class="sd">    b : Real number or a positive definite matrix, representing a scale</span>
<span class="sd">        or the covariance matrix.</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import Laplace, density, cdf</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, pprint</span>

<span class="sd">    &gt;&gt;&gt; mu = Symbol(&quot;mu&quot;)</span>
<span class="sd">    &gt;&gt;&gt; b = Symbol(&quot;b&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = Laplace(&quot;x&quot;, mu, b)</span>

<span class="sd">    &gt;&gt;&gt; density(X)(z)</span>
<span class="sd">    exp(-Abs(mu - z)/b)/(2*b)</span>

<span class="sd">    &gt;&gt;&gt; cdf(X)(z)</span>
<span class="sd">    Piecewise((exp((-mu + z)/b)/2, mu &gt; z), (1 - exp((mu - z)/b)/2, True))</span>

<span class="sd">    &gt;&gt;&gt; L = Laplace(&#39;L&#39;, [1, 2], [[1, 0], [0, 1]])</span>
<span class="sd">    &gt;&gt;&gt; pprint(density(L)(1, 2), use_unicode=False)</span>
<span class="sd">     5        /     ____\</span>
<span class="sd">    e *besselk\0, \/ 35 /</span>
<span class="sd">    ---------------------</span>
<span class="sd">              pi</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Laplace_distribution</span>
<span class="sd">    .. [2] http://mathworld.wolfram.com/LaplaceDistribution.html</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">MatrixBase</span><span class="p">))</span> <span class="ow">and</span>\
        <span class="nb">isinstance</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">MatrixBase</span><span class="p">)):</span>
        <span class="kn">from</span> <span class="nn">sympy.stats.joint_rv_types</span> <span class="kn">import</span> <span class="n">MultivariateLaplace</span>
        <span class="k">return</span> <span class="n">MultivariateLaplace</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">LaplaceDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Levy distribution ---------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">LevyDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;mu&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Interval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">c</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;c (scale parameter) must be positive&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">mu</span><span class="o">.</span><span class="n">is_real</span><span class="p">,</span> <span class="s2">&quot;mu (location paramater) must be real&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span>
        <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">c</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">+</span> <span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span>
        <span class="k">return</span> <span class="n">erfc</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">c</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu</span><span class="p">))))</span>

    <span class="k">def</span> <span class="nf">_characteristic_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="n">I</span> <span class="o">*</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">t</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">I</span> <span class="o">*</span> <span class="n">c</span> <span class="o">*</span> <span class="n">t</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_moment_generating_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;The moment generating function of Levy distribution does not exist.&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">Levy</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with a Levy distribution.</span>

<span class="sd">    The density of the Levy distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \sqrt(\frac{c}{2 \pi}) \frac{\exp -\frac{c}{2 (x - \mu)}}{(x - \mu)^{3/2}}</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    mu : Real number, the location parameter</span>
<span class="sd">    c : Real number, `c &gt; 0`, a scale parameter</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import Levy, density, cdf</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol</span>

<span class="sd">    &gt;&gt;&gt; mu = Symbol(&quot;mu&quot;, real=True)</span>
<span class="sd">    &gt;&gt;&gt; c = Symbol(&quot;c&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = Levy(&quot;x&quot;, mu, c)</span>

<span class="sd">    &gt;&gt;&gt; density(X)(z)</span>
<span class="sd">    sqrt(2)*sqrt(c)*exp(-c/(-2*mu + 2*z))/(2*sqrt(pi)*(-mu + z)**(3/2))</span>

<span class="sd">    &gt;&gt;&gt; cdf(X)(z)</span>
<span class="sd">    erfc(sqrt(c)*sqrt(1/(-2*mu + 2*z)))</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>
<span class="sd">    .. [1] https://en.wikipedia.org/wiki/L%C3%A9vy_distribution</span>
<span class="sd">    .. [2] http://mathworld.wolfram.com/LevyDistribution.html</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">LevyDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Logistic distribution --------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">LogisticDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;mu&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>

    <span class="nb">set</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">s</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Scale parameter s must be positive.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">s</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span>
        <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">s</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_characteristic_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">((</span><span class="n">exp</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">)</span> <span class="o">*</span> <span class="n">pi</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="o">*</span><span class="n">t</span> <span class="o">/</span> <span class="n">sinh</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="o">*</span><span class="n">t</span><span class="p">),</span> <span class="n">Ne</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span> <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_moment_generating_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">beta_fn</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_quantile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="o">-</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">+</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="o">/</span><span class="n">p</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">Logistic</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with a logistic distribution.</span>

<span class="sd">    The density of the logistic distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{e^{-(x-\mu)/s}} {s\left(1+e^{-(x-\mu)/s}\right)^2}</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    mu : Real number, the location (mean)</span>
<span class="sd">    s : Real number, `s &gt; 0` a scale</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import Logistic, density, cdf</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol</span>

<span class="sd">    &gt;&gt;&gt; mu = Symbol(&quot;mu&quot;, real=True)</span>
<span class="sd">    &gt;&gt;&gt; s = Symbol(&quot;s&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = Logistic(&quot;x&quot;, mu, s)</span>

<span class="sd">    &gt;&gt;&gt; density(X)(z)</span>
<span class="sd">    exp((mu - z)/s)/(s*(exp((mu - z)/s) + 1)**2)</span>

<span class="sd">    &gt;&gt;&gt; cdf(X)(z)</span>
<span class="sd">    1/(exp((mu - z)/s) + 1)</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Logistic_distribution</span>
<span class="sd">    .. [2] http://mathworld.wolfram.com/LogisticDistribution.html</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">LogisticDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Log-logistic distribution --------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">LogLogisticDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">)</span>

    <span class="nb">set</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Scale parameter Alpha must be positive.&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">beta</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Shape parameter Beta must be positive.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span>
        <span class="k">return</span> <span class="p">((</span><span class="n">b</span><span class="o">/</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">b</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_quantile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="p">((</span><span class="n">p</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">b</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">expectation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">((</span><span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">,</span> <span class="n">b</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">a</span><span class="o">/</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="n">b</span><span class="p">)),</span> <span class="kc">True</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">LogLogistic</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with a log-logistic distribution.</span>
<span class="sd">    The distribution is unimodal when `beta &gt; 1`.</span>

<span class="sd">    The density of the log-logistic distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{(\frac{\beta}{\alpha})(\frac{x}{\alpha})^{\beta - 1}}</span>
<span class="sd">                {(1 + (\frac{x}{\alpha})^{\beta})^2}</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    alpha : Real number, `\alpha &gt; 0`, scale parameter and median of distribution</span>
<span class="sd">    beta : Real number, `\beta &gt; 0` a shape parameter</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import LogLogistic, density, cdf, quantile</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, pprint</span>

<span class="sd">    &gt;&gt;&gt; alpha = Symbol(&quot;alpha&quot;, real=True, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; beta = Symbol(&quot;beta&quot;, real=True, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; p = Symbol(&quot;p&quot;)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;, positive=True)</span>

<span class="sd">    &gt;&gt;&gt; X = LogLogistic(&quot;x&quot;, alpha, beta)</span>

<span class="sd">    &gt;&gt;&gt; D = density(X)(z)</span>
<span class="sd">    &gt;&gt;&gt; pprint(D, use_unicode=False)</span>
<span class="sd">                  beta - 1</span>
<span class="sd">           /  z  \</span>
<span class="sd">      beta*|-----|</span>
<span class="sd">           \alpha/</span>
<span class="sd">    ------------------------</span>
<span class="sd">                           2</span>
<span class="sd">          /       beta    \</span>
<span class="sd">          |/  z  \        |</span>
<span class="sd">    alpha*||-----|     + 1|</span>
<span class="sd">          \\alpha/        /</span>

<span class="sd">    &gt;&gt;&gt; cdf(X)(z)</span>
<span class="sd">    1/(1 + (z/alpha)**(-beta))</span>

<span class="sd">    &gt;&gt;&gt; quantile(X)(p)</span>
<span class="sd">    alpha*(p/(1 - p))**(1/beta)</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Log-logistic_distribution</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">LogLogisticDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Log Normal distribution ------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">LogNormalDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">)</span>

    <span class="nb">set</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">std</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Parameter std must be positive.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">mean</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">std</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">std</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">mean</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">(</span>
                <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span> <span class="o">+</span> <span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="o">*</span><span class="n">erf</span><span class="p">((</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">std</span><span class="p">),</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_moment_generating_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Moment generating function of the log-normal distribution is not defined.&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">LogNormal</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with a log-normal distribution.</span>

<span class="sd">    The density of the log-normal distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{1}{x\sqrt{2\pi\sigma^2}}</span>
<span class="sd">                e^{-\frac{\left(\ln x-\mu\right)^2}{2\sigma^2}}</span>

<span class="sd">    with :math:`x \geq 0`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    mu : Real number, the log-scale</span>
<span class="sd">    sigma : Real number, :math:`\sigma^2 &gt; 0` a shape</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import LogNormal, density</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, pprint</span>

<span class="sd">    &gt;&gt;&gt; mu = Symbol(&quot;mu&quot;, real=True)</span>
<span class="sd">    &gt;&gt;&gt; sigma = Symbol(&quot;sigma&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = LogNormal(&quot;x&quot;, mu, sigma)</span>

<span class="sd">    &gt;&gt;&gt; D = density(X)(z)</span>
<span class="sd">    &gt;&gt;&gt; pprint(D, use_unicode=False)</span>
<span class="sd">                          2</span>
<span class="sd">           -(-mu + log(z))</span>
<span class="sd">           -----------------</span>
<span class="sd">                      2</span>
<span class="sd">      ___      2*sigma</span>
<span class="sd">    \/ 2 *e</span>
<span class="sd">    ------------------------</span>
<span class="sd">            ____</span>
<span class="sd">        2*\/ pi *sigma*z</span>


<span class="sd">    &gt;&gt;&gt; X = LogNormal(&#39;x&#39;, 0, 1) # Mean 0, standard deviation 1</span>

<span class="sd">    &gt;&gt;&gt; density(X)(z)</span>
<span class="sd">    sqrt(2)*exp(-log(z)**2/2)/(2*sqrt(pi)*z)</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Lognormal</span>
<span class="sd">    .. [2] http://mathworld.wolfram.com/LogNormalDistribution.html</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">LogNormalDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Lomax Distribution -----------------------------------------------------------</span>

<span class="k">class</span> <span class="nc">LomaxDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;lamda&#39;</span><span class="p">,)</span>
    <span class="nb">set</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">lamda</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">alpha</span><span class="o">.</span><span class="n">is_real</span><span class="p">,</span> <span class="s2">&quot;Shape parameter should be real.&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">lamda</span><span class="o">.</span><span class="n">is_real</span><span class="p">,</span> <span class="s2">&quot;Scale parameter should be real.&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">alpha</span><span class="o">.</span><span class="n">is_positive</span><span class="p">,</span> <span class="s2">&quot;Shape parameter should be positive.&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">lamda</span><span class="o">.</span><span class="n">is_positive</span><span class="p">,</span> <span class="s2">&quot;Scale parameter should be positive.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">lamba</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lamda</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="n">lamba</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">+</span> <span class="n">x</span><span class="o">/</span><span class="n">lamba</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">Lomax</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">lamda</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with a Lomax distribution.</span>

<span class="sd">    The density of the Lomax distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{\alpha}{\lambda}\left[1+\frac{x}{\lambda}\right]^{-(\alpha+1)}</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    alpha : Real Number, `alpha &gt; 0`</span>
<span class="sd">        Shape parameter</span>
<span class="sd">    lamda : Real Number, `lamda &gt; 0`</span>
<span class="sd">        Scale parameter</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import Lomax, density, cdf, E</span>
<span class="sd">    &gt;&gt;&gt; from sympy import symbols</span>
<span class="sd">    &gt;&gt;&gt; a, l = symbols(&#39;a, l&#39;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; X = Lomax(&#39;X&#39;, a, l)</span>
<span class="sd">    &gt;&gt;&gt; x = symbols(&#39;x&#39;)</span>
<span class="sd">    &gt;&gt;&gt; density(X)(x)</span>
<span class="sd">    a*(1 + x/l)**(-a - 1)/l</span>
<span class="sd">    &gt;&gt;&gt; cdf(X)(x)</span>
<span class="sd">    Piecewise((1 - (1 + x/l)**(-a), x &gt;= 0), (0, True))</span>
<span class="sd">    &gt;&gt;&gt; a = 2</span>
<span class="sd">    &gt;&gt;&gt; X = Lomax(&#39;X&#39;, a, l)</span>
<span class="sd">    &gt;&gt;&gt; E(X)</span>
<span class="sd">    l</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Lomax_distribution</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">LomaxDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">lamda</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Maxwell distribution ---------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">MaxwellDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,)</span>

    <span class="nb">set</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Parameter a must be positive.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="n">a</span><span class="o">**</span><span class="mi">3</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="k">return</span> <span class="n">erf</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">))</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">Maxwell</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with a Maxwell distribution.</span>

<span class="sd">    The density of the Maxwell distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \sqrt{\frac{2}{\pi}} \frac{x^2 e^{-x^2/(2a^2)}}{a^3}</span>

<span class="sd">    with :math:`x \geq 0`.</span>

<span class="sd">    .. TODO - what does the parameter mean?</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    a : Real number, `a &gt; 0`</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import Maxwell, density, E, variance</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, simplify</span>

<span class="sd">    &gt;&gt;&gt; a = Symbol(&quot;a&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = Maxwell(&quot;x&quot;, a)</span>

<span class="sd">    &gt;&gt;&gt; density(X)(z)</span>
<span class="sd">    sqrt(2)*z**2*exp(-z**2/(2*a**2))/(sqrt(pi)*a**3)</span>

<span class="sd">    &gt;&gt;&gt; E(X)</span>
<span class="sd">    2*sqrt(2)*a/sqrt(pi)</span>

<span class="sd">    &gt;&gt;&gt; simplify(variance(X))</span>
<span class="sd">    a**2*(-8 + 3*pi)/pi</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Maxwell_distribution</span>
<span class="sd">    .. [2] http://mathworld.wolfram.com/MaxwellDistribution.html</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">MaxwellDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Moyal Distribution -----------------------------------------------------------</span>
<span class="k">class</span> <span class="nc">MoyalDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;mu&#39;</span><span class="p">,</span> <span class="s1">&#39;sigma&#39;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">mu</span><span class="o">.</span><span class="n">is_real</span><span class="p">,</span> <span class="s2">&quot;Location parameter must be real.&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">sigma</span><span class="o">.</span><span class="n">is_real</span> <span class="ow">and</span> <span class="n">sigma</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Scale parameter must be real</span><span class="se">\</span>
<span class="s2">        and positive.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span>
        <span class="n">num</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">sigma</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">sigma</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">den</span> <span class="o">=</span> <span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">sigma</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">num</span><span class="o">/</span><span class="n">den</span>

    <span class="k">def</span> <span class="nf">_characteristic_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span>
        <span class="n">term1</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">mu</span><span class="p">)</span>
        <span class="n">term2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">I</span><span class="o">*</span><span class="n">sigma</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">gamma</span><span class="p">(</span><span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">I</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">sigma</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">term1</span> <span class="o">*</span> <span class="n">term2</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_moment_generating_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span>
        <span class="n">term1</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">mu</span><span class="p">)</span>
        <span class="n">term2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">sigma</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">gamma</span><span class="p">(</span><span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">t</span><span class="o">*</span><span class="n">sigma</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">term1</span> <span class="o">*</span> <span class="n">term2</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">Moyal</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with a Moyal distribution.</span>
<span class="sd">    The density of the Moyal distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{\exp-\frac{1}{2}\exp-\frac{x-\mu}{\sigma}-\frac{x-\mu}{2\sigma}}{\sqrt{2\pi}\sigma}</span>

<span class="sd">    with :math:`x \in \mathbb{R}`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    mu : Real number</span>
<span class="sd">        Location parameter</span>
<span class="sd">    sigma : Real positive number</span>
<span class="sd">        Scale parameter</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import Moyal, density, cdf</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, simplify</span>
<span class="sd">    &gt;&gt;&gt; mu = Symbol(&quot;mu&quot;, real=True)</span>
<span class="sd">    &gt;&gt;&gt; sigma = Symbol(&quot;sigma&quot;, positive=True, real=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>
<span class="sd">    &gt;&gt;&gt; X = Moyal(&quot;x&quot;, mu, sigma)</span>
<span class="sd">    &gt;&gt;&gt; density(X)(z)</span>
<span class="sd">    sqrt(2)*exp(-exp((mu - z)/sigma)/2 - (-mu + z)/(2*sigma))/(2*sqrt(pi)*sigma)</span>
<span class="sd">    &gt;&gt;&gt; simplify(cdf(X)(z))</span>
<span class="sd">    1 - erf(sqrt(2)*exp((mu - z)/(2*sigma))/2)</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://reference.wolfram.com/language/ref/MoyalDistribution.html</span>
<span class="sd">    .. [2] http://www.stat.rice.edu/~dobelman/textfiles/DistributionsHandbook.pdf</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">MoyalDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Nakagami distribution --------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">NakagamiDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;mu&#39;</span><span class="p">,</span> <span class="s1">&#39;omega&#39;</span><span class="p">)</span>

    <span class="nb">set</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">omega</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">mu</span> <span class="o">&gt;=</span> <span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">,</span> <span class="s2">&quot;Shape parameter mu must be greater than equal to 1/2.&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">omega</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Spread parameter omega must be positive.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">omega</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega</span>
        <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">mu</span><span class="o">**</span><span class="n">mu</span><span class="o">/</span><span class="p">(</span><span class="n">gamma</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="n">mu</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mu</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">mu</span><span class="o">/</span><span class="n">omega</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">omega</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">lowergamma</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="p">(</span><span class="n">mu</span><span class="o">/</span><span class="n">omega</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">gamma</span><span class="p">(</span><span class="n">mu</span><span class="p">),</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">),</span>
                    <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">Nakagami</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">omega</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with a Nakagami distribution.</span>

<span class="sd">    The density of the Nakagami distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{2\mu^\mu}{\Gamma(\mu)\omega^\mu} x^{2\mu-1}</span>
<span class="sd">                \exp\left(-\frac{\mu}{\omega}x^2 \right)</span>

<span class="sd">    with :math:`x &gt; 0`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    mu : Real number, `\mu \geq \frac{1}{2}` a shape</span>
<span class="sd">    omega : Real number, `\omega &gt; 0`, the spread</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import Nakagami, density, E, variance, cdf</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, simplify, pprint</span>

<span class="sd">    &gt;&gt;&gt; mu = Symbol(&quot;mu&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; omega = Symbol(&quot;omega&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = Nakagami(&quot;x&quot;, mu, omega)</span>

<span class="sd">    &gt;&gt;&gt; D = density(X)(z)</span>
<span class="sd">    &gt;&gt;&gt; pprint(D, use_unicode=False)</span>
<span class="sd">                                    2</span>
<span class="sd">                               -mu*z</span>
<span class="sd">                               -------</span>
<span class="sd">        mu      -mu  2*mu - 1  omega</span>
<span class="sd">    2*mu  *omega   *z        *e</span>
<span class="sd">    ----------------------------------</span>
<span class="sd">                Gamma(mu)</span>

<span class="sd">    &gt;&gt;&gt; simplify(E(X))</span>
<span class="sd">    sqrt(mu)*sqrt(omega)*gamma(mu + 1/2)/gamma(mu + 1)</span>

<span class="sd">    &gt;&gt;&gt; V = simplify(variance(X))</span>
<span class="sd">    &gt;&gt;&gt; pprint(V, use_unicode=False)</span>
<span class="sd">                        2</span>
<span class="sd">             omega*Gamma (mu + 1/2)</span>
<span class="sd">    omega - -----------------------</span>
<span class="sd">            Gamma(mu)*Gamma(mu + 1)</span>

<span class="sd">    &gt;&gt;&gt; cdf(X)(z)</span>
<span class="sd">    Piecewise((lowergamma(mu, mu*z**2/omega)/gamma(mu), z &gt; 0),</span>
<span class="sd">            (0, True))</span>


<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Nakagami_distribution</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">NakagamiDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">omega</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Normal distribution ----------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">NormalDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">std</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Standard deviation must be positive&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">std</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">std</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">mean</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span>
        <span class="k">return</span> <span class="n">erf</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">mean</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">std</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">S</span><span class="o">.</span><span class="n">Half</span>

    <span class="k">def</span> <span class="nf">_characteristic_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">mean</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">mean</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">std</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_moment_generating_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">mean</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="n">mean</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">std</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_quantile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="n">mean</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span>
        <span class="k">return</span> <span class="n">mean</span> <span class="o">+</span> <span class="n">std</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">erfinv</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">Normal</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with a Normal distribution.</span>

<span class="sd">    The density of the Normal distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{1}{\sigma\sqrt{2\pi}} e^{ -\frac{(x-\mu)^2}{2\sigma^2} }</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    mu : Real number or a list representing the mean or the mean vector</span>
<span class="sd">    sigma : Real number or a positive definite square matrix,</span>
<span class="sd">         :math:`\sigma^2 &gt; 0` the variance</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import Normal, density, E, std, cdf, skewness, quantile, marginal_distribution</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, simplify, pprint</span>

<span class="sd">    &gt;&gt;&gt; mu = Symbol(&quot;mu&quot;)</span>
<span class="sd">    &gt;&gt;&gt; sigma = Symbol(&quot;sigma&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>
<span class="sd">    &gt;&gt;&gt; y = Symbol(&quot;y&quot;)</span>
<span class="sd">    &gt;&gt;&gt; p = Symbol(&quot;p&quot;)</span>
<span class="sd">    &gt;&gt;&gt; X = Normal(&quot;x&quot;, mu, sigma)</span>

<span class="sd">    &gt;&gt;&gt; density(X)(z)</span>
<span class="sd">    sqrt(2)*exp(-(-mu + z)**2/(2*sigma**2))/(2*sqrt(pi)*sigma)</span>

<span class="sd">    &gt;&gt;&gt; C = simplify(cdf(X))(z) # it needs a little more help...</span>
<span class="sd">    &gt;&gt;&gt; pprint(C, use_unicode=False)</span>
<span class="sd">       /  ___          \</span>
<span class="sd">       |\/ 2 *(-mu + z)|</span>
<span class="sd">    erf|---------------|</span>
<span class="sd">       \    2*sigma    /   1</span>
<span class="sd">    -------------------- + -</span>
<span class="sd">             2             2</span>

<span class="sd">    &gt;&gt;&gt; quantile(X)(p)</span>
<span class="sd">    mu + sqrt(2)*sigma*erfinv(2*p - 1)</span>

<span class="sd">    &gt;&gt;&gt; simplify(skewness(X))</span>
<span class="sd">    0</span>

<span class="sd">    &gt;&gt;&gt; X = Normal(&quot;x&quot;, 0, 1) # Mean 0, standard deviation 1</span>
<span class="sd">    &gt;&gt;&gt; density(X)(z)</span>
<span class="sd">    sqrt(2)*exp(-z**2/2)/(2*sqrt(pi))</span>

<span class="sd">    &gt;&gt;&gt; E(2*X + 1)</span>
<span class="sd">    1</span>

<span class="sd">    &gt;&gt;&gt; simplify(std(2*X + 1))</span>
<span class="sd">    2</span>

<span class="sd">    &gt;&gt;&gt; m = Normal(&#39;X&#39;, [1, 2], [[2, 1], [1, 2]])</span>
<span class="sd">    &gt;&gt;&gt; pprint(density(m)(y, z), use_unicode=False)</span>
<span class="sd">           /1   y\ /2*y   z\   /    z\ /  y   2*z    \</span>
<span class="sd">           |- - -|*|--- - -| + |1 - -|*|- - + --- - 1|</span>
<span class="sd">      ___  \2   2/ \ 3    3/   \    2/ \  3    3     /</span>
<span class="sd">    \/ 3 *e</span>
<span class="sd">    --------------------------------------------------</span>
<span class="sd">                           6*pi</span>

<span class="sd">    &gt;&gt;&gt; marginal_distribution(m, m[0])(1)</span>
<span class="sd">     1/(2*sqrt(pi))</span>


<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Normal_distribution</span>
<span class="sd">    .. [2] http://mathworld.wolfram.com/NormalDistributionFunction.html</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">MatrixBase</span><span class="p">,</span> <span class="n">MatrixExpr</span><span class="p">))</span> <span class="ow">and</span>\
        <span class="nb">isinstance</span><span class="p">(</span><span class="n">std</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">MatrixBase</span><span class="p">,</span> <span class="n">MatrixExpr</span><span class="p">)):</span>
        <span class="kn">from</span> <span class="nn">sympy.stats.joint_rv_types</span> <span class="kn">import</span> <span class="n">MultivariateNormal</span>
        <span class="k">return</span> <span class="n">MultivariateNormal</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">NormalDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">))</span>


<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Inverse Gaussian distribution ----------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">GaussianInverseDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;shape&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">shape</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">shape</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Shape parameter must be positive&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">mean</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Mean must be positive&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">s</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">mu</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">s</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sympy.stats</span> <span class="kn">import</span> <span class="n">cdf</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">stdNormalcdf</span> <span class="o">=</span> <span class="n">cdf</span><span class="p">(</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

        <span class="n">first_term</span> <span class="o">=</span> <span class="n">stdNormalcdf</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">s</span><span class="o">/</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">x</span><span class="o">/</span><span class="n">mu</span><span class="p">)</span> <span class="o">-</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">))</span>
        <span class="n">second_term</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">s</span><span class="o">/</span><span class="n">mu</span><span class="p">)</span> <span class="o">*</span> <span class="n">stdNormalcdf</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">s</span><span class="o">/</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">mu</span> <span class="o">+</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">))</span>

        <span class="k">return</span>  <span class="n">first_term</span> <span class="o">+</span> <span class="n">second_term</span>

    <span class="k">def</span> <span class="nf">_characteristic_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">((</span><span class="n">s</span><span class="o">/</span><span class="n">mu</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mu</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="n">s</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_moment_generating_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">((</span><span class="n">s</span><span class="o">/</span><span class="n">mu</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mu</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="n">s</span><span class="p">)))</span>


<span class="k">def</span> <span class="nf">GaussianInverse</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">shape</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with an Inverse Gaussian distribution.</span>
<span class="sd">    Inverse Gaussian distribution is also known as Wald distribution.</span>

<span class="sd">    The density of the Inverse Gaussian distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \sqrt{\frac{\lambda}{2\pi x^3}} e^{-\frac{\lambda(x-\mu)^2}{2x\mu^2}}</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    mu : Positive number representing the mean</span>
<span class="sd">    lambda : Positive number representing the shape parameter</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import GaussianInverse, density, E, std, skewness</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, pprint</span>

<span class="sd">    &gt;&gt;&gt; mu = Symbol(&quot;mu&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; lamda = Symbol(&quot;lambda&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; X = GaussianInverse(&quot;x&quot;, mu, lamda)</span>

<span class="sd">    &gt;&gt;&gt; D = density(X)(z)</span>
<span class="sd">    &gt;&gt;&gt; pprint(D, use_unicode=False)</span>
<span class="sd">                                       2</span>
<span class="sd">                      -lambda*(-mu + z)</span>
<span class="sd">                      -------------------</span>
<span class="sd">                                2</span>
<span class="sd">      ___   ________        2*mu *z</span>
<span class="sd">    \/ 2 *\/ lambda *e</span>
<span class="sd">    -------------------------------------</span>
<span class="sd">                    ____  3/2</span>
<span class="sd">                2*\/ pi *z</span>

<span class="sd">    &gt;&gt;&gt; E(X)</span>
<span class="sd">    mu</span>

<span class="sd">    &gt;&gt;&gt; std(X).expand()</span>
<span class="sd">    mu**(3/2)/sqrt(lambda)</span>

<span class="sd">    &gt;&gt;&gt; skewness(X).expand()</span>
<span class="sd">    3*sqrt(mu)/sqrt(lambda)</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Inverse_Gaussian_distribution</span>
<span class="sd">    .. [2] http://mathworld.wolfram.com/InverseGaussianDistribution.html</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">GaussianInverseDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">shape</span><span class="p">))</span>

<span class="n">Wald</span> <span class="o">=</span> <span class="n">GaussianInverse</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Pareto distribution ----------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">ParetoDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;xm&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Interval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xm</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">xm</span><span class="p">,</span> <span class="n">alpha</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">xm</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Xm must be positive&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Alpha must be positive&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">xm</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span>
        <span class="k">return</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">xm</span><span class="o">**</span><span class="n">alpha</span> <span class="o">/</span> <span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="n">alpha</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">xm</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">(</span>
                <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">-</span> <span class="n">xm</span><span class="o">**</span><span class="n">alpha</span><span class="o">/</span><span class="n">x</span><span class="o">**</span><span class="n">alpha</span><span class="p">,</span> <span class="n">x</span><span class="o">&gt;=</span><span class="n">xm</span><span class="p">),</span>
                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_moment_generating_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">xm</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span>
        <span class="k">return</span> <span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">xm</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">uppergamma</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="p">,</span> <span class="o">-</span><span class="n">xm</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_characteristic_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">xm</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span>
        <span class="k">return</span> <span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">I</span> <span class="o">*</span> <span class="n">xm</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">**</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">uppergamma</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="p">,</span> <span class="o">-</span><span class="n">I</span> <span class="o">*</span> <span class="n">xm</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">Pareto</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">xm</span><span class="p">,</span> <span class="n">alpha</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with the Pareto distribution.</span>

<span class="sd">    The density of the Pareto distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{\alpha\,x_m^\alpha}{x^{\alpha+1}}</span>

<span class="sd">    with :math:`x \in [x_m,\infty]`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    xm : Real number, `x_m &gt; 0`, a scale</span>
<span class="sd">    alpha : Real number, `\alpha &gt; 0`, a shape</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import Pareto, density</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol</span>

<span class="sd">    &gt;&gt;&gt; xm = Symbol(&quot;xm&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; beta = Symbol(&quot;beta&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = Pareto(&quot;x&quot;, xm, beta)</span>

<span class="sd">    &gt;&gt;&gt; density(X)(z)</span>
<span class="sd">    beta*xm**beta*z**(-beta - 1)</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Pareto_distribution</span>
<span class="sd">    .. [2] http://mathworld.wolfram.com/ParetoDistribution.html</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">ParetoDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">xm</span><span class="p">,</span> <span class="n">alpha</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># PowerFunction distribution ---------------------------------------------------</span>


<span class="k">class</span> <span class="nc">PowerFunctionDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Interval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">is_real</span><span class="p">,</span> <span class="s2">&quot;Continuous Boundary parameter should be real.&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">is_real</span><span class="p">,</span> <span class="s2">&quot;Continuous Boundary parameter should be real.&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">,</span> <span class="s2">&quot; &#39;a&#39; the left Boundary must be smaller than &#39;b&#39; the right Boundary.&quot;</span> <span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">alpha</span><span class="o">.</span><span class="n">is_positive</span><span class="p">,</span> <span class="s2">&quot;Continuous Shape parameter should be positive.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">alpha</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="n">num</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">alpha</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">den</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="n">alpha</span>
        <span class="k">return</span> <span class="n">num</span><span class="o">/</span><span class="n">den</span>

<span class="k">def</span> <span class="nf">PowerFunction</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a continuous random variable with a Power Function Distribution</span>

<span class="sd">    The density of PowerFunction distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{{\alpha}(x - a)^{\alpha - 1}}{(b - a)^{\alpha}}</span>

<span class="sd">    with :math:`x \in [a,b]`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    alpha: Positive number, `0 &lt; alpha` the shape paramater</span>
<span class="sd">    a : Real number, :math:`-\infty &lt; a` the left boundary</span>
<span class="sd">    b : Real number, :math:`a &lt; b &lt; \infty` the right boundary</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import PowerFunction, density, cdf, E, variance</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol</span>
<span class="sd">    &gt;&gt;&gt; alpha = Symbol(&quot;alpha&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; a = Symbol(&quot;a&quot;, real=True)</span>
<span class="sd">    &gt;&gt;&gt; b = Symbol(&quot;b&quot;, real=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = PowerFunction(&quot;X&quot;, 2, a, b)</span>

<span class="sd">    &gt;&gt;&gt; density(X)(z)</span>
<span class="sd">    (-2*a + 2*z)/(-a + b)**2</span>

<span class="sd">    &gt;&gt;&gt; cdf(X)(z)</span>
<span class="sd">    Piecewise((a**2/(a**2 - 2*a*b + b**2) - 2*a*z/(a**2 - 2*a*b + b**2) +</span>
<span class="sd">    z**2/(a**2 - 2*a*b + b**2), a &lt;= z), (0, True))</span>

<span class="sd">    &gt;&gt;&gt; alpha = 2</span>
<span class="sd">    &gt;&gt;&gt; a = 0</span>
<span class="sd">    &gt;&gt;&gt; b = 1</span>
<span class="sd">    &gt;&gt;&gt; Y = PowerFunction(&quot;Y&quot;, alpha, a, b)</span>

<span class="sd">    &gt;&gt;&gt; E(Y)</span>
<span class="sd">    2/3</span>

<span class="sd">    &gt;&gt;&gt; variance(Y)</span>
<span class="sd">    1/18</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] http://www.mathwave.com/help/easyfit/html/analyses/distributions/power_func.html</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">PowerFunctionDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># QuadraticU distribution ------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">QuadraticUDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Interval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">b</span> <span class="o">&gt;</span> <span class="n">a</span><span class="p">,</span> <span class="s2">&quot;Parameter b must be in range (</span><span class="si">%s</span><span class="s2">, oo).&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mi">12</span> <span class="o">/</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">(</span>
                  <span class="p">(</span><span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">beta</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">And</span><span class="p">(</span><span class="n">a</span><span class="o">&lt;=</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">&lt;=</span><span class="n">b</span><span class="p">)),</span>
                  <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_moment_generating_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">4</span>  <span class="o">+</span> <span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> \
        <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">4</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">))</span> <span class="o">/</span> <span class="p">((</span><span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_characteristic_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">t</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">I</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="p">))</span> \
                <span class="o">/</span> <span class="p">((</span><span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">QuadraticU</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a Continuous Random Variable with a U-quadratic distribution.</span>

<span class="sd">    The density of the U-quadratic distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \alpha (x-\beta)^2</span>

<span class="sd">    with :math:`x \in [a,b]`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    a : Real number</span>
<span class="sd">    b : Real number, :math:`a &lt; b`</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import QuadraticU, density</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, pprint</span>

<span class="sd">    &gt;&gt;&gt; a = Symbol(&quot;a&quot;, real=True)</span>
<span class="sd">    &gt;&gt;&gt; b = Symbol(&quot;b&quot;, real=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = QuadraticU(&quot;x&quot;, a, b)</span>

<span class="sd">    &gt;&gt;&gt; D = density(X)(z)</span>
<span class="sd">    &gt;&gt;&gt; pprint(D, use_unicode=False)</span>
<span class="sd">    /                2</span>
<span class="sd">    |   /  a   b    \</span>
<span class="sd">    |12*|- - - - + z|</span>
<span class="sd">    |   \  2   2    /</span>
<span class="sd">    &lt;-----------------  for And(b &gt;= z, a &lt;= z)</span>
<span class="sd">    |            3</span>
<span class="sd">    |    (-a + b)</span>
<span class="sd">    |</span>
<span class="sd">    \        0                 otherwise</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/U-quadratic_distribution</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">QuadraticUDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># RaisedCosine distribution ----------------------------------------------------</span>


<span class="k">class</span> <span class="nc">RaisedCosineDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;mu&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Interval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">s</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;s must be positive&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">(</span>
                <span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">cos</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">s</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">s</span><span class="p">),</span> <span class="n">And</span><span class="p">(</span><span class="n">mu</span><span class="o">-</span><span class="n">s</span><span class="o">&lt;=</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">&lt;=</span><span class="n">mu</span><span class="o">+</span><span class="n">s</span><span class="p">)),</span>
                <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_characteristic_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">((</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">I</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">mu</span><span class="o">/</span><span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">Eq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="n">s</span><span class="p">)),</span>
                         <span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">mu</span><span class="o">/</span><span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">Eq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="n">s</span><span class="p">)),</span>
                         <span class="p">(</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">mu</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">)),</span> <span class="kc">True</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_moment_generating_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span>
        <span class="k">return</span> <span class="n">pi</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sinh</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="n">mu</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">/</span>  <span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">RaisedCosine</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a Continuous Random Variable with a raised cosine distribution.</span>

<span class="sd">    The density of the raised cosine distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{1}{2s}\left(1+\cos\left(\frac{x-\mu}{s}\pi\right)\right)</span>

<span class="sd">    with :math:`x \in [\mu-s,\mu+s]`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    mu : Real number</span>
<span class="sd">    s : Real number, `s &gt; 0`</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import RaisedCosine, density</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, pprint</span>

<span class="sd">    &gt;&gt;&gt; mu = Symbol(&quot;mu&quot;, real=True)</span>
<span class="sd">    &gt;&gt;&gt; s = Symbol(&quot;s&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = RaisedCosine(&quot;x&quot;, mu, s)</span>

<span class="sd">    &gt;&gt;&gt; D = density(X)(z)</span>
<span class="sd">    &gt;&gt;&gt; pprint(D, use_unicode=False)</span>
<span class="sd">    /   /pi*(-mu + z)\</span>
<span class="sd">    |cos|------------| + 1</span>
<span class="sd">    |   \     s      /</span>
<span class="sd">    &lt;---------------------  for And(z &gt;= mu - s, z &lt;= mu + s)</span>
<span class="sd">    |         2*s</span>
<span class="sd">    |</span>
<span class="sd">    \          0                        otherwise</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Raised_cosine_distribution</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">RaisedCosineDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Rayleigh distribution --------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">RayleighDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;sigma&#39;</span><span class="p">,)</span>

    <span class="nb">set</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">sigma</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">sigma</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Scale parameter sigma must be positive.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">/</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_characteristic_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">sigma</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">erfi</span><span class="p">(</span><span class="n">sigma</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="n">I</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_moment_generating_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">sigma</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">erf</span><span class="p">(</span><span class="n">sigma</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">Rayleigh</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with a Rayleigh distribution.</span>

<span class="sd">    The density of the Rayleigh distribution is given by</span>

<span class="sd">    .. math ::</span>
<span class="sd">        f(x) := \frac{x}{\sigma^2} e^{-x^2/2\sigma^2}</span>

<span class="sd">    with :math:`x &gt; 0`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    sigma : Real number, `\sigma &gt; 0`</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import Rayleigh, density, E, variance</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol</span>

<span class="sd">    &gt;&gt;&gt; sigma = Symbol(&quot;sigma&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = Rayleigh(&quot;x&quot;, sigma)</span>

<span class="sd">    &gt;&gt;&gt; density(X)(z)</span>
<span class="sd">    z*exp(-z**2/(2*sigma**2))/sigma**2</span>

<span class="sd">    &gt;&gt;&gt; E(X)</span>
<span class="sd">    sqrt(2)*sqrt(pi)*sigma/2</span>

<span class="sd">    &gt;&gt;&gt; variance(X)</span>
<span class="sd">    -pi*sigma**2/2 + 2*sigma**2</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Rayleigh_distribution</span>
<span class="sd">    .. [2] http://mathworld.wolfram.com/RayleighDistribution.html</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">RayleighDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Reciprocal distribution --------------------------------------------------------</span>

<span class="k">class</span> <span class="nc">ReciprocalDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Interval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Parameter &gt; 0. a = </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">a</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">((</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">),</span>
        <span class="s2">&quot;Parameter b must be in range (</span><span class="si">%s</span><span class="s2">, +oo]. b = </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">)))</span>


<span class="k">def</span> <span class="nf">Reciprocal</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Creates a continuous random variable with a reciprocal distribution.</span>


<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    a : Real number, :math:`0 &lt; a`</span>
<span class="sd">    b : Real number, :math:`a &lt; b`</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import Reciprocal, density, cdf</span>
<span class="sd">    &gt;&gt;&gt; from sympy import symbols</span>
<span class="sd">    &gt;&gt;&gt; a, b, x = symbols(&#39;a, b, x&#39;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; R = Reciprocal(&#39;R&#39;, a, b)</span>

<span class="sd">    &gt;&gt;&gt; density(R)(x)</span>
<span class="sd">    1/(x*(-log(a) + log(b)))</span>
<span class="sd">    &gt;&gt;&gt; cdf(R)(x)</span>
<span class="sd">    Piecewise((log(a)/(log(a) - log(b)) - log(x)/(log(a) - log(b)), a &lt;= x), (0, True))</span>

<span class="sd">    Reference</span>
<span class="sd">    =========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Reciprocal_distribution</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">ReciprocalDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>


<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Shifted Gompertz distribution ------------------------------------------------</span>


<span class="k">class</span> <span class="nc">ShiftedGompertzDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;eta&#39;</span><span class="p">)</span>

    <span class="nb">set</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">eta</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">b</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;b must be positive&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">eta</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;eta must be positive&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">b</span><span class="p">,</span> <span class="n">eta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eta</span>
        <span class="k">return</span> <span class="n">b</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">eta</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">eta</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="p">)))</span>

<span class="k">def</span> <span class="nf">ShiftedGompertz</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">eta</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with a Shifted Gompertz distribution.</span>

<span class="sd">    The density of the Shifted Gompertz distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := b e^{-b x} e^{-\eta \exp(-b x)} \left[1 + \eta(1 - e^(-bx)) \right]</span>

<span class="sd">    with :math: &#39;x \in [0, \inf)&#39;.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    b: Real number, &#39;b &gt; 0&#39; a scale</span>
<span class="sd">    eta: Real number, &#39;eta &gt; 0&#39; a shape</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>
<span class="sd">    &gt;&gt;&gt; from sympy.stats import ShiftedGompertz, density</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol</span>

<span class="sd">    &gt;&gt;&gt; b = Symbol(&quot;b&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; eta = Symbol(&quot;eta&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; x = Symbol(&quot;x&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = ShiftedGompertz(&quot;x&quot;, b, eta)</span>

<span class="sd">    &gt;&gt;&gt; density(X)(x)</span>
<span class="sd">    b*(eta*(1 - exp(-b*x)) + 1)*exp(-b*x)*exp(-eta*exp(-b*x))</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Shifted_Gompertz_distribution</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">ShiftedGompertzDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">eta</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># StudentT distribution --------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">StudentTDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;nu&#39;</span><span class="p">,)</span>

    <span class="nb">set</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">nu</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">nu</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Degrees of freedom nu must be positive.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">nu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nu</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="n">beta_fn</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">,</span> <span class="n">nu</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">nu</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">nu</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">nu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nu</span>
        <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Half</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">gamma</span><span class="p">((</span><span class="n">nu</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">hyper</span><span class="p">((</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">,</span> <span class="p">(</span><span class="n">nu</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>
                                <span class="p">(</span><span class="n">Rational</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),),</span> <span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">nu</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="n">gamma</span><span class="p">(</span><span class="n">nu</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_moment_generating_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;The moment generating function for the Student-T distribution is undefined.&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">StudentT</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">nu</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with a student&#39;s t distribution.</span>

<span class="sd">    The density of the student&#39;s t distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{\Gamma \left(\frac{\nu+1}{2} \right)}</span>
<span class="sd">                {\sqrt{\nu\pi}\Gamma \left(\frac{\nu}{2} \right)}</span>
<span class="sd">                \left(1+\frac{x^2}{\nu} \right)^{-\frac{\nu+1}{2}}</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    nu : Real number, `\nu &gt; 0`, the degrees of freedom</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import StudentT, density, cdf</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, pprint</span>

<span class="sd">    &gt;&gt;&gt; nu = Symbol(&quot;nu&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = StudentT(&quot;x&quot;, nu)</span>

<span class="sd">    &gt;&gt;&gt; D = density(X)(z)</span>
<span class="sd">    &gt;&gt;&gt; pprint(D, use_unicode=False)</span>
<span class="sd">               nu   1</span>
<span class="sd">             - -- - -</span>
<span class="sd">               2    2</span>
<span class="sd">     /     2\</span>
<span class="sd">     |    z |</span>
<span class="sd">     |1 + --|</span>
<span class="sd">     \    nu/</span>
<span class="sd">    -----------------</span>
<span class="sd">      ____  /     nu\</span>
<span class="sd">    \/ nu *B|1/2, --|</span>
<span class="sd">            \     2 /</span>

<span class="sd">    &gt;&gt;&gt; cdf(X)(z)</span>
<span class="sd">    1/2 + z*gamma(nu/2 + 1/2)*hyper((1/2, nu/2 + 1/2), (3/2,),</span>
<span class="sd">                                -z**2/nu)/(sqrt(pi)*sqrt(nu)*gamma(nu/2))</span>


<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Student_t-distribution</span>
<span class="sd">    .. [2] http://mathworld.wolfram.com/Studentst-Distribution.html</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">StudentTDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Trapezoidal distribution ------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">TrapezoidalDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Interval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">d</span><span class="p">,</span> <span class="s2">&quot;Lower bound parameter a &lt; </span><span class="si">%s</span><span class="s2">. a = </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>
        <span class="n">_value_check</span><span class="p">((</span><span class="n">a</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">,</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="n">c</span><span class="p">),</span>
        <span class="s2">&quot;Level start parameter b must be in range [</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">). b = </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
        <span class="n">_value_check</span><span class="p">((</span><span class="n">b</span> <span class="o">&lt;</span> <span class="n">c</span><span class="p">,</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="n">d</span><span class="p">),</span>
        <span class="s2">&quot;Level end parameter c must be in range (</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">]. c = </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">d</span> <span class="o">&gt;=</span> <span class="n">c</span><span class="p">,</span> <span class="s2">&quot;Upper bound parameter d &gt; </span><span class="si">%s</span><span class="s2">. d = </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">(</span>
            <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">d</span><span class="o">+</span><span class="n">c</span><span class="o">-</span><span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="p">)),</span> <span class="n">And</span><span class="p">(</span><span class="n">a</span> <span class="o">&lt;=</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">)),</span>
            <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">d</span><span class="o">+</span><span class="n">c</span><span class="o">-</span><span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="p">),</span> <span class="n">And</span><span class="p">(</span><span class="n">b</span> <span class="o">&lt;=</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">c</span><span class="p">)),</span>
            <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">d</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">d</span><span class="o">-</span><span class="n">c</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">d</span><span class="o">+</span><span class="n">c</span><span class="o">-</span><span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="p">)),</span> <span class="n">And</span><span class="p">(</span><span class="n">c</span> <span class="o">&lt;=</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">d</span><span class="p">)),</span>
            <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">Trapezoidal</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with a trapezoidal distribution.</span>

<span class="sd">    The density of the trapezoidal distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \begin{cases}</span>
<span class="sd">                  0 &amp; \mathrm{for\ } x &lt; a, \\</span>
<span class="sd">                  \frac{2(x-a)}{(b-a)(d+c-a-b)} &amp; \mathrm{for\ } a \le x &lt; b, \\</span>
<span class="sd">                  \frac{2}{d+c-a-b} &amp; \mathrm{for\ } b \le x &lt; c, \\</span>
<span class="sd">                  \frac{2(d-x)}{(d-c)(d+c-a-b)} &amp; \mathrm{for\ } c \le x &lt; d, \\</span>
<span class="sd">                  0 &amp; \mathrm{for\ } d &lt; x.</span>
<span class="sd">                \end{cases}</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    a : Real number, :math:`a &lt; d`</span>
<span class="sd">    b : Real number, :math:`a &lt;= b &lt; c`</span>
<span class="sd">    c : Real number, :math:`b &lt; c &lt;= d`</span>
<span class="sd">    d : Real number</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import Trapezoidal, density</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, pprint</span>

<span class="sd">    &gt;&gt;&gt; a = Symbol(&quot;a&quot;)</span>
<span class="sd">    &gt;&gt;&gt; b = Symbol(&quot;b&quot;)</span>
<span class="sd">    &gt;&gt;&gt; c = Symbol(&quot;c&quot;)</span>
<span class="sd">    &gt;&gt;&gt; d = Symbol(&quot;d&quot;)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = Trapezoidal(&quot;x&quot;, a,b,c,d)</span>

<span class="sd">    &gt;&gt;&gt; pprint(density(X)(z), use_unicode=False)</span>
<span class="sd">    /        -2*a + 2*z</span>
<span class="sd">    |-------------------------  for And(a &lt;= z, b &gt; z)</span>
<span class="sd">    |(-a + b)*(-a - b + c + d)</span>
<span class="sd">    |</span>
<span class="sd">    |           2</span>
<span class="sd">    |     --------------        for And(b &lt;= z, c &gt; z)</span>
<span class="sd">    &lt;     -a - b + c + d</span>
<span class="sd">    |</span>
<span class="sd">    |        2*d - 2*z</span>
<span class="sd">    |-------------------------  for And(d &gt;= z, c &lt;= z)</span>
<span class="sd">    |(-c + d)*(-a - b + c + d)</span>
<span class="sd">    |</span>
<span class="sd">    \            0                     otherwise</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Trapezoidal_distribution</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">TrapezoidalDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Triangular distribution ------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">TriangularDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Interval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">b</span> <span class="o">&gt;</span> <span class="n">a</span><span class="p">,</span> <span class="s2">&quot;Parameter b &gt; </span><span class="si">%s</span><span class="s2">. b = </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
        <span class="n">_value_check</span><span class="p">((</span><span class="n">a</span> <span class="o">&lt;=</span> <span class="n">c</span><span class="p">,</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">),</span>
        <span class="s2">&quot;Parameter c must be in range [</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">]. c = </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">(</span>
            <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c</span> <span class="o">-</span> <span class="n">a</span><span class="p">)),</span> <span class="n">And</span><span class="p">(</span><span class="n">a</span> <span class="o">&lt;=</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">c</span><span class="p">)),</span>
            <span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">),</span> <span class="n">Eq</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">)),</span>
            <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">c</span><span class="p">)),</span> <span class="n">And</span><span class="p">(</span><span class="n">c</span> <span class="o">&lt;</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">)),</span>
            <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_characteristic_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span><span class="p">((</span><span class="n">b</span><span class="o">-</span><span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">c</span><span class="o">-</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">t</span><span class="p">))</span> <span class="o">/</span> <span class="p">((</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">c</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_moment_generating_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span>
        <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">b</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">c</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">t</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">Triangular</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with a triangular distribution.</span>

<span class="sd">    The density of the triangular distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \begin{cases}</span>
<span class="sd">                  0 &amp; \mathrm{for\ } x &lt; a, \\</span>
<span class="sd">                  \frac{2(x-a)}{(b-a)(c-a)} &amp; \mathrm{for\ } a \le x &lt; c, \\</span>
<span class="sd">                  \frac{2}{b-a} &amp; \mathrm{for\ } x = c, \\</span>
<span class="sd">                  \frac{2(b-x)}{(b-a)(b-c)} &amp; \mathrm{for\ } c &lt; x \le b, \\</span>
<span class="sd">                  0 &amp; \mathrm{for\ } b &lt; x.</span>
<span class="sd">                \end{cases}</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    a : Real number, :math:`a \in \left(-\infty, \infty\right)`</span>
<span class="sd">    b : Real number, :math:`a &lt; b`</span>
<span class="sd">    c : Real number, :math:`a \leq c \leq b`</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import Triangular, density</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, pprint</span>

<span class="sd">    &gt;&gt;&gt; a = Symbol(&quot;a&quot;)</span>
<span class="sd">    &gt;&gt;&gt; b = Symbol(&quot;b&quot;)</span>
<span class="sd">    &gt;&gt;&gt; c = Symbol(&quot;c&quot;)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = Triangular(&quot;x&quot;, a,b,c)</span>

<span class="sd">    &gt;&gt;&gt; pprint(density(X)(z), use_unicode=False)</span>
<span class="sd">    /    -2*a + 2*z</span>
<span class="sd">    |-----------------  for And(a &lt;= z, c &gt; z)</span>
<span class="sd">    |(-a + b)*(-a + c)</span>
<span class="sd">    |</span>
<span class="sd">    |       2</span>
<span class="sd">    |     ------              for c = z</span>
<span class="sd">    &lt;     -a + b</span>
<span class="sd">    |</span>
<span class="sd">    |   2*b - 2*z</span>
<span class="sd">    |----------------   for And(b &gt;= z, c &lt; z)</span>
<span class="sd">    |(-a + b)*(b - c)</span>
<span class="sd">    |</span>
<span class="sd">    \        0                otherwise</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Triangular_distribution</span>
<span class="sd">    .. [2] http://mathworld.wolfram.com/TriangularDistribution.html</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">TriangularDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Uniform distribution ---------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">UniformDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Interval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">left</span> <span class="o">&lt;</span> <span class="n">right</span><span class="p">,</span> <span class="s2">&quot;Lower limit should be less than Upper limit.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">right</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">(</span>
            <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="o">/</span><span class="p">(</span><span class="n">right</span> <span class="o">-</span> <span class="n">left</span><span class="p">),</span> <span class="n">And</span><span class="p">(</span><span class="n">left</span> <span class="o">&lt;=</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">right</span><span class="p">)),</span>
            <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">right</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">(</span>
            <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">left</span><span class="p">),</span>
            <span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">left</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">right</span> <span class="o">-</span> <span class="n">left</span><span class="p">),</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">right</span><span class="p">),</span>
            <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_characteristic_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">right</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">(((</span><span class="n">exp</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">right</span><span class="p">)</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">left</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="n">right</span> <span class="o">-</span> <span class="n">left</span><span class="p">)),</span> <span class="n">Ne</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                         <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_moment_generating_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">right</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">(((</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">right</span><span class="p">)</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">left</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="p">(</span><span class="n">right</span> <span class="o">-</span> <span class="n">left</span><span class="p">)),</span> <span class="n">Ne</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                         <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">expectation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Max</span><span class="p">,</span> <span class="n">Min</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;evaluate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">SingleContinuousDistribution</span><span class="o">.</span><span class="n">expectation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">Max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="p">,</span>
                              <span class="n">Min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">result</span>


<span class="k">def</span> <span class="nf">Uniform</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with a uniform distribution.</span>

<span class="sd">    The density of the uniform distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \begin{cases}</span>
<span class="sd">                  \frac{1}{b - a} &amp; \text{for } x \in [a,b]  \\</span>
<span class="sd">                  0               &amp; \text{otherwise}</span>
<span class="sd">                \end{cases}</span>

<span class="sd">    with :math:`x \in [a,b]`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    a : Real number, :math:`-\infty &lt; a` the left boundary</span>
<span class="sd">    b : Real number, :math:`a &lt; b &lt; \infty` the right boundary</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import Uniform, density, cdf, E, variance</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, simplify</span>

<span class="sd">    &gt;&gt;&gt; a = Symbol(&quot;a&quot;, negative=True)</span>
<span class="sd">    &gt;&gt;&gt; b = Symbol(&quot;b&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = Uniform(&quot;x&quot;, a, b)</span>

<span class="sd">    &gt;&gt;&gt; density(X)(z)</span>
<span class="sd">    Piecewise((1/(-a + b), (b &gt;= z) &amp; (a &lt;= z)), (0, True))</span>

<span class="sd">    &gt;&gt;&gt; cdf(X)(z)</span>
<span class="sd">    Piecewise((0, a &gt; z), ((-a + z)/(-a + b), b &gt;= z), (1, True))</span>

<span class="sd">    &gt;&gt;&gt; E(X)</span>
<span class="sd">    a/2 + b/2</span>

<span class="sd">    &gt;&gt;&gt; simplify(variance(X))</span>
<span class="sd">    a**2/12 - a*b/6 + b**2/12</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Uniform_distribution_%28continuous%29</span>
<span class="sd">    .. [2] http://mathworld.wolfram.com/UniformDistribution.html</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">UniformDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># UniformSum distribution ------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">UniformSumDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">((</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">is_integer</span><span class="p">),</span>
        <span class="s2">&quot;Parameter n must be positive integer.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">(</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="n">factorial</span><span class="p">(</span>
            <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Sum</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">k</span><span class="o">*</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">floor</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">(</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">((</span><span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">),</span>
                        <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">Sum</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">k</span><span class="o">*</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">n</span><span class="p">),</span>
                        <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">floor</span><span class="p">(</span><span class="n">x</span><span class="p">))),</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">),</span>
                        <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_characteristic_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">((</span><span class="n">exp</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">t</span><span class="p">))</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span>

    <span class="k">def</span> <span class="nf">_moment_generating_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">((</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span>

<span class="k">def</span> <span class="nf">UniformSum</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with an Irwin-Hall distribution.</span>

<span class="sd">    The probability distribution function depends on a single parameter</span>
<span class="sd">    `n` which is an integer.</span>

<span class="sd">    The density of the Irwin-Hall distribution is given by</span>

<span class="sd">    .. math ::</span>
<span class="sd">        f(x) := \frac{1}{(n-1)!}\sum_{k=0}^{\left\lfloor x\right\rfloor}(-1)^k</span>
<span class="sd">                \binom{n}{k}(x-k)^{n-1}</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    n : A positive Integer, `n &gt; 0`</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import UniformSum, density, cdf</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, pprint</span>

<span class="sd">    &gt;&gt;&gt; n = Symbol(&quot;n&quot;, integer=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = UniformSum(&quot;x&quot;, n)</span>

<span class="sd">    &gt;&gt;&gt; D = density(X)(z)</span>
<span class="sd">    &gt;&gt;&gt; pprint(D, use_unicode=False)</span>
<span class="sd">    floor(z)</span>
<span class="sd">      ___</span>
<span class="sd">      \  `</span>
<span class="sd">       \         k         n - 1 /n\</span>
<span class="sd">        )    (-1) *(-k + z)     *| |</span>
<span class="sd">       /                         \k/</span>
<span class="sd">      /__,</span>
<span class="sd">     k = 0</span>
<span class="sd">    --------------------------------</span>
<span class="sd">                (n - 1)!</span>

<span class="sd">    &gt;&gt;&gt; cdf(X)(z)</span>
<span class="sd">    Piecewise((0, z &lt; 0), (Sum((-1)**_k*(-_k + z)**n*binomial(n, _k),</span>
<span class="sd">                    (_k, 0, floor(z)))/factorial(n), n &gt;= z), (1, True))</span>


<span class="sd">    Compute cdf with specific &#39;x&#39; and &#39;n&#39; values as follows :</span>
<span class="sd">    &gt;&gt;&gt; cdf(UniformSum(&quot;x&quot;, 5), evaluate=False)(2).doit()</span>
<span class="sd">    9/40</span>

<span class="sd">    The argument evaluate=False prevents an attempt at evaluation</span>
<span class="sd">    of the sum for general n, before the argument 2 is passed.</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Uniform_sum_distribution</span>
<span class="sd">    .. [2] http://mathworld.wolfram.com/UniformSumDistribution.html</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">UniformSumDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># VonMises distribution --------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">VonMisesDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;mu&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>

    <span class="nb">set</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">k</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;k must be positive&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">mu</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">besseli</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">VonMises</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a Continuous Random Variable with a von Mises distribution.</span>

<span class="sd">    The density of the von Mises distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac{e^{\kappa\cos(x-\mu)}}{2\pi I_0(\kappa)}</span>

<span class="sd">    with :math:`x \in [0,2\pi]`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    mu : Real number, measure of location</span>
<span class="sd">    k : Real number, measure of concentration</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import VonMises, density</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, pprint</span>

<span class="sd">    &gt;&gt;&gt; mu = Symbol(&quot;mu&quot;)</span>
<span class="sd">    &gt;&gt;&gt; k = Symbol(&quot;k&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = VonMises(&quot;x&quot;, mu, k)</span>

<span class="sd">    &gt;&gt;&gt; D = density(X)(z)</span>
<span class="sd">    &gt;&gt;&gt; pprint(D, use_unicode=False)</span>
<span class="sd">         k*cos(mu - z)</span>
<span class="sd">        e</span>
<span class="sd">    ------------------</span>
<span class="sd">    2*pi*besseli(0, k)</span>


<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Von_Mises_distribution</span>
<span class="sd">    .. [2] http://mathworld.wolfram.com/vonMisesDistribution.html</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">VonMisesDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Weibull distribution ---------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">WeibullDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">)</span>

    <span class="nb">set</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Alpha must be positive&quot;</span><span class="p">)</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">beta</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Beta must be positive&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span>
        <span class="k">return</span> <span class="n">beta</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">alpha</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">beta</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">alpha</span><span class="p">)</span><span class="o">**</span><span class="n">beta</span><span class="p">)</span> <span class="o">/</span> <span class="n">alpha</span>


<span class="k">def</span> <span class="nf">Weibull</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with a Weibull distribution.</span>

<span class="sd">    The density of the Weibull distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \begin{cases}</span>
<span class="sd">                  \frac{k}{\lambda}\left(\frac{x}{\lambda}\right)^{k-1}</span>
<span class="sd">                  e^{-(x/\lambda)^{k}} &amp; x\geq0\\</span>
<span class="sd">                  0 &amp; x&lt;0</span>
<span class="sd">                \end{cases}</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    lambda : Real number, :math:`\lambda &gt; 0` a scale</span>
<span class="sd">    k : Real number, `k &gt; 0` a shape</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    RandomSymbol</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import Weibull, density, E, variance</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol, simplify</span>

<span class="sd">    &gt;&gt;&gt; l = Symbol(&quot;lambda&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; k = Symbol(&quot;k&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = Weibull(&quot;x&quot;, l, k)</span>

<span class="sd">    &gt;&gt;&gt; density(X)(z)</span>
<span class="sd">    k*(z/lambda)**(k - 1)*exp(-(z/lambda)**k)/lambda</span>

<span class="sd">    &gt;&gt;&gt; simplify(E(X))</span>
<span class="sd">    lambda*gamma(1 + 1/k)</span>

<span class="sd">    &gt;&gt;&gt; simplify(variance(X))</span>
<span class="sd">    lambda**2*(-gamma(1 + 1/k)**2 + gamma(1 + 2/k))</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Weibull_distribution</span>
<span class="sd">    .. [2] http://mathworld.wolfram.com/WeibullDistribution.html</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">WeibullDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">))</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Wigner semicircle distribution -----------------------------------------------</span>


<span class="k">class</span> <span class="nc">WignerSemicircleDistribution</span><span class="p">(</span><span class="n">SingleContinuousDistribution</span><span class="p">):</span>
    <span class="n">_argnames</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Interval</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">R</span><span class="p">):</span>
        <span class="n">_value_check</span><span class="p">(</span><span class="n">R</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Radius R must be positive.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span>
        <span class="k">return</span> <span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_characteristic_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">besselj</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="n">t</span><span class="p">),</span> <span class="n">Ne</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                         <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_moment_generating_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Piecewise</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">besseli</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="n">t</span><span class="p">),</span> <span class="n">Ne</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                         <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">WignerSemicircle</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">R</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a continuous random variable with a Wigner semicircle distribution.</span>

<span class="sd">    The density of the Wigner semicircle distribution is given by</span>

<span class="sd">    .. math::</span>
<span class="sd">        f(x) := \frac2{\pi R^2}\,\sqrt{R^2-x^2}</span>

<span class="sd">    with :math:`x \in [-R,R]`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>

<span class="sd">    R : Real number, `R &gt; 0`, the radius</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>

<span class="sd">    A `RandomSymbol`.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.stats import WignerSemicircle, density, E</span>
<span class="sd">    &gt;&gt;&gt; from sympy import Symbol</span>

<span class="sd">    &gt;&gt;&gt; R = Symbol(&quot;R&quot;, positive=True)</span>
<span class="sd">    &gt;&gt;&gt; z = Symbol(&quot;z&quot;)</span>

<span class="sd">    &gt;&gt;&gt; X = WignerSemicircle(&quot;x&quot;, R)</span>

<span class="sd">    &gt;&gt;&gt; density(X)(z)</span>
<span class="sd">    2*sqrt(R**2 - z**2)/(pi*R**2)</span>

<span class="sd">    &gt;&gt;&gt; E(X)</span>
<span class="sd">    0</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] https://en.wikipedia.org/wiki/Wigner_semicircle_distribution</span>
<span class="sd">    .. [2] http://mathworld.wolfram.com/WignersSemicircleLaw.html</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">WignerSemicircleDistribution</span><span class="p">,</span> <span class="p">(</span><span class="n">R</span><span class="p">,))</span>
</pre></div>

              </div>
              
              
              <div class='prev-next-bottom'>
                

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="../../../_static/js/index.3da636dd464baa7582d2.js"></script>


    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2018-2020; the Pharmpy development team.<br/>
        Last updated on Jan 25, 2021.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.2.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>