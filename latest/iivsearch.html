
<!DOCTYPE html>


<html lang="en" data-content_root="./" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>IIVsearch &#8212; Pharmpy 1.9.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=34bb78ad" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css?v=a5c4661c" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=63439bfe" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=c4cb232b"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script src="_static/tabs.js?v=3030b3cb"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'iivsearch';</script>
    <link rel="icon" href="_static/Pharmpy_symbol.svg"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="IOVsearch" href="iovsearch.html" />
    <link rel="prev" title="Drug metabolite" href="drug_metabolite.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="1.9.0" />
    <meta name="docbuild:last-update" content="Sep 03, 2025"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
    
    <img src="_static/Pharmpy_logo.svg" class="logo__image only-light" alt="Pharmpy 1.9.0 documentation - Home"/>
    <img src="_static/Pharmpy_logo_dark.svg" class="logo__image only-dark pst-js-only" alt="Pharmpy 1.9.0 documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="contributors.html">
    About us
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="getting_started.html">
    Getting started
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="user_guide.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="api.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="news.html">
    News
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="contribute.html">
    Contribute
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="citation.html">
    References and citation
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="license.html">
    License
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="developers.html">
    Documentation for developers
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pharmpy/pharmpy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pharmpy/pharmpy/issues" title="Report issues" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa fa-bug fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Report issues</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pharmpy/pharmpy/discussions" title="Discussions" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa fa-comments fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Discussions</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="contributors.html">
    About us
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="getting_started.html">
    Getting started
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="user_guide.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="api.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="news.html">
    News
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="contribute.html">
    Contribute
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="citation.html">
    References and citation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="license.html">
    License
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="developers.html">
    Documentation for developers
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pharmpy/pharmpy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pharmpy/pharmpy/issues" title="Report issues" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa fa-bug fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Report issues</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pharmpy/pharmpy/discussions" title="Discussions" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa fa-comments fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Discussions</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="tools.html">Tools</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="general.html">General</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="common_features.html">Common features</a></li>
<li class="toctree-l3"><a class="reference internal" href="mfl.html">Model Feature Language (MFL)</a></li>
<li class="toctree-l3"><a class="reference internal" href="options.html">Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="strictness.html">Strictness</a></li>
<li class="toctree-l3"><a class="reference internal" href="selection_criteria.html">Selection criteria</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="amd.html">AMD - automatic model development</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="amd_pk.html">PK</a></li>
<li class="toctree-l3"><a class="reference internal" href="amd_pkpd.html">PKPD</a></li>
<li class="toctree-l3"><a class="reference internal" href="amd_tmdd.html">TMDD</a></li>
<li class="toctree-l3"><a class="reference internal" href="amd_drug_metabolite.html">Drug Metabolite</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="modelsearch.html">Modelsearch - search for best structural model for a PK model</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="structsearch.html">Structsearch - search for best structural model for PKPD, drug metabolite and TMDD models</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="pkpd.html">PKPD</a></li>
<li class="toctree-l3"><a class="reference internal" href="tmdd.html">TMDD</a></li>
<li class="toctree-l3"><a class="reference internal" href="drug_metabolite.html">Drug Metabolite</a></li>
</ul>
</details></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">IIVsearch - search for best IIV structure (both variance and covariance)</a></li>
<li class="toctree-l2"><a class="reference internal" href="iovsearch.html">IOVsearch - search for best IOV structure and trim IIV</a></li>
<li class="toctree-l2"><a class="reference internal" href="covsearch.html">COVsearch - identify covariates that explain some of the IIV</a></li>
<li class="toctree-l2"><a class="reference internal" href="ruvsearch.html">RUVsearch - search for best residual error model</a></li>
<li class="toctree-l2"><a class="reference internal" href="allometry.html">allometry - add allometric scaling</a></li>
<li class="toctree-l2"><a class="reference internal" href="estmethod.html">estmethod - compare estimation methods and/or solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="retries.html">Retries - Rerun a model with tweaked initial estimates</a></li>
<li class="toctree-l2"><a class="reference internal" href="simulation.html">Simulation - Run a simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="linearize_tool.html">Linearize - Linearize a model</a></li>
<li class="toctree-l2"><a class="reference internal" href="vpc.html">VPC - Visual predictive check</a></li>
<li class="toctree-l2"><a class="reference internal" href="modelrank.html">ModelRank - rank models</a></li>
<li class="toctree-l2"><a class="reference internal" href="bootstrap.html">Bootstrap</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="modelfit.html">Model estimation and results</a></li>
<li class="toctree-l1"><a class="reference internal" href="modeling.html">Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">The Pharmpy model</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_r.html">Pharmpy in R</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command line interface</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="psn_tools.html">PsN with Pharmpy</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="cdd.html">Case deletion diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="crossval.html">Crossval</a></li>
<li class="toctree-l2"><a class="reference internal" href="frem.html">FREM</a></li>
<li class="toctree-l2"><a class="reference internal" href="linearize.html">Linearize</a></li>
<li class="toctree-l2"><a class="reference internal" href="qa.html">QA</a></li>
<li class="toctree-l2"><a class="reference internal" href="psn_resmod.html">resmod</a></li>
<li class="toctree-l2"><a class="reference internal" href="scm.html">scm</a></li>
<li class="toctree-l2"><a class="reference internal" href="simeval.html">Simeval</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="user_guide.html" class="nav-link">User guide</a></li>
    
    
    <li class="breadcrumb-item"><a href="tools.html" class="nav-link">Tools</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">IIVsearch</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="iivsearch">
<span id="id1"></span><h1>IIVsearch<a class="headerlink" href="#iivsearch" title="Link to this heading">#</a></h1>
<p>The IIVsearch tool is a general tool to decide the best IIV structure given an input model. This includes deciding which IIV
to keep and the covariance structure based on a chosen selection criteria.</p>
<p>The default behavior of the tool (given default arguments) is the following:</p>
<div class="graphviz"><object data="_images/graphviz-da9039248dd98d019106565c1be78ba4ebdb745f.svg" type="image/svg+xml" class="graphviz">
<p class="warning">digraph BST {
        node [fontname=&quot;Arial&quot;,shape=&quot;rect&quot;];
        rankdir=&quot;LR&quot;;
        base [label=&quot;Input model&quot;, shape=&quot;oval&quot;]
        s0 [label=&quot;Base model&quot;, shape=&quot;oval&quot;]
        s1 [label=&quot;Number of IIVs algorithm&quot;]
        s2 [label=&quot;Covariance algorithm&quot;]
        s3 [label=&quot;Final model&quot;, shape=&quot;oval&quot;]

        base -&gt; s0 [label = &quot;Add IIVs&quot;]
        s0 -&gt; s1
        s1 -&gt; s2 [label = &quot;Select best model&quot;]
        s2 -&gt; s3

}</p></object></div>
<section id="running">
<h2>Running<a class="headerlink" href="#running" title="Link to this heading">#</a></h2>
<p>The IIVsearch tool is available both in Pharmpy/pharmr and from the command line.</p>
<p>To initiate IIVsearch in Python/R:</p>
<div class="pharmpy-snippet docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-0-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-0-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-0-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pharmpy.modeling</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_model</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pharmpy.tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_modelfit_results</span><span class="p">,</span> <span class="n">run_iivsearch</span>

<span class="n">start_model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="s1">&#39;path/to/model&#39;</span><span class="p">)</span>
<span class="n">start_model_results</span> <span class="o">=</span> <span class="n">read_modelfit_results</span><span class="p">(</span><span class="s1">&#39;path/to/model&#39;</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">run_iivsearch</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">start_model</span><span class="p">,</span>
                    <span class="n">results</span><span class="o">=</span><span class="n">start_model_results</span><span class="p">,</span>
                    <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;top_down_exhaustive&#39;</span><span class="p">,</span>
                    <span class="n">correlation_algorithm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">iiv_strategy</span><span class="o">=</span><span class="s1">&#39;fullblock&#39;</span><span class="p">,</span>
                    <span class="n">rank_type</span><span class="o">=</span><span class="s1">&#39;bic&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">start_model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_model</span><span class="p">(</span><span class="s">&#39;path/to/model&#39;</span><span class="p">)</span>
<span class="n">start_model_results</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_modelfit_results</span><span class="p">(</span><span class="s">&#39;path/to/model&#39;</span><span class="p">)</span>
<span class="n">res</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">run_iivsearch</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">start_model</span><span class="p">,</span>
<span class="w">                    </span><span class="n">results</span><span class="o">=</span><span class="n">start_model_results</span><span class="p">,</span>
<span class="w">                    </span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;top_down_exhaustive&#39;</span><span class="p">,</span>
<span class="w">                    </span><span class="n">correlation_algorithm</span><span class="o">=</span><span class="kc">NULL</span><span class="p">,</span>
<span class="w">                    </span><span class="n">iiv_strategy</span><span class="o">=</span><span class="s">&#39;fullblock&#39;</span><span class="p">,</span>
<span class="w">                    </span><span class="n">rank_type</span><span class="o">=</span><span class="s">&#39;bic&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
</div>
<p>This will take an input <code class="docutils literal notranslate"><span class="pre">model</span></code> and run the top down exhaustive <code class="docutils literal notranslate"><span class="pre">algorithm</span></code> for the number of etas.
Since <code class="docutils literal notranslate"><span class="pre">correlation_algorithm</span></code> is not provided, the default is to use the same algorithm as the number of
etas (<code class="docutils literal notranslate"><span class="pre">'top_down_exhaustive'</span></code>). IIVs on structural parameters (such as mean absorption time) will be added
to all PK parameters as a full block since the <code class="docutils literal notranslate"><span class="pre">iiv_strategy</span></code> is <code class="docutils literal notranslate"><span class="pre">'fullblock'</span></code>. The candidate models
will be ranked using <code class="docutils literal notranslate"><span class="pre">bic</span></code>.</p>
<p>To run IIVsearch from the command line, the example code is redefined accordingly:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pharmpy</span> <span class="n">run</span> <span class="n">iivsearch</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">model</span> <span class="o">--</span><span class="n">algorithm</span> <span class="s1">&#39;top_down_exhaustive&#39;</span> <span class="o">--</span><span class="n">iiv_strategy</span> <span class="s1">&#39;fullblock&#39;</span> <span class="o">--</span><span class="n">rank_type</span> <span class="s1">&#39;bic&#39;</span>
</pre></div>
</div>
</section>
<section id="arguments">
<h2>Arguments<a class="headerlink" href="#arguments" title="Link to this heading">#</a></h2>
<section id="mandatory">
<h3>Mandatory<a class="headerlink" href="#mandatory" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">model</span></code></p></td>
<td><p>Input model</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">results</span></code></p></td>
<td><p>ModelfitResults of input model</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code></p></td>
<td><p><a class="reference internal" href="#algorithms-iivsearch"><span class="std std-ref">Algorithm</span></a> to use
(e.g. <code class="docutils literal notranslate"><span class="pre">'top_down_exhaustive'</span></code>)</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="optional">
<h3>Optional<a class="headerlink" href="#optional" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iiv_strategy</span></code></p></td>
<td><p>If/how IIV should be added to input model (default is to not add).
See <a class="reference internal" href="#iiv-strategies-iivsearch"><span class="std std-ref">Adding IIV to the input model</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">rank_type</span></code></p></td>
<td><p>Which <a class="reference internal" href="#ranking-iivsearch"><span class="std std-ref">selection criteria</span></a> to rank models
on, e.g. OFV (default is BIC)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">linearize</span></code></p></td>
<td><p>Decide whether or not to <a class="reference internal" href="#linearize-iivsearch"><span class="std std-ref">linearize</span></a>
model before starting the search.
See <a class="reference internal" href="linearize_tool.html#linearize"><span class="std std-ref">linearization tool</span></a> for more. Default value
is False.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cutoff</span></code></p></td>
<td><p><a class="reference internal" href="#ranking-iivsearch"><span class="std std-ref">cutoff</span></a> for the ranking function, exclude
models that are below cutoff (default is none)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">keep</span></code></p></td>
<td><p>List of IIVs to keep, either by parameter name or ETA name.
Default is [“CL”]</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">strictness</span></code></p></td>
<td><p><a class="reference internal" href="strictness.html#strictness"><span class="std std-ref">strictness</span></a> criteria for model selection.
Default is “minimization_successful or
(rounding_errors and sigdigs&gt;= 0.1)”</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">correlation_algorithm</span></code></p></td>
<td><p>Specify if an algorithm different from the argument <code class="docutils literal notranslate"><span class="pre">algorithm</span></code>
should be used when searching for the correlation structure for
the IIVs. If not specified, the same algorithm will be used
when searching for which IIVs to add as well as for the
correlation structure.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this documentation, “base model” will be used to describe the model which all candidates are based on. Note
that if you have set <code class="docutils literal notranslate"><span class="pre">iiv_strategy</span></code> to anything other than <code class="docutils literal notranslate"><span class="pre">'no_add'</span></code>, this model will be different to the
input model`. The term “base model” can thus be either the input model or a copy with added IIVs.</p>
</div>
</section>
</section>
<section id="algorithms">
<span id="algorithms-iivsearch"></span><h2>Algorithms<a class="headerlink" href="#algorithms" title="Link to this heading">#</a></h2>
<p>Different aspects of the IIV structure can be explored in the tool depending on which algorithm is chosen. If only
<code class="docutils literal notranslate"><span class="pre">algorithm</span></code> is specified, the same will be applied to <code class="docutils literal notranslate"><span class="pre">correlation_algorithm</span></code> if possible. If not, please see
description <a class="reference internal" href="#iiv-algorithms-combined"><span class="std std-ref">below</span></a> which would be used. We recommend setting both arguments if specific
algorithms are wanted.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>At least one algorithm argument must be set.</p>
</div>
<section id="number-of-iivs">
<h3>Number of IIVs<a class="headerlink" href="#number-of-iivs" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Algorithm</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'top_down_exhaustive'</span></code></p></td>
<td><p>Removes available IIV in all possible combinations (except for IIVs specified
in <code class="docutils literal notranslate"><span class="pre">keep</span></code>-option)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'bottom_up_stepwise'</span></code></p></td>
<td><p>Iteratively adds all available IIV, one at a time. After each addition, the
best model is selected. The algorithm stops when no better model was found
after adding a new ETA.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'skip'</span></code></p></td>
<td><p>Skip assessing number of IIVs (then <code class="code docutils literal notranslate"><span class="pre">correlation_algorithm</span></code> needs
to be set).</p></td>
</tr>
</tbody>
</table>
</div>
<section id="top-down-exhaustive-search">
<h4>Top down exhaustive search<a class="headerlink" href="#top-down-exhaustive-search" title="Link to this heading">#</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">top_down_exhaustive</span></code> algorithm for choosing number of etas will create candidate models for all combinations of
removed IIVs. If no etas are set in the <code class="docutils literal notranslate"><span class="pre">keep</span></code> option, it will also create a naive pooled model meaning all the etas
are fixed to 0. This can be useful when identifying local minima, since all other candidate models should have a lower
OFV than the naive pooled model (which doesn’t have any inter-individual variability).</p>
<p>Given a model with IIV on clearance (CL), central volume (VC), mean absorption time (MAT), and mean delay time (MDT),
the algorithm would try the following models (and rank all):</p>
<div class="graphviz"><object data="_images/graphviz-fa7f7a9512139589319fbc99f806ecce85dcfb16.svg" type="image/svg+xml" class="graphviz">
<p class="warning">digraph BST {
        node [fontname=&quot;Arial&quot;];
        base [label=&quot;[CL,VC,MAT,MDT]&quot;]
        s1 [label=&quot;[CL]&quot;]
        s2 [label=&quot;[CL,VC]&quot;]
        s3 [label=&quot;[CL,MAT]&quot;]
        s4 [label=&quot;[CL,MDT]&quot;]
        s5 [label=&quot;[CL,VC,MAT]&quot;]
        s6 [label=&quot;[CL,VC,MDT]&quot;]

        base -&gt; s1
        base -&gt; s2
        base -&gt; s3
        base -&gt; s4
        base -&gt; s5
        base -&gt; s6
    }</p></object></div>
</section>
<section id="bottom-up-stepwise-search">
<h4>Bottom up stepwise search<a class="headerlink" href="#bottom-up-stepwise-search" title="Link to this heading">#</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">bottom_up_stepwise</span></code> algorithm differ from the <code class="docutils literal notranslate"><span class="pre">top_down_exhaustive</span></code> as the models are created
in iterative steps, each adding a single ETA. The algorithm will create a model with all possible IIVs and in the first step
it will remove all but one. This ETA will be on clearance (CL) if possible. If not, the first parameter in alphabetical order
will have an ETA. This model is then run and its results are used to update the initial estimates of the model. In the next step,
a candidate model is created for each remaining parameter that could have an ETA put on it. All models are run, and the best model
is chosen for the next step, updating the initial values once more.</p>
<p>The candidate models are then compared using the specified rank type and if no better model can be found, the algorithm stops.</p>
<p>Given a model with IIV on clearance (CL), central volume (VC), mean absorption time (MAT), and mean delay time (MDT),
the algorithm would try the following models (given that each candidate is better than its parent):</p>
<div class="graphviz"><object data="_images/graphviz-a73e7a77568cd566d1fa3d2277602fc5a99aed14.svg" type="image/svg+xml" class="graphviz">
<p class="warning">digraph BST {
        node [fontname=&quot;Arial&quot;];
        s1 [label=&quot;[CL]&quot;]
        s2 [label=&quot;[CL,VC]&quot;]
        s3 [label=&quot;[CL,MAT]&quot;]
        s4 [label=&quot;[CL,MDT]&quot;]
        s5 [label=&quot;[CL,VC,MAT]&quot;]
        s6 [label=&quot;[CL,VC,MDT]&quot;]
        s7 [label=&quot;[CL,VC,MDT,MAT]&quot;]

        s1 -&gt; s2
        s1 -&gt; s3
        s1 -&gt; s4
        s2 -&gt; s5
        s2 -&gt; s6
        s6 -&gt; s7

    }</p></object></div>
</section>
</section>
<section id="correlation-structure">
<h3>Correlation structure<a class="headerlink" href="#correlation-structure" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Algorithm</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'top_down_exhaustive'</span></code></p></td>
<td><p>Searches all combinations of covariances</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'skip'</span></code></p></td>
<td><p>Skip assessing correlation structures (then <code class="code docutils literal notranslate"><span class="pre">algorithm</span></code> needs
to be set).</p></td>
</tr>
</tbody>
</table>
</div>
<section id="id2">
<h4>Top down exhaustive search<a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<p>For the covariance structure search, the <code class="docutils literal notranslate"><span class="pre">top_down_exhaustive</span></code> algorithm will create candidates with all possible IIV variance and
covariance structures from the IIVs in the base model.</p>
<p>Given a model with IIV on clearance (CL), central volume (VC), and mean absorption time (MAT), the algorithm would try
the following models:</p>
<div class="graphviz"><object data="_images/graphviz-e4214dd5ca417edd9f29738f28893ae1eed06d17.svg" type="image/svg+xml" class="graphviz">
<p class="warning">digraph BST {
        node [fontname=&quot;Arial&quot;];
        base [label=&quot;[CL,VC,MAT]&quot;]
        s1 [label=&quot;[CL]+[VC]+[MAT]&quot;]
        s2 [label=&quot;[CL,VC]+[MAT]&quot;]
        s3 [label=&quot;[CL,MAT]+[VC]&quot;]
        s4 [label=&quot;[CL]+[MAT,VC]&quot;]

        base -&gt; s1
        base -&gt; s2
        base -&gt; s3
        base -&gt; s4

    }</p></object></div>
</section>
</section>
<section id="combing-algorithms">
<span id="iiv-algorithms-combined"></span><h3>Combing algorithms<a class="headerlink" href="#combing-algorithms" title="Link to this heading">#</a></h3>
<p>If both <code class="code docutils literal notranslate"><span class="pre">algorithm</span></code> and <code class="code docutils literal notranslate"><span class="pre">correlation_algorithm</span></code> are set, they will be performed in a stepwise manner.</p>
<p>Given a model with IIV on clearance (CL), central volume (VC), mean absorption time (MAT), and mean delay time (MDT),
and using top down exhaustive for both steps, the tool would try the following candidates :</p>
<div class="graphviz"><object data="_images/graphviz-e54d286ea67e063931605d8b902274719c719409.svg" type="image/svg+xml" class="graphviz">
<p class="warning">digraph BST {
        node [fontname=&quot;Arial&quot;];
        base [label=&quot;[CL,VC,MAT,MDT]&quot;]
        s1 [label=&quot;[CL]&quot;]
        s2 [label=&quot;[CL,VC]&quot;]
        s3 [label=&quot;[CL,MAT]&quot;]
        s4 [label=&quot;[CL,MDT]&quot;]
        s5 [label=&quot;[CL,VC,MAT]&quot;]
        s6 [label=&quot;[CL,VC,MDT]&quot;]

        base -&gt; s1
        base -&gt; s2
        base -&gt; s3
        base -&gt; s4
        base -&gt; s5
        base -&gt; s6

        s7 [label=&quot;[CL]+[VC]+[MAT]&quot;]
        s8 [label=&quot;[CL,VC]+[MAT]&quot;]
        s9 [label=&quot;[CL,MAT]+[V]&quot;]
        s10 [label=&quot;[VC,MAT]+[CL]&quot;]

        s5 -&gt; s7
        s5 -&gt; s8
        s5 -&gt; s9
        s5 -&gt; s10

    }</p></object></div>
<p><code class="code docutils literal notranslate"><span class="pre">algorithm</span></code> must be set explicitly, but if <code class="code docutils literal notranslate"><span class="pre">correlation_algorithm'</span></code> is <code class="docutils literal notranslate"><span class="pre">None/NULL</span></code>, the behavior
will be the following:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">correlation_algorithm</span></code></p></th>
<th class="head"><p>Behavior</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'top_down_exhaustive'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None/NULL</span></code></p></td>
<td><p>Top down exhausive for both steps</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'bottom_up_stepwise'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None/NULL</span></code></p></td>
<td><p>Bottom down stepwise for number of IIVs, top down
exhaustive for correlation structure</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="adding-iiv-to-the-input-model">
<span id="iiv-strategies-iivsearch"></span><h2>Adding IIV to the input model<a class="headerlink" href="#adding-iiv-to-the-input-model" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">iiv_strategy</span></code> option determines whether or not IIV on the PK parameters should be added to the input model.
The different strategies can be seen here:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Strategy</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'no_add'</span></code></p></td>
<td><p>Input model is kept as base model</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'add_diagonal'</span></code></p></td>
<td><p>Diagonal IIV is added to all PK parameters</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'fullblock'</span></code></p></td>
<td><p>IIV is added to all PK parameters, and all IIVs will be in a full block</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'pd_add_diagonal'</span></code></p></td>
<td><p>Diagonal IIV is added to all PD parameters</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'pd_fullblock'</span></code></p></td>
<td><p>IIV is added to all PD parameters, and all IIVs will be in a full block</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="comparing-and-ranking-candidates">
<span id="ranking-iivsearch"></span><h2>Comparing and ranking candidates<a class="headerlink" href="#comparing-and-ranking-candidates" title="Link to this heading">#</a></h2>
<p>The supplied <code class="docutils literal notranslate"><span class="pre">rank_type</span></code> will be used to compare a set of candidate models and rank them. A cutoff may also be provided
if the user does not want to use the default. The following rank functions are available:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Rank type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'ofv'</span></code></p></td>
<td><p>ΔOFV. Default is to not rank candidates with ΔOFV &lt; cutoff (default 3.84)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'aic'</span></code></p></td>
<td><p>ΔAIC. Default is to rank all candidates if no cutoff is provided.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'bic'</span></code></p></td>
<td><p>ΔBIC (iiv). Default is to rank all candidates if no cutoff is provided.</p></td>
</tr>
</tbody>
</table>
</div>
<p>Information about how BIC is calculated can be found in <a class="reference internal" href="api/pharmpy.modeling.calculate_bic.html#pharmpy.modeling.calculate_bic" title="pharmpy.modeling.calculate_bic"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.calculate_bic()</span></code></a>.</p>
</section>
<section id="linearization-approach">
<span id="linearize-iivsearch"></span><h2>Linearization approach<a class="headerlink" href="#linearization-approach" title="Link to this heading">#</a></h2>
<p>IIVsearch can be run with linearization. In this approach, a base model with all relevant IIVs will first be created and
run in order to get the derivatives. Next, IIVsearch calls the linearize tool to linearize and run the model. All
subsequent candidate models in IIVsearch will be linearized and estimated. Once the best model of these candidates
have been selected, a delinearized version of the best candidate is created and estimated.</p>
<div class="graphviz"><object data="_images/graphviz-bdc318982a223982d97e597b0d8d7df5d5621a6c.svg" type="image/svg+xml" class="graphviz">
<p class="warning">digraph G {
  draw [
    label = &quot;Input model&quot;;
    shape = rect;
  ];
  derivative [
    label = &quot;Add IIVs for derivatives&quot;;
    shape = rect;
  ];
  linearize [
      label = &quot;Linearize model&quot;;
      shape = rect;
  ]
  cands [
      label = &quot;Create linearized candidates&quot;;
      shape = rect;
  ]
  best_cand [
      label = &quot;Select best linearized model and delinearize&quot;;
      shape = rect;
  ]
  better [
      label = &quot;Better than input model?&quot;;
      shape = rect;
  ]
  select_lin [
      label = &quot;Select input&quot;;
      shape = rect;
  ]
  select_input [
      label = &quot;Select candidate&quot;;
      shape = rect;
  ]
  done [
      label = &quot;Best model&quot;;
      shape = rect;
  ]

  draw -&gt; derivative;
  derivative -&gt; linearize[label = &quot;Fit model&quot;];
  linearize -&gt; cands[label = &quot;Fit model&quot;];
  cands -&gt; best_cand[label = &quot;Fit models&quot;];
  best_cand -&gt; better[label = &quot;Fit model&quot;];

  better -&gt; select_input[label = &quot;Yes&quot;];
  better -&gt; select_lin [label = &quot;No&quot;];

  select_input -&gt; done;
  select_lin -&gt; done;

}</p></object></div>
</section>
<section id="the-iivsearch-results">
<h2>The IIVsearch results<a class="headerlink" href="#the-iivsearch-results" title="Link to this heading">#</a></h2>
<p>The results object contains various summary tables which can be accessed in the results object, as well as files in
.csv/.json format. The name of the selected best model (based on the input selection criteria) is also included.</p>
<p>Consider a iivsearch run:</p>
<div class="pharmpy-snippet docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-1-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-1-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-1-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">run_iivsearch</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">start_model</span><span class="p">,</span>
                    <span class="n">results</span><span class="o">=</span><span class="n">start_model_results</span><span class="p">,</span>
                    <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;top_down_exhaustive&#39;</span><span class="p">,</span>
                    <span class="n">iiv_strategy</span><span class="o">=</span><span class="s1">&#39;no_add&#39;</span><span class="p">,</span>
                    <span class="n">rank_type</span><span class="o">=</span><span class="s1">&#39;bic&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-1-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">res</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">run_iivsearch</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">start_model</span><span class="p">,</span>
<span class="w">                    </span><span class="n">results</span><span class="o">=</span><span class="n">start_model_results</span><span class="p">,</span>
<span class="w">                    </span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;top_down_exhaustive&#39;</span><span class="p">,</span>
<span class="w">                    </span><span class="n">iiv_strategy</span><span class="o">=</span><span class="s">&#39;no_add&#39;</span><span class="p">,</span>
<span class="w">                    </span><span class="n">rank_type</span><span class="o">=</span><span class="s">&#39;bic&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">summary_tool</span></code> table contains information such as which feature each model candidate has, the difference to the
input model (in this case comparing BIC), and final ranking:</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>description</th>
      <th>n_params</th>
      <th>d_params</th>
      <th>dbic</th>
      <th>bic</th>
      <th>rank</th>
      <th>parent_model</th>
    </tr>
    <tr>
      <th>step</th>
      <th>model</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">1</th>
      <th>iivsearch_run2</th>
      <td>[CL]+[VC]</td>
      <td>6</td>
      <td>-1</td>
      <td>4.282024</td>
      <td>-1283.597406</td>
      <td>1</td>
      <td>input</td>
    </tr>
    <tr>
      <th>input</th>
      <td>[CL]+[VC]+[MAT]</td>
      <td>7</td>
      <td>0</td>
      <td>0.000000</td>
      <td>-1279.315382</td>
      <td>2</td>
      <td>input</td>
    </tr>
    <tr>
      <th>iivsearch_run1</th>
      <td>[CL]+[MAT]</td>
      <td>6</td>
      <td>-1</td>
      <td>-217.691571</td>
      <td>-1061.623812</td>
      <td>3</td>
      <td>input</td>
    </tr>
    <tr>
      <th>iivsearch_run3</th>
      <td>[CL]</td>
      <td>5</td>
      <td>-2</td>
      <td>-385.641987</td>
      <td>-893.673395</td>
      <td>4</td>
      <td>input</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">2</th>
      <th>iivsearch_run4</th>
      <td>[CL,VC]</td>
      <td>7</td>
      <td>1</td>
      <td>81.971960</td>
      <td>-1365.569365</td>
      <td>1</td>
      <td>iivsearch_run2</td>
    </tr>
    <tr>
      <th>iivsearch_run2</th>
      <td>[CL]+[VC]</td>
      <td>6</td>
      <td>0</td>
      <td>0.000000</td>
      <td>-1283.597406</td>
      <td>2</td>
      <td>iivsearch_run2</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">3</th>
      <th>iivsearch_run4</th>
      <td>[CL,VC]</td>
      <td>7</td>
      <td>0</td>
      <td>86.253983</td>
      <td>-1365.569365</td>
      <td>1</td>
      <td>iivsearch_run4</td>
    </tr>
    <tr>
      <th>input</th>
      <td>[CL]+[VC]+[MAT]</td>
      <td>7</td>
      <td>0</td>
      <td>0.000000</td>
      <td>-1279.315382</td>
      <td>2</td>
      <td>input</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<p>To see information about the actual model runs, such as minimization status, estimation time, and parameter estimates,
you can look at the <code class="docutils literal notranslate"><span class="pre">summary_models</span></code> table. The table is generated with
<a class="reference internal" href="api/pharmpy.tools.summarize_modelfit_results.html#pharmpy.tools.summarize_modelfit_results" title="pharmpy.tools.summarize_modelfit_results"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.tools.summarize_modelfit_results()</span></code></a>.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>description</th>
      <th>minimization_successful</th>
      <th>errors_found</th>
      <th>warnings_found</th>
      <th>ofv</th>
      <th>runtime_total</th>
      <th>estimation_runtime</th>
      <th>POP_CL_estimate</th>
      <th>POP_CL_SE</th>
      <th>POP_CL_RSE</th>
      <th>...</th>
      <th>IIV_VC_RSE</th>
      <th>IIV_MAT_estimate</th>
      <th>IIV_MAT_SE</th>
      <th>IIV_MAT_RSE</th>
      <th>RUV_PROP_estimate</th>
      <th>RUV_PROP_SE</th>
      <th>RUV_PROP_RSE</th>
      <th>IIV_CL_IIV_VC_estimate</th>
      <th>IIV_CL_IIV_VC_SE</th>
      <th>IIV_CL_IIV_VC_RSE</th>
    </tr>
    <tr>
      <th>step</th>
      <th>model</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <th>input</th>
      <td>[CL]+[VC]+[MAT]</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>-1292.186761</td>
      <td>4.0</td>
      <td>0.10</td>
      <td>24.5328</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.00013</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.209972</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">1</th>
      <th>iivsearch_run1</th>
      <td>[CL]+[MAT]</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>-1070.204731</td>
      <td>7.0</td>
      <td>0.17</td>
      <td>29.0366</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>3.31998</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.401593</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>iivsearch_run2</th>
      <td>[CL]+[VC]</td>
      <td>True</td>
      <td>0</td>
      <td>1</td>
      <td>-1292.178325</td>
      <td>8.0</td>
      <td>0.07</td>
      <td>24.5333</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.209975</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>iivsearch_run3</th>
      <td>[CL]</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>-897.963854</td>
      <td>8.0</td>
      <td>0.10</td>
      <td>29.1049</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.574966</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <th>iivsearch_run4</th>
      <td>[CL,VC]</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>-1378.440744</td>
      <td>4.0</td>
      <td>0.11</td>
      <td>24.9055</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.215885</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.498114</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 31 columns</p>
</div></div></div>
</div>
</div>
<p>Finally, you can see a summary of different errors and warnings in <code class="docutils literal notranslate"><span class="pre">summary_errors</span></code>.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.tools.summarize_errors()</span></code> for information on the content of this table.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>time</th>
      <th>message</th>
    </tr>
    <tr>
      <th>step</th>
      <th>model</th>
      <th>category</th>
      <th>error_no</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <th>iivsearch_run2</th>
      <th>WARNING</th>
      <th>0</th>
      <td>2024-10-22 13:15:02.368</td>
      <td>MINIMIZATION SUCCESSFUL\nHOWEVER, PROBLEMS OCCURRED WITH THE MINIMIZATION.</td>
    </tr>
    <tr>
      <th>2</th>
      <th>iivsearch_run2</th>
      <th>WARNING</th>
      <th>0</th>
      <td>2024-10-22 13:15:02.368</td>
      <td>MINIMIZATION SUCCESSFUL\nHOWEVER, PROBLEMS OCCURRED WITH THE MINIMIZATION.</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="drug_metabolite.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Drug metabolite</p>
      </div>
    </a>
    <a class="right-next"
       href="iovsearch.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">IOVsearch</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running">Running</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#arguments">Arguments</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mandatory">Mandatory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optional">Optional</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorithms">Algorithms</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#number-of-iivs">Number of IIVs</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#top-down-exhaustive-search">Top down exhaustive search</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bottom-up-stepwise-search">Bottom up stepwise search</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#correlation-structure">Correlation structure</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Top down exhaustive search</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combing-algorithms">Combing algorithms</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-iiv-to-the-input-model">Adding IIV to the input model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-and-ranking-candidates">Comparing and ranking candidates</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linearization-approach">Linearization approach</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-iivsearch-results">The IIVsearch results</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2018-2025; the Pharmpy development team.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>