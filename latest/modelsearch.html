
<!DOCTYPE html>


<html lang="en" data-content_root="./" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Modelsearch &#8212; Pharmpy 2.0.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=34bb78ad" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css?v=a5c4661c" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=63439bfe" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=51b770b3"></script>
    <script src="_static/doctools.js?v=fd6eb6e6"></script>
    <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script src="_static/tabs.js?v=3030b3cb"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'modelsearch';</script>
    <link rel="icon" href="_static/Pharmpy_symbol.svg"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Structsearch" href="structsearch.html" />
    <link rel="prev" title="AMD - Drug metabolite" href="amd_drug_metabolite.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="2.0.0" />
    <meta name="docbuild:last-update" content="Feb 12, 2026"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
    
    <img src="_static/Pharmpy_logo.svg" class="logo__image only-light" alt="Pharmpy 2.0.0 documentation - Home"/>
    <img src="_static/Pharmpy_logo_dark.svg" class="logo__image only-dark pst-js-only" alt="Pharmpy 2.0.0 documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="contributors.html">
    About us
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="getting_started.html">
    Getting started
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="user_guide.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="api.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="news.html">
    News
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="contribute.html">
    Contribute
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="citation.html">
    References and citation
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="license.html">
    License
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="developers.html">
    Documentation for developers
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pharmpy/pharmpy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pharmpy/pharmpy/issues" title="Report issues" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa fa-bug fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Report issues</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pharmpy/pharmpy/discussions" title="Discussions" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa fa-comments fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Discussions</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="contributors.html">
    About us
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="getting_started.html">
    Getting started
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="user_guide.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="api.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="news.html">
    News
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="contribute.html">
    Contribute
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="citation.html">
    References and citation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="license.html">
    License
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="developers.html">
    Documentation for developers
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pharmpy/pharmpy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pharmpy/pharmpy/issues" title="Report issues" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa fa-bug fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Report issues</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pharmpy/pharmpy/discussions" title="Discussions" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa fa-comments fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Discussions</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="tools.html">Tools</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="general.html">General</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="common_features.html">Common features</a></li>
<li class="toctree-l3"><a class="reference internal" href="mfl.html">Model Feature Language (MFL)</a></li>
<li class="toctree-l3"><a class="reference internal" href="options.html">Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="strictness.html">Strictness</a></li>
<li class="toctree-l3"><a class="reference internal" href="selection_criteria.html">Selection criteria</a></li>
<li class="toctree-l3"><a class="reference internal" href="context.html">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="dispatching.html">Dispatching</a></li>

</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="amd.html">AMD - automatic model development</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="amd_pk.html">PK</a></li>
<li class="toctree-l3"><a class="reference internal" href="amd_pkpd.html">PKPD</a></li>
<li class="toctree-l3"><a class="reference internal" href="amd_tmdd.html">TMDD</a></li>
<li class="toctree-l3"><a class="reference internal" href="amd_drug_metabolite.html">Drug Metabolite</a></li>
</ul>
</details></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Modelsearch - search for best structural model for a PK model</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="structsearch.html">Structsearch - search for best structural model for PKPD, drug metabolite and TMDD models</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="pkpd.html">PKPD</a></li>
<li class="toctree-l3"><a class="reference internal" href="tmdd.html">TMDD</a></li>
<li class="toctree-l3"><a class="reference internal" href="drug_metabolite.html">Drug Metabolite</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="iivsearch.html">IIVsearch - search for best IIV structure (both variance and covariance)</a></li>
<li class="toctree-l2"><a class="reference internal" href="iovsearch.html">IOVsearch - search for best IOV structure and trim IIV</a></li>
<li class="toctree-l2"><a class="reference internal" href="covsearch.html">COVsearch - identify covariates that explain some of the IIV</a></li>
<li class="toctree-l2"><a class="reference internal" href="ruvsearch.html">RUVsearch - search for best residual error model</a></li>
<li class="toctree-l2"><a class="reference internal" href="allometry.html">allometry - add allometric scaling</a></li>
<li class="toctree-l2"><a class="reference internal" href="estmethod.html">estmethod - compare estimation methods and/or solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="retries.html">Retries - Rerun a model with tweaked initial estimates</a></li>
<li class="toctree-l2"><a class="reference internal" href="simulation.html">Simulation - Run a simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="linearize_tool.html">Linearize - Linearize a model</a></li>
<li class="toctree-l2"><a class="reference internal" href="vpc.html">VPC - Visual predictive check</a></li>
<li class="toctree-l2"><a class="reference internal" href="modelrank.html">ModelRank - rank models</a></li>
<li class="toctree-l2"><a class="reference internal" href="bootstrap.html">Bootstrap</a></li>
<li class="toctree-l2"><a class="reference internal" href="qa.html">QA - Quality assurance of a model</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="modelfit.html">Model estimation and results</a></li>
<li class="toctree-l1"><a class="reference internal" href="modeling.html">Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">The Pharmpy model</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_r.html">Pharmpy in R</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command line interface</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="psn_tools.html">PsN with Pharmpy</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="cdd.html">Case deletion diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="crossval.html">Crossval</a></li>
<li class="toctree-l2"><a class="reference internal" href="frem.html">FREM</a></li>
<li class="toctree-l2"><a class="reference internal" href="linearize.html">Linearize</a></li>
<li class="toctree-l2"><a class="reference internal" href="psn_resmod.html">resmod</a></li>
<li class="toctree-l2"><a class="reference internal" href="scm.html">scm</a></li>
<li class="toctree-l2"><a class="reference internal" href="simeval.html">Simeval</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="user_guide.html" class="nav-link">User guide</a></li>
    
    
    <li class="breadcrumb-item"><a href="tools.html" class="nav-link">Tools</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Modelsearch</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="modelsearch">
<span id="id1"></span><h1>Modelsearch<a class="headerlink" href="#modelsearch" title="Link to this heading">#</a></h1>
<p>The Modelsearch tool is a general tool to decide the best structural model given a base model and a search space of
model features. The tool supports different algorithms and selection criteria.</p>
<section id="running">
<h2>Running<a class="headerlink" href="#running" title="Link to this heading">#</a></h2>
<p>The modelsearch tool is available both in Pharmpy/pharmr and from the command line.</p>
<p>To initiate modelsearch in Python/R:</p>
<div class="pharmpy-snippet docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-0-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-0-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-0-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pharmpy.modeling</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_model</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pharmpy.tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_modelfit_results</span><span class="p">,</span> <span class="n">run_modelsearch</span>

<span class="n">start_model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="s1">&#39;path/to/model&#39;</span><span class="p">)</span>
<span class="n">start_model_results</span> <span class="o">=</span> <span class="n">read_modelfit_results</span><span class="p">(</span><span class="s1">&#39;path/to/model&#39;</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">run_modelsearch</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">start_model</span><span class="p">,</span>
                      <span class="n">results</span><span class="o">=</span><span class="n">start_model_results</span><span class="p">,</span>
                      <span class="n">search_space</span><span class="o">=</span><span class="s1">&#39;ABSORPTION([FO,ZO]);PERIPHERALS([0,1]);LAGTIME([OFF,ON])&#39;</span><span class="p">,</span>
                      <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;reduced_stepwise&#39;</span><span class="p">,</span>
                      <span class="n">iiv_strategy</span><span class="o">=</span><span class="s1">&#39;absorption_delay&#39;</span><span class="p">,</span>
                      <span class="n">rank_type</span><span class="o">=</span><span class="s1">&#39;bic&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">start_model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_model</span><span class="p">(</span><span class="s">&#39;path/to/model&#39;</span><span class="p">)</span>
<span class="n">start_model_results</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_modelfit_results</span><span class="p">(</span><span class="s">&#39;path/to/model&#39;</span><span class="p">)</span>
<span class="n">res</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">run_modelsearch</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">start_model</span><span class="p">,</span>
<span class="w"> </span><span class="n">results</span><span class="o">=</span><span class="n">start_model_results</span><span class="p">,</span>
<span class="w"> </span><span class="n">search_space</span><span class="o">=</span><span class="s">&#39;ABSORPTION(c(FO,ZO));PERIPHERALS(c(0,1));LAGTIME(c(OFF,ON))&#39;</span><span class="p">,</span>
<span class="w"> </span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;reduced_stepwise&#39;</span><span class="p">,</span>
<span class="w"> </span><span class="n">iiv_strategy</span><span class="o">=</span><span class="s">&#39;absorption_delay&#39;</span><span class="p">,</span>
<span class="w"> </span><span class="n">rank_type</span><span class="o">=</span><span class="s">&#39;bic&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
</div>
<p>This will take an input <code class="docutils literal notranslate"><span class="pre">model</span></code> and its <code class="docutils literal notranslate"><span class="pre">results</span></code> and evaluate candidates given in the <code class="docutils literal notranslate"><span class="pre">search_space</span></code>
(see <a class="reference internal" href="#the-search-space"><span class="std std-ref">Search space</span></a> for more details). The tool will use the ‘reduced_stepwise’ search <code class="docutils literal notranslate"><span class="pre">algorithm</span></code>. IIVs on
structural parameters (such as mean absorption time) will not be added to candidates since <code class="docutils literal notranslate"><span class="pre">iiv_strategy</span></code> is
set to be ‘absorption_delay’. The candidate models will have BIC as the <code class="docutils literal notranslate"><span class="pre">rank_type</span></code> with default <code class="docutils literal notranslate"><span class="pre">cutoff</span></code>,
which for BIC is None/NULL.</p>
<p>To run modelsearch from the command line, the example code is redefined accordingly:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pharmpy</span> <span class="n">run</span> <span class="n">modelsearch</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">model</span> <span class="s1">&#39;ABSORPTION([FO,ZO]);PERIPHERALS([0,1]);LAGTIME([OFF,ON])&#39;</span> <span class="o">--</span><span class="n">algorithm</span> <span class="s1">&#39;reduced_stepwise&#39;</span> <span class="o">--</span><span class="n">iiv_strategy</span> <span class="s1">&#39;absorption_delay&#39;</span> <span class="o">--</span><span class="n">rank_type</span> <span class="s1">&#39;bic&#39;</span>
</pre></div>
</div>
<section id="arguments">
<h3>Arguments<a class="headerlink" href="#arguments" title="Link to this heading">#</a></h3>
<p>For a more detailed description of each argument, see their respective chapter on this page.</p>
<section id="mandatory">
<h4>Mandatory<a class="headerlink" href="#mandatory" title="Link to this heading">#</a></h4>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">search_space</span></code></p></td>
<td><p><a class="reference internal" href="#the-search-space"><span class="std std-ref">Search space</span></a> to test</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code></p></td>
<td><p><a class="reference internal" href="#algorithms-modelsearch"><span class="std std-ref">Algorithm</span></a>
to use (default is <code class="docutils literal notranslate"><span class="pre">'reduced_stepwise'</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">model</span></code></p></td>
<td><p>Start model</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">results</span></code></p></td>
<td><p>ModelfitResults of the start model</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="optional">
<h4>Optional<a class="headerlink" href="#optional" title="Link to this heading">#</a></h4>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">rank_type</span></code></p></td>
<td><p>Which <a class="reference internal" href="#ranking-modelsearch"><span class="std std-ref">selection criteria</span></a> to rank
models on, e.g. OFV (default is BIC)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cutoff</span></code></p></td>
<td><p><a class="reference internal" href="#ranking-modelsearch"><span class="std std-ref">Cutoff</span></a> for the ranking function,
exclude models that are below cutoff (default is None/NULL)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iiv_strategy</span></code></p></td>
<td><p>If/how IIV should be added to candidate models (default is to
add to absorption delay parameters).
See <a class="reference internal" href="#iiv-strategies-modelsearch"><span class="std std-ref">Adding IIV to the candidate models during search</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">strictness</span></code></p></td>
<td><p><a class="reference internal" href="strictness.html#strictness"><span class="std std-ref">Strictness</span></a> criteria for model selection.
Default is “minimization_successful or
(rounding_errors and sigdigs&gt;= 0.1)”</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
</section>
<section id="the-search-space">
<span id="id2"></span><h2>The search space<a class="headerlink" href="#the-search-space" title="Link to this heading">#</a></h2>
<p>The model feature search space is a set of all possible combinations of model features that is allowed for the final model. The supported
features cover absorption, absorption delay, elimination, and distribution. The search space is given as a string with a specific
grammar, according to the <cite>Model Feature Language</cite> (MFL) (see <a class="reference internal" href="mfl.html#mfl"><span class="std std-ref">detailed description</span></a>). Since the search space describes
which models are in scope for the tool, if the input model is not part of said search space a base model within the scope
needs to be created before starting the search algorithm. If a feature in the model is not in the search space, the default
value for that feature will be used:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Category</p></th>
<th class="head"><p>DEFAULT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ABSORPTION</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">INST</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ELIMINATION</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">FO</span></code></p></td>
</tr>
<tr class="row-even"><td><p>PERIPHERALS</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">0</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>TRANSITS</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">0</span></code></p></td>
</tr>
<tr class="row-even"><td><p>LAGTIME</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">OFF</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Given an input model and a search space, the first step of the tool is to check whether the input model is part of the search space. If it is, the
input model will be used for the subsequent steps in the tool. If the model is not part of the search space, a base model fitting in the search
space is created. The logical flow for the creation of the base model can be seen below.</p>
<div class="graphviz"><object data="_images/graphviz-89804f08f87fde34f87530451ea05756c2114b37.svg" type="image/svg+xml" class="graphviz">
<p class="warning">digraph G {
splines = false
  input_model [
    label = &quot;Input model&quot;;
  ];

  search_space [
    label = &quot;Search space&quot;;
  ];

  input_ss [
    label = &quot;Input + search space&quot;;
  ];

  filter_model [
    label = &quot;Start model for search&quot;;
  ];

  create_base [
    label = &quot;Create a base&quot;;
  ];

  input_model -&gt; input_ss;
  search_space -&gt; input_ss;
  input_ss -&gt; create_base [label = &quot;Input model &amp;notin; search space&quot;];
  create_base -&gt; filter_model;
  input_ss -&gt; filter_model [label = &quot;Input model &amp;isin; search space&quot;];
}</p></object></div>
<p>Some examples of input models and which changes would be made:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Search space</p></th>
<th class="head"><p>Input model</p></th>
<th class="head"><p>Base model</p></th>
<th class="head"><p>Transformations to apply</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ABSORPTION([FO,ZO])
ELIMINATION(FO)
PERIPHERALS([1,2])</p></td>
<td><p>ABSORPTION(FO)
ELIMINATION(ZO)
TRANSITS(0)
PERIPHERALS(0)
LAGTIME(ON)</p></td>
<td><p>ABSORPTION(FO)
ELIMINATION(FO)
TRANSITS(0)
PERIPHERALS(1)
LAGTIME(OFF)</p></td>
<td><p>ABSORPTION(ZO)
PERIPHERALS(2)</p></td>
</tr>
<tr class="row-odd"><td><p>ABSORPTION(FO)
ELIMINATION(FO)
TRANSITS([1,2])</p></td>
<td><p>ABSORPTION(FO)
ELIMINATION(ZO)
TRANSITS(0)
PERIPHERALS(2)
LAGTIME(OFF)</p></td>
<td><p>ABSORPTION(FO)
ELIMINATION(FO)
TRANSITS(1)
PERIPHERALS(0)
LAGTIME(OFF)</p></td>
<td><p>TRANSITS(2)</p></td>
</tr>
<tr class="row-even"><td><p>ABSORPTION([FO,ZO])
ELIMINATION([FO,ZO,MM])
PERIPHERALS([0,1,2])
LAGTIME([OFF,ON])</p></td>
<td><p>ABSORPTION(FO)
ELIMINATION(FO)
TRANSITS(0)
PERIPHERALS(0)
LAGTIME(OFF)</p></td>
<td><p>Not needed since
input model is part
of search space</p></td>
<td><p>ABSORPTION(ZO)
ELIMINATION([ZO,MM])
PERIPHERALS([1,2]
LAGTIME(ON)</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="algorithms">
<span id="algorithms-modelsearch"></span><h2>Algorithms<a class="headerlink" href="#algorithms" title="Link to this heading">#</a></h2>
<p>The tool can conduct the model search using different algorithms. The available algorithms can be seen in the table
below.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Algorithm</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'exhaustive'</span></code></p></td>
<td><p>All possible combinations of the search space are tested</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'exhaustive_stepwise'</span></code></p></td>
<td><p>Add one feature in each step in all possible orders</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'reduced_stepwise'</span></code></p></td>
<td><p>Add one feature in each step in all possible orders. After each feature layer, choose
best model between models with same features</p></td>
</tr>
</tbody>
</table>
</div>
<section id="exhaustive-search">
<h3>Exhaustive search<a class="headerlink" href="#exhaustive-search" title="Link to this heading">#</a></h3>
<p>An <code class="docutils literal notranslate"><span class="pre">exhaustive</span></code> search will test all possible combinations of features in the search space. All candidate models will be
created simultaneously from the input model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ABSORPTION</span><span class="p">(</span><span class="n">ZO</span><span class="p">)</span>
<span class="n">ELIMINATION</span><span class="p">(</span><span class="n">MM</span><span class="p">)</span>
<span class="n">PERIPHERALS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="graphviz"><object data="_images/graphviz-c71cda5209a3243e4a7bcc951df90449ede78c29.svg" type="image/svg+xml" class="graphviz">
<p class="warning">digraph BST {
    node [fontname=&quot;Arial&quot;];
    base [label=&quot;Base model&quot;]
    s1 [label=&quot;ABSORPTION(ZO)&quot;]
    s2 [label=&quot;ELIMINATION(MM)&quot;]
    s3 [label=&quot;PERIPHERALS(1)&quot;]
    s4 [label=&quot;ABSORPTION(ZO);ELIMINATION(MM)&quot;]
    s5 [label=&quot;ABSORPTION(ZO);PERIPHERALS(1)&quot;]
    s6 [label=&quot;ELIMINATION(MM);PERIPHERALS(1)&quot;]
    s7 [label=&quot;ABSORPTION(ZO);ELIMINATION(MM);PERIPHERALS(1)&quot;]
    base -&gt; s1
    base -&gt; s2
    base -&gt; s3
    base -&gt; s4
    base -&gt; s5
    base -&gt; s6
    base -&gt; s7
}</p></object></div>
</section>
<section id="exhaustive-stepwise-search">
<h3>Exhaustive stepwise search<a class="headerlink" href="#exhaustive-stepwise-search" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">exhaustive_stepwise</span></code> search applies features in a stepwise manner such that only one feature is changed at a time.
Between each step, the initial estimates from the new candidate model will be updated from the final estimates from the
previous step.</p>
<div class="graphviz"><object data="_images/graphviz-6d4736f7245606f24497a8d2b77820f8093086b3.svg" type="image/svg+xml" class="graphviz">
<p class="warning">digraph BST {
    node [fontname=&quot;Arial&quot;];
    base [label=&quot;Base model&quot;]
    s1 [label=&quot;ABSORPTION(ZO)&quot;]
    s2 [label=&quot;ELIMINATION(MM)&quot;]
    s3 [label=&quot;PERIPHERALS(1)&quot;]
    s4 [label=&quot;ELIMINATION(MM)&quot;]
    s5 [label=&quot;PERIPHERALS(1)&quot;]
    s6 [label=&quot;ABSORPTION(ZO)&quot;]
    s7 [label=&quot;PERIPHERALS(1)&quot;]
    s8 [label=&quot;ABSORPTION(ZO)&quot;]
    s9 [label=&quot;ELIMINATION(MM)&quot;]
    s10 [label=&quot;PERIPHERALS(1)&quot;]
    s11 [label=&quot;ELIMINATION(MM)&quot;]
    s12 [label=&quot;PERIPHERALS(1)&quot;]
    s13 [label=&quot;ABSORPTION(ZO)&quot;]
    s14 [label=&quot;ELIMINATION(MM)&quot;]
    s15 [label=&quot;ABSORPTION(ZO)&quot;]
    base -&gt; s1
    base -&gt; s2
    base -&gt; s3
    s1 -&gt; s4
    s1 -&gt; s5
    s2 -&gt; s6
    s2 -&gt; s7
    s3 -&gt; s8
    s3 -&gt; s9
    s4 -&gt; s10
    s5 -&gt; s11
    s6 -&gt; s12
    s7 -&gt; s13
    s8 -&gt; s14
    s9 -&gt; s15
}</p></object></div>
</section>
<section id="reduced-stepwise-search">
<h3>Reduced stepwise search<a class="headerlink" href="#reduced-stepwise-search" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">reduced_stepwise</span></code> search is similar to the exhaustive stepwise search, but after each layer it compares models with
the same features, where the compared models were obtained by adding the features in a different order. Next, the
algorithm uses the best model from each comparison as the basis for the next layer, where the subsequent feature is
added.</p>
<div class="graphviz"><object data="_images/graphviz-d4e0aa6b69c8198d3700ea147d30cf6e3baedb49.svg" type="image/svg+xml" class="graphviz">
<p class="warning">digraph BST {
    node [fontname=&quot;Arial&quot;];
    base [label=&quot;Base model&quot;]
    s1 [label=&quot;ABSORPTION(ZO)&quot;]
    s2 [label=&quot;ELIMINATION(MM)&quot;]
    s3 [label=&quot;PERIPHERALS(1)&quot;]
    s4 [label=&quot;ELIMINATION(MM)&quot;]
    s5 [label=&quot;PERIPHERALS(1)&quot;]
    s6 [label=&quot;ABSORPTION(ZO)&quot;]
    s7 [label=&quot;PERIPHERALS(1)&quot;]
    s8 [label=&quot;ABSORPTION(ZO)&quot;]
    s9 [label=&quot;ELIMINATION(MM)&quot;]
    s10 [label=&quot;Best model&quot;]
    s11 [label=&quot;Best model&quot;]
    s12 [label=&quot;Best model&quot;]
    s13 [label=&quot;PERIPHERALS(1)&quot;]
    s14 [label=&quot;ELIMINATION(MM)&quot;]
    s15 [label=&quot;ABSORPTION(ZO)&quot;]
    base -&gt; s1
    base -&gt; s2
    base -&gt; s3
    s1 -&gt; s4
    s1 -&gt; s5
    s2 -&gt; s6
    s2 -&gt; s7
    s3 -&gt; s8
    s3 -&gt; s9
    s4 -&gt; s10
    s6 -&gt; s10
    s5 -&gt; s11
    s8 -&gt; s11
    s7 -&gt; s12
    s9 -&gt; s12
    s10 -&gt; s13
    s11 -&gt; s14
    s12 -&gt; s15
}</p></object></div>
</section>
<section id="common-behaviours-between-algorithms">
<h3>Common behaviours between algorithms<a class="headerlink" href="#common-behaviours-between-algorithms" title="Link to this heading">#</a></h3>
<p>Some behaviours are common between the algorithms, such as post-processing and which features cannot be combined.</p>
<section id="feature-combination-exclusions">
<h4>Feature combination exclusions<a class="headerlink" href="#feature-combination-exclusions" title="Link to this heading">#</a></h4>
<p>Some combinations of features are excluded. Some of them are excluded due to not being compatible pharmacometrically,
others due to technical limitations of Pharmpy. The following combinations are excluded:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Feature A</p></th>
<th class="head"><p>Feature B</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ABSORPTION(ZO)</p></td>
<td><p>TRANSITS</p></td>
</tr>
<tr class="row-odd"><td><p>ABSORPTION(SEQ-ZO-FO)</p></td>
<td><p>TRANSITS</p></td>
</tr>
<tr class="row-even"><td><p>ABSORPTION(SEQ-ZO-FO)</p></td>
<td><p>LAGTIME(ON)</p></td>
</tr>
<tr class="row-odd"><td><p>ABSORPTION(INST)</p></td>
<td><p>LAGTIME(ON)</p></td>
</tr>
<tr class="row-even"><td><p>ABSORPTION(INST)</p></td>
<td><p>TRANSITS</p></td>
</tr>
<tr class="row-odd"><td><p>LAGTIME(ON)</p></td>
<td><p>TRANSITS</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="stepwise-addition-of-peripherals">
<h4>Stepwise addition of peripherals<a class="headerlink" href="#stepwise-addition-of-peripherals" title="Link to this heading">#</a></h4>
<p>In stepwise algorithms, peripheral compartments are always run sequentially, i.e. the algorithm will never add more
than one compartment at a given step. This is done in order to allow for better initial estimates from previous
peripherals.</p>
</section>
</section>
</section>
<section id="adding-iiv-to-the-candidate-models-during-search">
<span id="iiv-strategies-modelsearch"></span><h2>Adding IIV to the candidate models during search<a class="headerlink" href="#adding-iiv-to-the-candidate-models-during-search" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">iiv_strategy</span></code> option determines whether or not IIV on the PK parameters should be added to the candidate models.
The different strategies can be seen here:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Strategy</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'no_add'</span></code></p></td>
<td><p>No IIVs are added during the search</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'add_diagonal'</span></code></p></td>
<td><p>IIV is added to all structural parameters as diagonal</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'fullblock'</span></code></p></td>
<td><p>IIV is added to all structural parameters, and all IIVs will be in a full block</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'absorption_delay'</span></code></p></td>
<td><p>IIV is added only to the absorption delay parameter (default)</p></td>
</tr>
</tbody>
</table>
</div>
<p>For more information regarding which parameters are counted as structural parameters, see
<a class="reference internal" href="api/pharmpy.modeling.add_pk_iiv.html#pharmpy.modeling.add_pk_iiv" title="pharmpy.modeling.add_pk_iiv"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.add_pk_iiv()</span></code></a>.</p>
</section>
<section id="comparing-and-ranking-candidates">
<span id="ranking-modelsearch"></span><h2>Comparing and ranking candidates<a class="headerlink" href="#comparing-and-ranking-candidates" title="Link to this heading">#</a></h2>
<p>The supplied <code class="docutils literal notranslate"><span class="pre">rank_type</span></code> will be used to compare a set of candidate models and rank them. Each candidate model
will be compared to the input model. A cutoff may also be provided if the user does not want to use the default.
The following rank functions are available:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Rank type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'ofv'</span></code></p></td>
<td><p>ΔOFV. Default is to not rank candidates with ΔOFV &lt; cutoff (default 3.84)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'aic'</span></code></p></td>
<td><p>ΔAIC. Default is to rank all candidates if no cutoff is provided.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'bic'</span></code></p></td>
<td><p>ΔBIC (mixed). Default is to rank all candidates if no cutoff is provided.</p></td>
</tr>
</tbody>
</table>
</div>
<p>Information about how BIC is calculated can be found in <a class="reference internal" href="api/pharmpy.modeling.calculate_bic.html#pharmpy.modeling.calculate_bic" title="pharmpy.modeling.calculate_bic"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.calculate_bic()</span></code></a>.</p>
</section>
<section id="the-modelsearch-results">
<h2>The Modelsearch results<a class="headerlink" href="#the-modelsearch-results" title="Link to this heading">#</a></h2>
<p>The results object contains various summary tables which can be accessed in the results object, as well as files in
.csv/.json format. The name of the selected best model (based on the input selection criteria) is also included.</p>
<p>Consider a modelsearch run with the search space of zero and first order absorption, adding zero or one peripheral
compartment and lagtime:</p>
<div class="pharmpy-snippet docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-1-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-1-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-1-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">run_modelsearch</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">start_model</span><span class="p">,</span>
                      <span class="n">results</span><span class="o">=</span><span class="n">start_model_results</span><span class="p">,</span>
                      <span class="n">search_space</span><span class="o">=</span><span class="s1">&#39;ABSORPTION([FO,ZO]);PERIPHERALS([0,1]);LAGTIME(ON)&#39;</span><span class="p">,</span>
                      <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;reduced_stepwise&#39;</span><span class="p">,</span>
                      <span class="n">iiv_strategy</span><span class="o">=</span><span class="s1">&#39;absorption_delay&#39;</span><span class="p">,</span>
                      <span class="n">rank_type</span><span class="o">=</span><span class="s1">&#39;bic&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-1-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">res</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">run_modelsearch</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">start_model</span><span class="p">,</span>
<span class="w"> </span><span class="n">results</span><span class="o">=</span><span class="n">start_model_results</span><span class="p">,</span>
<span class="w"> </span><span class="n">search_space</span><span class="o">=</span><span class="s">&#39;ABSORPTION(c(FO,ZO));PERIPHERALS(c(0,1));LAGTIME(ON)&#39;</span><span class="p">,</span>
<span class="w"> </span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;reduced_stepwise&#39;</span><span class="p">,</span>
<span class="w"> </span><span class="n">iiv_strategy</span><span class="o">=</span><span class="s">&#39;absorption_delay&#39;</span><span class="p">,</span>
<span class="w"> </span><span class="n">rank_type</span><span class="o">=</span><span class="s">&#39;bic&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">summary_tool</span></code> table contains information such as which feature each model candidate has, the difference to the
start model (in this case comparing BIC), and final ranking:</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>description</th>
      <th>n_params</th>
      <th>d_params</th>
      <th>dbic</th>
      <th>bic</th>
      <th>rank</th>
      <th>parent_model</th>
    </tr>
    <tr>
      <th>model</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>base</th>
      <td>LAGTIME(ON)</td>
      <td>8</td>
      <td>0</td>
      <td>0.000000</td>
      <td>-1273.792080</td>
      <td>1.0</td>
      <td>base</td>
    </tr>
    <tr>
      <th>modelsearch_run2</th>
      <td>PERIPHERALS(1)</td>
      <td>11</td>
      <td>3</td>
      <td>-3.305500</td>
      <td>-1270.486580</td>
      <td>2.0</td>
      <td>base</td>
    </tr>
    <tr>
      <th>modelsearch_run1</th>
      <td>ABSORPTION(ZO)</td>
      <td>9</td>
      <td>1</td>
      <td>-9.452187</td>
      <td>-1264.339892</td>
      <td>3.0</td>
      <td>base</td>
    </tr>
    <tr>
      <th>modelsearch_run3</th>
      <td>ABSORPTION(ZO);PERIPHERALS(1)</td>
      <td>11</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>modelsearch_run1</td>
    </tr>
    <tr>
      <th>modelsearch_run4</th>
      <td>PERIPHERALS(1);ABSORPTION(ZO)</td>
      <td>11</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>modelsearch_run2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<p>To see information about the actual model runs, such as minimization status, estimation time, and parameter estimates,
you can look at the <code class="docutils literal notranslate"><span class="pre">summary_models</span></code> table. The table is generated with
<a class="reference internal" href="api/pharmpy.tools.summarize_modelfit_results.html#pharmpy.tools.summarize_modelfit_results" title="pharmpy.tools.summarize_modelfit_results"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.tools.summarize_modelfit_results()</span></code></a>.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>description</th>
      <th>minimization_successful</th>
      <th>errors_found</th>
      <th>warnings_found</th>
      <th>ofv</th>
      <th>runtime_total</th>
      <th>estimation_runtime</th>
      <th>POP_CL_estimate</th>
      <th>POP_CL_SE</th>
      <th>POP_CL_RSE</th>
      <th>...</th>
      <th>POP_MDT_RSE</th>
      <th>IIV_MDT_estimate</th>
      <th>IIV_MDT_SE</th>
      <th>IIV_MDT_RSE</th>
      <th>POP_QP1_estimate</th>
      <th>POP_QP1_SE</th>
      <th>POP_QP1_RSE</th>
      <th>POP_VP1_estimate</th>
      <th>POP_VP1_SE</th>
      <th>POP_VP1_RSE</th>
    </tr>
    <tr>
      <th>step</th>
      <th>model</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <th>input</th>
      <td></td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>-1292.186761</td>
      <td>4.0</td>
      <td>0.10</td>
      <td>24.5328</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">1</th>
      <th>base</th>
      <td>LAGTIME(ON)</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>-1313.362311</td>
      <td>6.0</td>
      <td>0.20</td>
      <td>24.2927</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>modelsearch_run1</th>
      <td>ABSORPTION(ZO)</td>
      <td>True</td>
      <td>0</td>
      <td>1</td>
      <td>-1305.577305</td>
      <td>8.0</td>
      <td>0.31</td>
      <td>24.1880</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000001</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>modelsearch_run2</th>
      <td>PERIPHERALS(1)</td>
      <td>True</td>
      <td>0</td>
      <td>1</td>
      <td>-1325.551467</td>
      <td>8.0</td>
      <td>0.67</td>
      <td>24.7779</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000001</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>96.4011</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>47.4555</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>modelsearch_run3</th>
      <td>ABSORPTION(ZO);PERIPHERALS(1)</td>
      <td>False</td>
      <td>2</td>
      <td>1</td>
      <td>-1308.965498</td>
      <td>9.0</td>
      <td>1.08</td>
      <td>24.2319</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000001</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1098.1900</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>77.8857</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>modelsearch_run4</th>
      <td>PERIPHERALS(1);ABSORPTION(ZO)</td>
      <td>False</td>
      <td>2</td>
      <td>0</td>
      <td>-1308.040354</td>
      <td>7.0</td>
      <td>0.96</td>
      <td>24.1760</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.011456</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>766.4720</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>56.9327</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>6 rows × 40 columns</p>
</div></div></div>
</div>
</div>
<p>Finally, you can see a summary of different errors and warnings in <code class="docutils literal notranslate"><span class="pre">summary_errors</span></code>.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.tools.summarize_errors()</span></code> for information on the content of this table.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>time</th>
      <th>message</th>
    </tr>
    <tr>
      <th>model</th>
      <th>category</th>
      <th>error_no</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>modelsearch_run1</th>
      <th>WARNING</th>
      <th>0</th>
      <td>2024-10-22 13:09:42.519</td>
      <td>PARAMETER ESTIMATE IS NEAR ITS BOUNDARY</td>
    </tr>
    <tr>
      <th>modelsearch_run2</th>
      <th>WARNING</th>
      <th>0</th>
      <td>2024-10-22 13:09:43.936</td>
      <td>PARAMETER ESTIMATE IS NEAR ITS BOUNDARY</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">modelsearch_run3</th>
      <th rowspan="2" valign="top">ERROR</th>
      <th>1</th>
      <td>2024-10-22 13:09:52.316</td>
      <td>MINIMIZATION TERMINATED\nDUE TO MAX. NO. OF FUNCTION EVALUATIONS EXCEEDED</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2024-10-22 13:09:52.316</td>
      <td>NO. OF SIG. DIGITS UNREPORTABLE</td>
    </tr>
    <tr>
      <th>WARNING</th>
      <th>0</th>
      <td>2024-10-22 13:09:52.316</td>
      <td>PARAMETER ESTIMATE IS NEAR ITS BOUNDARY</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">modelsearch_run4</th>
      <th rowspan="2" valign="top">ERROR</th>
      <th>0</th>
      <td>2024-10-22 13:09:53.750</td>
      <td>MINIMIZATION TERMINATED\nDUE TO MAX. NO. OF FUNCTION EVALUATIONS EXCEEDED</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2024-10-22 13:09:53.750</td>
      <td>NO. OF SIG. DIGITS UNREPORTABLE</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="amd_drug_metabolite.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">AMD - Drug metabolite</p>
      </div>
    </a>
    <a class="right-next"
       href="structsearch.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Structsearch</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running">Running</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#arguments">Arguments</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mandatory">Mandatory</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#optional">Optional</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-search-space">The search space</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorithms">Algorithms</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exhaustive-search">Exhaustive search</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exhaustive-stepwise-search">Exhaustive stepwise search</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reduced-stepwise-search">Reduced stepwise search</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#common-behaviours-between-algorithms">Common behaviours between algorithms</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-combination-exclusions">Feature combination exclusions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stepwise-addition-of-peripherals">Stepwise addition of peripherals</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-iiv-to-the-candidate-models-during-search">Adding IIV to the candidate models during search</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-and-ranking-candidates">Comparing and ranking candidates</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-modelsearch-results">The Modelsearch results</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2018-2026; the Pharmpy development team.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 9.0.4.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>