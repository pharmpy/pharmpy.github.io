
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Modelsearch &#8212; Pharmpy 0.73.0 documentation</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/thebelab-helper.js"></script>
    <script src="_static/tabs.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.0-rc.0/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="IIVsearch" href="iivsearch.html" />
    <link rel="prev" title="Automatic Model Development (AMD)" href="amd.html" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="None">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="index.html">
  
  
  
  
    <img src="_static/Pharmpy_logo.svg" class="logo__image only-light" alt="Logo image">
    <img src="_static/Pharmpy_logo.svg" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="contributors.html">
  About us
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="getting_started.html">
  Getting started
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="user_guide.html">
  User guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="api.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="changelog.html">
  Changelog
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="contribute.html">
  Contribute
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="citation.html">
  References and citation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="license.html">
  License
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
<h3><a href="index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="contributors.html">About us</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="user_guide.html">User guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="model.html">The Pharmpy model</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html">Datasets in Pharmpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="modeling.html">Modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="modelfit.html">Modelfit</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="psn_tools.html">PsN with Pharmpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="plots.html">Plots in Pharmpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="nonmem_plugin.html">Using the NONMEM plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli.html">The Pharmpy command line interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="using_r.html">Pharmpy in R</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="contribute.html">Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">References and citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#running">
   Running
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#arguments">
     Arguments
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-search-space">
   The search space
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#algorithms">
   Algorithms
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exhaustive-search">
     Exhaustive search
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exhaustive-stepwise-search">
     Exhaustive stepwise search
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#feature-combination-exclusions">
       Feature combination exclusions
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#reduced-stepwise-search">
     Reduced stepwise search
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#adding-iiv-to-the-candidate-models-during-search">
   Adding IIV to the candidate models during search
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#comparing-and-ranking-candidates">
   Comparing and ranking candidates
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-modelsearch-results">
   The Modelsearch results
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-feature-language-mfl-reference">
   Model feature language (MFL) reference
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#option-types">
     Option types
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-features">
     Model features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#describe-intervals">
     Describe intervals
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#redundant-descriptions">
     Redundant descriptions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#examples">
     Examples
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
    </div>
    
    <div class="toc-item">
      
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section id="modelsearch">
<span id="id1"></span><h1>Modelsearch<a class="headerlink" href="#modelsearch" title="Permalink to this headline">#</a></h1>
<p>The Modelsearch tool is a general tool to decide the best structural model given a base model and a search space of
model features. The tool supports different algorithms and selection criteria.</p>
<section id="running">
<h2>Running<a class="headerlink" href="#running" title="Permalink to this headline">#</a></h2>
<p>The modelsearch tool is available both in Pharmpy/pharmr and from the command line.</p>
<p>To initiate modelsearch in Python:</p>
<div class="pharmpy-snippet docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-0-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-0-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-0-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.tools</span> <span class="kn">import</span> <span class="n">run_modelsearch</span>

<span class="n">start_model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="s1">&#39;path/to/model&#39;</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">run_modelsearch</span><span class="p">(</span><span class="n">search_space</span><span class="o">=</span><span class="s1">&#39;ABSORPTION(ZO);PERIPHERALS(1)&#39;</span><span class="p">,</span>
                      <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;exhaustive&#39;</span><span class="p">,</span>
                      <span class="n">model</span><span class="o">=</span><span class="n">start_model</span><span class="p">,</span>
                      <span class="n">iiv_strategy</span><span class="o">=</span><span class="s1">&#39;no_add&#39;</span><span class="p">,</span>
                      <span class="n">rank_type</span><span class="o">=</span><span class="s1">&#39;bic&#39;</span><span class="p">,</span>
                      <span class="n">cutoff</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">start_model</span> <span class="o">&lt;-</span> <span class="nf">read_model</span><span class="p">(</span><span class="s">&#39;path/to/model&#39;</span><span class="p">)</span>
<span class="n">res</span> <span class="o">&lt;-</span> <span class="nf">run_modelsearch</span><span class="p">(</span><span class="n">search_space</span><span class="o">=</span><span class="s">&#39;ABSORPTION(ZO);PERIPHERALS(1)&#39;</span><span class="p">,</span>
                      <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;exhaustive&#39;</span><span class="p">,</span>
                      <span class="n">model</span><span class="o">=</span><span class="n">start_model</span><span class="p">,</span>
                      <span class="n">iiv_strategy</span><span class="o">=</span><span class="s">&#39;no_add&#39;</span><span class="p">,</span>
                      <span class="n">rank_type</span><span class="o">=</span><span class="s">&#39;bic&#39;</span><span class="p">,</span>
                      <span class="n">cutoff</span><span class="o">=</span><span class="kc">NULL</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
</div>
<p>This will take an input model <code class="docutils literal notranslate"><span class="pre">model</span></code> with <code class="docutils literal notranslate"><span class="pre">search_space</span></code> as the search space, meaning zero order absorption and adding one
peripheral compartment will be tried. The tool will use the <code class="docutils literal notranslate"><span class="pre">exhaustive</span></code> search algorithm. Structural IIVs will not be
added to candidates since <code class="docutils literal notranslate"><span class="pre">iiv_strategy</span></code> is set to be ‘no_add’. The candidate models will be ranked using <code class="docutils literal notranslate"><span class="pre">bic</span></code>
with default <code class="docutils literal notranslate"><span class="pre">cutoff</span></code>, which for BIC is none.</p>
<p>To run modelsearch from the command line, the example code is redefined accordingly:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pharmpy</span> <span class="n">run</span> <span class="n">modelsearch</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">model</span> <span class="s1">&#39;ABSORPTION(ZO);PERIPHERALS(1)&#39;</span> <span class="s1">&#39;exhaustive&#39;</span> <span class="o">--</span><span class="n">iiv_strategy</span> <span class="s1">&#39;no_add&#39;</span> <span class="o">--</span><span class="n">rank_type</span> <span class="s1">&#39;bic&#39;</span>
</pre></div>
</div>
<section id="arguments">
<h3>Arguments<a class="headerlink" href="#arguments" title="Permalink to this headline">#</a></h3>
<p>For a more detailed description of each argument, see their respective chapter on this page.</p>
<table class="table">
<colgroup>
<col style="width: 43%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#the-search-space"><span class="std std-ref">search_space</span></a></p></td>
<td><p>Search space to test</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#algorithms-modelsearch"><span class="std std-ref">algorithm</span></a></p></td>
<td><p>Algorithm to use (e.g. <code class="docutils literal notranslate"><span class="pre">'reduced_stepwise'</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ranking-modelsearch"><span class="std std-ref">rank_type</span></a></p></td>
<td><p>Which selection criteria to rank models on, e.g. OFV (default is
BIC)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ranking-modelsearch"><span class="std std-ref">cutoff</span></a></p></td>
<td><p>Cutoff for the ranking function, exclude models that are below
cutoff (default is none)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#iiv-strategies-modelsearch"><span class="std std-ref">iiv_strategy</span></a></p></td>
<td><p>If/how IIV should be added to candidate models (default is to
add to absorption delay parameters)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">model</span></code></p></td>
<td><p>Start model</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="the-search-space">
<span id="id2"></span><h2>The search space<a class="headerlink" href="#the-search-space" title="Permalink to this headline">#</a></h2>
<p>The model feature search space is a set of possible combinations of model features that will be applied and tested on
the input model. The supported features cover absorption, absorption delay, elimination, and distribution. The search
space is given as a string with a specific grammar, according to the <cite>Model Feature Language</cite> (MFL) (see detailed
description <a class="reference internal" href="#mfl"><span class="std std-ref">below</span></a>).</p>
</section>
<section id="algorithms">
<span id="algorithms-modelsearch"></span><h2>Algorithms<a class="headerlink" href="#algorithms" title="Permalink to this headline">#</a></h2>
<p>The tool can conduct the model search using different algorithms. The available algorithms can be seen in the table
below.</p>
<table class="table">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Algorithm</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'exhaustive'</span></code></p></td>
<td><p>All possible combinations of the search space are tested</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'exhaustive_stepwise'</span></code></p></td>
<td><p>Add one feature in each step in all possible orders</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'reduced_stepwise'</span></code></p></td>
<td><p>Add one feature in each step in all possible orders. After each feature layer, choose
best model between models with same features</p></td>
</tr>
</tbody>
</table>
<section id="exhaustive-search">
<h3>Exhaustive search<a class="headerlink" href="#exhaustive-search" title="Permalink to this headline">#</a></h3>
<p>An exhaustive search will test all possible combinations of features in one big run.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ABSORPTION</span><span class="p">(</span><span class="n">ZO</span><span class="p">)</span>
<span class="n">ELIMINATION</span><span class="p">(</span><span class="n">MM</span><span class="p">)</span>
<span class="n">PERIPHERALS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="graphviz"><object data="_images/graphviz-51fe4699f4085db21d55b791462c9eda40ba9f0b.svg" type="image/svg+xml" class="graphviz">
<p class="warning">digraph BST {
    node [fontname=&quot;Arial&quot;];
    base [label=&quot;Base model&quot;]
    s1 [label=&quot;ABSORPTION(ZO)&quot;]
    s2 [label=&quot;ELIMINATION(MM)&quot;]
    s3 [label=&quot;PERIPHERALS(1)&quot;]
    s4 [label=&quot;ABSORPTION(ZO);ELIMINATION(MM)&quot;]
    s5 [label=&quot;ABSORPTION(ZO);PERIPHERALS(1)&quot;]
    s6 [label=&quot;ELIMINATION(MM);PERIPHERALS(1)&quot;]
    s7 [label=&quot;ABSORPTION(ZO);ELIMINATION(MM);PERIPHERALS(1)&quot;]
    base -&gt; s1
    base -&gt; s2
    base -&gt; s3
    base -&gt; s4
    base -&gt; s5
    base -&gt; s6
    base -&gt; s7
}</p></object></div>
</section>
<section id="exhaustive-stepwise-search">
<h3>Exhaustive stepwise search<a class="headerlink" href="#exhaustive-stepwise-search" title="Permalink to this headline">#</a></h3>
<p>The exhaustive stepwise search applies features in a stepwise manner such that only one feature is changed at a time.</p>
<div class="graphviz"><object data="_images/graphviz-9f0c68b7dd33c3ef50a5fe3367ff7e1082f33457.svg" type="image/svg+xml" class="graphviz">
<p class="warning">digraph BST {
    node [fontname=&quot;Arial&quot;];
    base [label=&quot;Base model&quot;]
    s1 [label=&quot;ABSORPTION(ZO)&quot;]
    s2 [label=&quot;ELIMINATION(MM)&quot;]
    s3 [label=&quot;PERIPHERALS(1)&quot;]
    s4 [label=&quot;ELIMINATION(MM)&quot;]
    s5 [label=&quot;PERIPHERALS(1)&quot;]
    s6 [label=&quot;ABSORPTION(ZO)&quot;]
    s7 [label=&quot;PERIPHERALS(1)&quot;]
    s8 [label=&quot;ABSORPTION(ZO)&quot;]
    s9 [label=&quot;ELIMINATION(MM)&quot;]
    s10 [label=&quot;PERIPHERALS(1)&quot;]
    s11 [label=&quot;ELIMINATION(MM)&quot;]
    s12 [label=&quot;PERIPHERALS(1)&quot;]
    s13 [label=&quot;ABSORPTION(ZO)&quot;]
    s14 [label=&quot;ELIMINATION(MM)&quot;]
    s15 [label=&quot;ABSORPTION(ZO)&quot;]
    base -&gt; s1
    base -&gt; s2
    base -&gt; s3
    s1 -&gt; s4
    s1 -&gt; s5
    s2 -&gt; s6
    s2 -&gt; s7
    s3 -&gt; s8
    s3 -&gt; s9
    s4 -&gt; s10
    s5 -&gt; s11
    s6 -&gt; s12
    s7 -&gt; s13
    s8 -&gt; s14
    s9 -&gt; s15
}</p></object></div>
<section id="feature-combination-exclusions">
<span id="id3"></span><h4>Feature combination exclusions<a class="headerlink" href="#feature-combination-exclusions" title="Permalink to this headline">#</a></h4>
<p>Some combinations of features have been excluded in this algorithm, the following combinations are never run:</p>
<table class="table">
<colgroup>
<col style="width: 55%" />
<col style="width: 45%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Feature A</p></th>
<th class="head"><p>Feature B</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ABSORPTION(ZO)</p></td>
<td><p>TRANSITS</p></td>
</tr>
<tr class="row-odd"><td><p>ABSORPTION(SEQ-ZO-FO)</p></td>
<td><p>TRANSITS</p></td>
</tr>
<tr class="row-even"><td><p>ABSORPTION(SEQ-ZO-FO)</p></td>
<td><p>LAGTIME</p></td>
</tr>
<tr class="row-odd"><td><p>LAGTIME</p></td>
<td><p>TRANSITS</p></td>
</tr>
</tbody>
</table>
<p>Additionally, peripheral compartments are always run sequentially, i.e. the algorithm will never add more than one
compartment at a given step. This is done in order to allow for better initial estimates from previous peripherals.</p>
</section>
</section>
<section id="reduced-stepwise-search">
<h3>Reduced stepwise search<a class="headerlink" href="#reduced-stepwise-search" title="Permalink to this headline">#</a></h3>
<p>The reduced stepwise is similar to the exhaustive stepwise search, but after each layer it compares models with
the same features, where the compared models arrived at the features in a different order. Next, the algorithm sends
the best model from each comparison to the next layer, where the subsequent feature is added.</p>
<div class="graphviz"><object data="_images/graphviz-e68661644f35421e241c0ecb70a7a1a411e0ccc3.svg" type="image/svg+xml" class="graphviz">
<p class="warning">digraph BST {
    node [fontname=&quot;Arial&quot;];
    base [label=&quot;Base model&quot;]
    s1 [label=&quot;ABSORPTION(ZO)&quot;]
    s2 [label=&quot;ELIMINATION(MM)&quot;]
    s3 [label=&quot;PERIPHERALS(1)&quot;]
    s4 [label=&quot;ELIMINATION(MM)&quot;]
    s5 [label=&quot;PERIPHERALS(1)&quot;]
    s6 [label=&quot;ABSORPTION(ZO)&quot;]
    s7 [label=&quot;PERIPHERALS(1)&quot;]
    s8 [label=&quot;ABSORPTION(ZO)&quot;]
    s9 [label=&quot;ELIMINATION(MM)&quot;]
    s10 [label=&quot;Best model&quot;]
    s11 [label=&quot;Best model&quot;]
    s12 [label=&quot;Best model&quot;]
    s13 [label=&quot;PERIPHERALS(1)&quot;]
    s14 [label=&quot;ELIMINATION(MM)&quot;]
    s15 [label=&quot;ABSORPTION(ZO)&quot;]
    base -&gt; s1
    base -&gt; s2
    base -&gt; s3
    s1 -&gt; s4
    s1 -&gt; s5
    s2 -&gt; s6
    s2 -&gt; s7
    s3 -&gt; s8
    s3 -&gt; s9
    s4 -&gt; s10
    s6 -&gt; s10
    s5 -&gt; s11
    s8 -&gt; s11
    s7 -&gt; s12
    s9 -&gt; s12
    s10 -&gt; s13
    s11 -&gt; s14
    s12 -&gt; s15
}</p></object></div>
<p>The same feature combinations as in the exhaustive stepwise algorithm will be excluded (described
<a class="reference internal" href="#feature-combination-exclusions"><span class="std std-ref">here</span></a>)</p>
</section>
</section>
<section id="adding-iiv-to-the-candidate-models-during-search">
<span id="iiv-strategies-modelsearch"></span><h2>Adding IIV to the candidate models during search<a class="headerlink" href="#adding-iiv-to-the-candidate-models-during-search" title="Permalink to this headline">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">iiv_strategy</span></code> option determines whether or not IIV on the PK parameters should be added to the candidate models.
The different strategies can be seen here:</p>
<table class="table">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Strategy</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'no_add'</span></code></p></td>
<td><p>No IIVs are added during the search</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'add_diagonal'</span></code></p></td>
<td><p>IIV is added to all structural parameters as diagonal</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'fullblock'</span></code></p></td>
<td><p>IIV is added to all structural parameters, and all IIVs will be in a full block</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'absorption_delay'</span></code></p></td>
<td><p>IIV is added to the absorption delay parameter (default)</p></td>
</tr>
</tbody>
</table>
</section>
<section id="comparing-and-ranking-candidates">
<span id="ranking-modelsearch"></span><h2>Comparing and ranking candidates<a class="headerlink" href="#comparing-and-ranking-candidates" title="Permalink to this headline">#</a></h2>
<p>The supplied <code class="docutils literal notranslate"><span class="pre">rank_type</span></code> will be used to compare a set of candidate models and rank them. A cutoff may also be provided
if the user does not want to use the default. The following rank functions are available:</p>
<table class="table">
<colgroup>
<col style="width: 13%" />
<col style="width: 87%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Rank type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'ofv'</span></code></p></td>
<td><p>ΔOFV. Default is to not rank candidates with ΔOFV &lt; cutoff (default 3.84)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'aic'</span></code></p></td>
<td><p>ΔAIC. Default is to rank all candidates if no cutoff is provided.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'bic'</span></code></p></td>
<td><p>ΔBIC (mixed). Default is to rank all candidates if no cutoff is provided.</p></td>
</tr>
</tbody>
</table>
<p>Information about how BIC is calculated can be found in <a class="reference internal" href="api/pharmpy.modeling.calculate_bic.html#pharmpy.modeling.calculate_bic" title="pharmpy.modeling.calculate_bic"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.calculate_bic()</span></code></a>.</p>
</section>
<section id="the-modelsearch-results">
<h2>The Modelsearch results<a class="headerlink" href="#the-modelsearch-results" title="Permalink to this headline">#</a></h2>
<p>The results object contains the candidate models, the start model, and the selected best model (based on the input
selection criteria). The tool also creates various summary tables which can be accessed in the results object,
as well as files in .csv/.json format.</p>
<p>Consider a modelsearch run with the search space of zero order absorption and adding one peripheral compartment:</p>
<div class="pharmpy-snippet docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-1-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-1-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-1-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">run_modelsearch</span><span class="p">(</span><span class="s1">&#39;ABSORPTION(ZO);PERIPHERALS(1)&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;exhaustive&#39;</span><span class="p">,</span>
                      <span class="n">model</span><span class="o">=</span><span class="n">start_model</span><span class="p">,</span>
                      <span class="n">iiv_strategy</span><span class="o">=</span><span class="s1">&#39;no_add&#39;</span><span class="p">,</span>
                      <span class="n">rank_type</span><span class="o">=</span><span class="s1">&#39;bic&#39;</span><span class="p">,</span>
                      <span class="n">cutoff</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-1-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">&lt;-</span> <span class="nf">run_modelsearch</span><span class="p">(</span><span class="s">&#39;ABSORPTION(ZO);PERIPHERALS(1)&#39;</span><span class="p">,</span>
                      <span class="s">&#39;exhaustive&#39;</span><span class="p">,</span>
                      <span class="n">model</span><span class="o">=</span><span class="n">start_model</span><span class="p">,</span>
                      <span class="n">iiv_strategy</span><span class="o">=</span><span class="s">&#39;no_add&#39;</span><span class="p">,</span>
                      <span class="n">rank_type</span><span class="o">=</span><span class="s">&#39;bic&#39;</span><span class="p">,</span>
                      <span class="n">cutoff</span><span class="o">=</span><span class="kc">NULL</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">summary_tool</span></code> table contains information such as which feature each model candidate has, the difference to the
start model (in this case comparing BIC), and final ranking:</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>description</th>
      <th>dbic</th>
      <th>bic</th>
      <th>rank</th>
      <th>parent_model</th>
    </tr>
    <tr>
      <th>model</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>modelsearch_candidate1</th>
      <td>ABSORPTION(ZO)</td>
      <td>12.358005</td>
      <td>-1271.888272</td>
      <td>1</td>
      <td>mox2</td>
    </tr>
    <tr>
      <th>modelsearch_candidate2</th>
      <td>PERIPHERALS(1)</td>
      <td>1.287000</td>
      <td>-1260.817266</td>
      <td>2</td>
      <td>mox2</td>
    </tr>
    <tr>
      <th>mox2</th>
      <td></td>
      <td>0.000000</td>
      <td>-1259.530267</td>
      <td>3</td>
      <td>mox2</td>
    </tr>
    <tr>
      <th>modelsearch_candidate3</th>
      <td>ABSORPTION(ZO);PERIPHERALS(1)</td>
      <td>-1.412981</td>
      <td>-1258.117286</td>
      <td>4</td>
      <td>modelsearch_candidate1</td>
    </tr>
    <tr>
      <th>modelsearch_candidate4</th>
      <td>PERIPHERALS(1);ABSORPTION(ZO)</td>
      <td>-14.816164</td>
      <td>-1244.714103</td>
      <td>5</td>
      <td>modelsearch_candidate2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<p>To see information about the actual model runs, such as minimization status, estimation time, and parameter estimates,
you can look at the <code class="docutils literal notranslate"><span class="pre">summary_models</span></code> table. The table is generated with
<a class="reference internal" href="api/pharmpy.modeling.summarize_modelfit_results.html#pharmpy.modeling.summarize_modelfit_results" title="pharmpy.modeling.summarize_modelfit_results"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.summarize_modelfit_results()</span></code></a>.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>description</th>
      <th>minimization_successful</th>
      <th>errors_found</th>
      <th>warnings_found</th>
      <th>ofv</th>
      <th>aic</th>
      <th>bic</th>
      <th>runtime_total</th>
      <th>estimation_runtime</th>
      <th>THETA(1)_estimate</th>
      <th>THETA(2)_estimate</th>
      <th>THETA(3)_estimate</th>
      <th>OMEGA(1,1)_estimate</th>
      <th>OMEGA(2,2)_estimate</th>
      <th>OMEGA(3,3)_estimate</th>
      <th>SIGMA(1,1)_estimate</th>
      <th>POP_QP1_estimate</th>
      <th>POP_VP1_estimate</th>
    </tr>
    <tr>
      <th>model</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>modelsearch_candidate1</th>
      <td>ABSORPTION(ZO)</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>-1304.544766</td>
      <td>-1290.544766</td>
      <td>-1271.888272</td>
      <td>5.0</td>
      <td>0.12</td>
      <td>24.1501</td>
      <td>109.97000</td>
      <td>0.351310</td>
      <td>0.468718</td>
      <td>0.596694</td>
      <td>0.110254</td>
      <td>0.196077</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>modelsearch_candidate2</th>
      <td>PERIPHERALS(1)</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>-1307.301235</td>
      <td>-1289.301235</td>
      <td>-1260.817266</td>
      <td>6.0</td>
      <td>0.34</td>
      <td>24.0058</td>
      <td>59.11470</td>
      <td>0.842498</td>
      <td>0.470531</td>
      <td>1.515250</td>
      <td>0.205369</td>
      <td>0.193439</td>
      <td>47.8042</td>
      <td>33.8517</td>
    </tr>
    <tr>
      <th>mox2</th>
      <td></td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>-1292.186761</td>
      <td>-1278.186761</td>
      <td>-1259.530267</td>
      <td>4.0</td>
      <td>0.10</td>
      <td>24.5328</td>
      <td>104.23000</td>
      <td>0.433676</td>
      <td>0.481858</td>
      <td>0.593654</td>
      <td>0.000130</td>
      <td>0.209972</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>modelsearch_candidate3</th>
      <td>ABSORPTION(ZO);PERIPHERALS(1)</td>
      <td>False</td>
      <td>1</td>
      <td>0</td>
      <td>-1304.601254</td>
      <td>-1286.601254</td>
      <td>-1258.117286</td>
      <td>6.0</td>
      <td>0.57</td>
      <td>24.1175</td>
      <td>90.74990</td>
      <td>0.355113</td>
      <td>0.467946</td>
      <td>0.871991</td>
      <td>0.109912</td>
      <td>0.195516</td>
      <td>909.6020</td>
      <td>19.0192</td>
    </tr>
    <tr>
      <th>modelsearch_candidate4</th>
      <td>PERIPHERALS(1);ABSORPTION(ZO)</td>
      <td>True</td>
      <td>0</td>
      <td>1</td>
      <td>-1291.198072</td>
      <td>-1273.198072</td>
      <td>-1244.714103</td>
      <td>5.0</td>
      <td>0.51</td>
      <td>24.3375</td>
      <td>6.58965</td>
      <td>0.705451</td>
      <td>0.508471</td>
      <td>153.166000</td>
      <td>0.000021</td>
      <td>0.208527</td>
      <td>292.8450</td>
      <td>91.7023</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<p>A summary table of predicted influential individuals and outliers can be seen in <code class="docutils literal notranslate"><span class="pre">summary_individuals_count</span></code>.
See <a class="reference internal" href="api/pharmpy.modeling.summarize_individuals_count_table.html#pharmpy.modeling.summarize_individuals_count_table" title="pharmpy.modeling.summarize_individuals_count_table"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.summarize_individuals_count_table()</span></code></a> for information on the content of this table.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>description</th>
      <th>dbic</th>
      <th>inf_selection</th>
      <th>inf_params</th>
      <th>out_obs</th>
      <th>out_ind</th>
      <th>inf_outlier</th>
      <th>parent_model</th>
    </tr>
    <tr>
      <th>model</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>modelsearch_candidate1</th>
      <td>ABSORPTION(ZO)</td>
      <td>12.358005</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>6</td>
      <td>2</td>
      <td>mox2</td>
    </tr>
    <tr>
      <th>modelsearch_candidate2</th>
      <td>PERIPHERALS(1)</td>
      <td>1.287000</td>
      <td>0</td>
      <td>2</td>
      <td>4</td>
      <td>7</td>
      <td>2</td>
      <td>mox2</td>
    </tr>
    <tr>
      <th>mox2</th>
      <td></td>
      <td>0.000000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>mox2</td>
    </tr>
    <tr>
      <th>modelsearch_candidate3</th>
      <td>ABSORPTION(ZO);PERIPHERALS(1)</td>
      <td>-1.412981</td>
      <td>0</td>
      <td>2</td>
      <td>3</td>
      <td>6</td>
      <td>2</td>
      <td>modelsearch_candidate1</td>
    </tr>
    <tr>
      <th>modelsearch_candidate4</th>
      <td>PERIPHERALS(1);ABSORPTION(ZO)</td>
      <td>-14.816164</td>
      <td>1</td>
      <td>2</td>
      <td>4</td>
      <td>7</td>
      <td>3</td>
      <td>modelsearch_candidate2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<p>You can see different individual statistics in <code class="docutils literal notranslate"><span class="pre">summary_individuals</span></code>.
See <a class="reference internal" href="api/pharmpy.modeling.summarize_individuals.html#pharmpy.modeling.summarize_individuals" title="pharmpy.modeling.summarize_individuals"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.summarize_individuals()</span></code></a> for information on the content of this table.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>description</th>
      <th>parent_model</th>
      <th>outlier_count</th>
      <th>ofv</th>
      <th>dofv_vs_parent</th>
      <th>predicted_dofv</th>
      <th>predicted_residual</th>
    </tr>
    <tr>
      <th>model</th>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">mox2</th>
      <th>110</th>
      <td></td>
      <td>mox2</td>
      <td>NaN</td>
      <td>-27.757118</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>112</th>
      <td></td>
      <td>mox2</td>
      <td>NaN</td>
      <td>-23.659694</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>113</th>
      <td></td>
      <td>mox2</td>
      <td>NaN</td>
      <td>-36.302503</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>121</th>
      <td></td>
      <td>mox2</td>
      <td>NaN</td>
      <td>-30.464327</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>123</th>
      <td></td>
      <td>mox2</td>
      <td>NaN</td>
      <td>-17.034898</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">modelsearch_candidate4</th>
      <th>1403</th>
      <td>PERIPHERALS(1);ABSORPTION(ZO)</td>
      <td>modelsearch_candidate2</td>
      <td>0.0</td>
      <td>-12.630023</td>
      <td>-0.269632</td>
      <td>0.047723</td>
      <td>-0.576271</td>
    </tr>
    <tr>
      <th>1404</th>
      <td>PERIPHERALS(1);ABSORPTION(ZO)</td>
      <td>modelsearch_candidate2</td>
      <td>0.0</td>
      <td>-5.196162</td>
      <td>-0.695671</td>
      <td>0.275380</td>
      <td>1.888974</td>
    </tr>
    <tr>
      <th>1405</th>
      <td>PERIPHERALS(1);ABSORPTION(ZO)</td>
      <td>modelsearch_candidate2</td>
      <td>0.0</td>
      <td>-17.067826</td>
      <td>-0.132794</td>
      <td>0.084833</td>
      <td>-1.383862</td>
    </tr>
    <tr>
      <th>1406</th>
      <td>PERIPHERALS(1);ABSORPTION(ZO)</td>
      <td>modelsearch_candidate2</td>
      <td>0.0</td>
      <td>-25.747055</td>
      <td>0.581076</td>
      <td>0.080576</td>
      <td>-1.157451</td>
    </tr>
    <tr>
      <th>1407</th>
      <td>PERIPHERALS(1);ABSORPTION(ZO)</td>
      <td>modelsearch_candidate2</td>
      <td>0.0</td>
      <td>-10.124556</td>
      <td>1.656722</td>
      <td>0.465091</td>
      <td>2.149472</td>
    </tr>
  </tbody>
</table>
<p>365 rows × 7 columns</p>
</div></div></div>
</div>
</div>
<p>Finally, you can see a summary of different errors and warnings in <code class="docutils literal notranslate"><span class="pre">summary_errors</span></code>.
See <a class="reference internal" href="api/pharmpy.modeling.summarize_errors.html#pharmpy.modeling.summarize_errors" title="pharmpy.modeling.summarize_errors"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.modeling.summarize_errors()</span></code></a> for information on the content of this table.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>time</th>
      <th>message</th>
    </tr>
    <tr>
      <th>model</th>
      <th>category</th>
      <th>error_no</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>modelsearch_candidate3</th>
      <th>ERROR</th>
      <th>0</th>
      <td>2022-06-14 15:27:40.102</td>
      <td>MINIMIZATION TERMINATED\n DUE TO MAX. NO. OF FUNCTION EVALUATIONS EXCEEDED</td>
    </tr>
    <tr>
      <th>modelsearch_candidate4</th>
      <th>WARNING</th>
      <th>0</th>
      <td>2022-06-14 15:27:40.102</td>
      <td>PARAMETER ESTIMATE IS NEAR ITS BOUNDARY\n THIS MUST BE ADDRESSED BEFORE THE COVARIANCE STEP CAN BE IMPLEMENTED</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</section>
<section id="model-feature-language-mfl-reference">
<span id="mfl"></span><h2>Model feature language (MFL) reference<a class="headerlink" href="#model-feature-language-mfl-reference" title="Permalink to this headline">#</a></h2>
<p>The <cite>MFL</cite> is a domain specific language designed to describe model features and sets of model features in a concise way.
It can be used to describe model features for one single model or an entire space of model features, i.e. descriptions
for multiple models. The basic building block of MFL is the feature description. A feature description consists of the
name of a feature category followed by a comma separated list of arguments within parentheses. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ABSORPTION</span><span class="p">(</span><span class="n">FO</span><span class="p">)</span>
</pre></div>
</div>
<p>Each feature description describes one or multiple features of the same category, i.e. absorption, absorption delay,
elimination, and distribution. Features of the same category are mutually exclusive and cannot be applied to the same
model. Multiple model feature descriptions can be combined by separating them with either newline or a semi-colon.</p>
<p>The following two examples are equivalent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ABSORPTION</span><span class="p">(</span><span class="n">FO</span><span class="p">);</span><span class="n">ELIMINATION</span><span class="p">(</span><span class="n">ZO</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ABSORPTION</span><span class="p">(</span><span class="n">FO</span><span class="p">)</span>
<span class="n">ELIMINATION</span><span class="p">(</span><span class="n">ZO</span><span class="p">)</span>
</pre></div>
</div>
<section id="option-types">
<h3>Option types<a class="headerlink" href="#option-types" title="Permalink to this headline">#</a></h3>
<p>MFL support the following types of options to feature descriptions:</p>
<table class="table">
<colgroup>
<col style="width: 17%" />
<col style="width: 20%" />
<col style="width: 63%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>token or name</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">FO</span></code></p></td>
<td><p>The name of a feature within a category</p></td>
</tr>
<tr class="row-odd"><td><p>number</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">1</span></code></p></td>
<td><p>A non-negative integer</p></td>
</tr>
<tr class="row-even"><td><p>range</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">0..2</span></code></p></td>
<td><p>A range of numbers (endpoints are included)</p></td>
</tr>
<tr class="row-odd"><td><p>wildcard</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">*</span></code></p></td>
<td><p>All features of a category</p></td>
</tr>
<tr class="row-even"><td><p>array</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">[FO,</span> <span class="pre">ZO]</span></code></p></td>
<td><p>Multiple tokens or numbers</p></td>
</tr>
</tbody>
</table>
</section>
<section id="model-features">
<h3>Model features<a class="headerlink" href="#model-features" title="Permalink to this headline">#</a></h3>
<p>MFL support the following model features:</p>
<table class="table">
<colgroup>
<col style="width: 13%" />
<col style="width: 27%" />
<col style="width: 60%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Category</p></th>
<th class="head"><p>Options</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ABSORPTION</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">FO,</span> <span class="pre">ZO,</span> <span class="pre">SEQ-ZO-FO</span></code></p></td>
<td><p>Absorption rate</p></td>
</tr>
<tr class="row-odd"><td><p>ELIMINATION</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">FO,</span> <span class="pre">ZO,</span> <span class="pre">MM,</span> <span class="pre">MIX-FO-MM</span></code></p></td>
<td><p>Elimination rate</p></td>
</tr>
<tr class="row-even"><td><p>PERIPHERALS</p></td>
<td><p><cite>number</cite></p></td>
<td><p>Number of peripheral compartments</p></td>
</tr>
<tr class="row-odd"><td><p>TRANSITS</p></td>
<td><p><cite>number</cite>, DEPOT/NODEPOT</p></td>
<td><p>Number of absorption transit compartments. Whether convert depot
compartment into a transit compartment</p></td>
</tr>
<tr class="row-even"><td><p>LAGTIME</p></td>
<td><p>None</p></td>
<td><p>Absorption lagtime</p></td>
</tr>
</tbody>
</table>
</section>
<section id="describe-intervals">
<h3>Describe intervals<a class="headerlink" href="#describe-intervals" title="Permalink to this headline">#</a></h3>
<p>It is possible to use ranges and arrays to describe the search space for e.g. transit and peripheral compartments.</p>
<p>To add 1, 2 and 3 peripheral compartments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PERIPHERALS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">PERIPHERALS</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">PERIPHERALS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>This is equivalent to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PERIPHERALS</span><span class="p">(</span><span class="mf">1..3</span><span class="p">)</span>
</pre></div>
</div>
<p>As well as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PERIPHERALS</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="redundant-descriptions">
<h3>Redundant descriptions<a class="headerlink" href="#redundant-descriptions" title="Permalink to this headline">#</a></h3>
<p>It is allowed to describe the same feature multiple times, however, this will not make any difference for which
features are described.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ABSORPTION</span><span class="p">(</span><span class="n">FO</span><span class="p">)</span>
<span class="n">ABSORPTION</span><span class="p">([</span><span class="n">FO</span><span class="p">,</span> <span class="n">ZO</span><span class="p">])</span>
</pre></div>
</div>
<p>This is equivalent to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ABSORPTION</span><span class="p">([</span><span class="n">FO</span><span class="p">,</span> <span class="n">ZO</span><span class="p">])</span>
</pre></div>
</div>
<p>And:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PERIPHERALS</span><span class="p">(</span><span class="mf">1..2</span><span class="p">)</span>
<span class="n">PERIPHERALS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Is equivalent to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PERIPHERALS</span><span class="p">(</span><span class="mf">1..2</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">#</a></h3>
<p>An example of a search space for PK models with oral data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ABSORPTION</span><span class="p">([</span><span class="n">ZO</span><span class="p">,</span><span class="n">SEQ</span><span class="o">-</span><span class="n">ZO</span><span class="o">-</span><span class="n">FO</span><span class="p">])</span>
<span class="n">ELIMINATION</span><span class="p">([</span><span class="n">MM</span><span class="p">,</span><span class="n">MIX</span><span class="o">-</span><span class="n">FO</span><span class="o">-</span><span class="n">MM</span><span class="p">])</span>
<span class="n">LAGTIME</span><span class="p">()</span>
<span class="n">TRANSITS</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span><span class="o">*</span><span class="p">)</span>
<span class="n">PERIPHERALS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>An example of a search space for PK models with IV data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ELIMINATION</span><span class="p">([</span><span class="n">MM</span><span class="p">,</span><span class="n">MIX</span><span class="o">-</span><span class="n">FO</span><span class="o">-</span><span class="n">MM</span><span class="p">])</span>
<span class="n">PERIPHERALS</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>Search through all available absorption rates:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ABSORPTION</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
</pre></div>
</div>
<p>Allow all combinations of absorption and elimination rates:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ABSORPTION</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<span class="n">ELIMINATION</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>


              </article>
              

              
              <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="amd.html" title="previous page">
      <i class="fas fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">Automatic Model Development (AMD)</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="iivsearch.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">IIVsearch</p>
  </div>
  <i class="fas fa-angle-right"></i>
  </a>
</div>
              </footer>
              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright 2018-2022; the Pharmpy development team.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>