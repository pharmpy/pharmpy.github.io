
<!DOCTYPE html>


<html lang="en" data-content_root="./" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>ruvsearch &#8212; Pharmpy 1.6.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=34bb78ad" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css?v=a5c4661c" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=63439bfe" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=72d88caf"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script src="_static/tabs.js?v=3030b3cb"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ruvsearch';</script>
    <link rel="icon" href="_static/Pharmpy_symbol.svg"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="allometry" href="allometry.html" />
    <link rel="prev" title="COVsearch" href="covsearch.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="1.6.0" />
    <meta name="docbuild:last-update" content="Feb 10, 2025"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
    
    <img src="_static/Pharmpy_logo.svg" class="logo__image only-light" alt="Pharmpy 1.6.0 documentation - Home"/>
    <img src="_static/Pharmpy_logo_dark.svg" class="logo__image only-dark pst-js-only" alt="Pharmpy 1.6.0 documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="contributors.html">
    About us
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="getting_started.html">
    Getting started
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="user_guide.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="api.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="changelog.html">
    Changelog
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="contribute.html">
    Contribute
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="citation.html">
    References and citation
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="license.html">
    License
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="developers.html">
    Documentation for developers
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pharmpy/pharmpy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pharmpy/pharmpy/issues" title="Report issues" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa fa-comments fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Report issues</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="contributors.html">
    About us
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="getting_started.html">
    Getting started
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="user_guide.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="api.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="changelog.html">
    Changelog
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="contribute.html">
    Contribute
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="citation.html">
    References and citation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="license.html">
    License
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="developers.html">
    Documentation for developers
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pharmpy/pharmpy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pharmpy/pharmpy/issues" title="Report issues" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa fa-comments fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Report issues</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="tools.html">Tools</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="general.html">General</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="common_features.html">Common features</a></li>
<li class="toctree-l3"><a class="reference internal" href="mfl.html">Model Feature Language (MFL)</a></li>
<li class="toctree-l3"><a class="reference internal" href="strictness.html">Strictness</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="amd.html">AMD - automatic model development</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="amd_pk.html">PK</a></li>
<li class="toctree-l3"><a class="reference internal" href="amd_pkpd.html">PKPD</a></li>
<li class="toctree-l3"><a class="reference internal" href="amd_tmdd.html">TMDD</a></li>
<li class="toctree-l3"><a class="reference internal" href="amd_drug_metabolite.html">Drug Metabolite</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="modelsearch.html">Modelsearch - search for best structural model for a PK model</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="structsearch.html">Structsearch - search for best structural model for PKPD, drug metabolite and TMDD models</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="pkpd.html">PKPD</a></li>
<li class="toctree-l3"><a class="reference internal" href="tmdd.html">TMDD</a></li>
<li class="toctree-l3"><a class="reference internal" href="drug_metabolite.html">Drug Metabolite</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="iivsearch.html">IIVsearch - search for best IIV structure (both variance and covariance)</a></li>
<li class="toctree-l2"><a class="reference internal" href="iovsearch.html">IOVsearch - search for best IOV structure and trim IIV</a></li>
<li class="toctree-l2"><a class="reference internal" href="covsearch.html">COVsearch - identify covariates that explain some of the IIV</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">RUVsearch - search for best residual error model</a></li>
<li class="toctree-l2"><a class="reference internal" href="allometry.html">allometry - add allometric scaling</a></li>
<li class="toctree-l2"><a class="reference internal" href="estmethod.html">estmethod - compare estimation methods and/or solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="retries.html">Retries - Rerun a model with tweaked initial estimates</a></li>
<li class="toctree-l2"><a class="reference internal" href="simulation.html">Simulation - Run a simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="linearize_tool.html">Linearize - Linearize a model</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="modelfit.html">Model estimation and results</a></li>
<li class="toctree-l1"><a class="reference internal" href="modeling.html">Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">The Pharmpy model</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_r.html">Pharmpy in R</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command line interface</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="psn_tools.html">PsN with Pharmpy</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="bootstrap.html">Bootstrap</a></li>
<li class="toctree-l2"><a class="reference internal" href="cdd.html">Case deletion diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="crossval.html">Crossval</a></li>
<li class="toctree-l2"><a class="reference internal" href="frem.html">FREM</a></li>
<li class="toctree-l2"><a class="reference internal" href="linearize.html">Linearize</a></li>
<li class="toctree-l2"><a class="reference internal" href="qa.html">QA</a></li>
<li class="toctree-l2"><a class="reference internal" href="psn_resmod.html">resmod</a></li>
<li class="toctree-l2"><a class="reference internal" href="scm.html">scm</a></li>
<li class="toctree-l2"><a class="reference internal" href="simeval.html">Simeval</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="user_guide.html" class="nav-link">User guide</a></li>
    
    
    <li class="breadcrumb-item"><a href="tools.html" class="nav-link">Tools</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">ruvsearch</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="ruvsearch">
<span id="id1"></span><h1>ruvsearch<a class="headerlink" href="#ruvsearch" title="Link to this heading">#</a></h1>
<p>The RUVsearch tool is a general tool to decide the best residual error model given a start model.</p>
<section id="running">
<h2>Running<a class="headerlink" href="#running" title="Link to this heading">#</a></h2>
<p>The RUVsearch tool is available both in Pharmpy/pharmr and from the command line.</p>
<p>To initiate RUVsearch in Python/R:</p>
<div class="pharmpy-snippet docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-0-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-0-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-0-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pharmpy.modeling</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_model</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pharmpy.tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_modelfit_results</span><span class="p">,</span> <span class="n">run_ruvsearch</span>

<span class="n">start_model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="s1">&#39;path/to/model&#39;</span><span class="p">)</span>
<span class="n">start_model_results</span> <span class="o">=</span> <span class="n">read_modelfit_results</span><span class="p">(</span><span class="s1">&#39;path/to/model&#39;</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">run_ruvsearch</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">start_model</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">start_model_results</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">start_model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_model</span><span class="p">(</span><span class="s">&#39;path/to/model&#39;</span><span class="p">)</span>
<span class="n">start_model_results</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_modelfit_results</span><span class="p">(</span><span class="s">&#39;path/to/model&#39;</span><span class="p">)</span>
<span class="n">res</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">run_ruvsearch</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">start_model</span><span class="p">,</span><span class="w"> </span><span class="n">results</span><span class="o">=</span><span class="n">start_model_results</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
</div>
<p>To run RUVsearch from the command line, the example code is redefined accordingly:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pharmpy</span> <span class="n">run</span> <span class="n">ruvsearch</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">model</span>
</pre></div>
</div>
</section>
<section id="arguments">
<h2>Arguments<a class="headerlink" href="#arguments" title="Link to this heading">#</a></h2>
<section id="mandatory">
<h3>Mandatory<a class="headerlink" href="#mandatory" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">model</span></code></p></td>
<td><p>Start model</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">results</span></code></p></td>
<td><p>ModelfitResults for the start model</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="optional">
<h3>Optional<a class="headerlink" href="#optional" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">groups</span></code></p></td>
<td><p>Number of groups to use for the time varying model (default is 4) Warning: There is currently a bug causing all values other than 4 to either crash the tool or give the wrong final model in some cases.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">p_value</span></code></p></td>
<td><p>p-value for model selection (default is 0.001)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">skip</span></code></p></td>
<td><p>List of residual error models to not consider</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">strictness</span></code></p></td>
<td><p><a class="reference internal" href="strictness.html#strictness"><span class="std std-ref">Strictness</span></a> criteria for model selection.
Default is “minimization_successful or
(rounding_errors and sigdigs&gt;= 0.1)”</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="models">
<h2>Models<a class="headerlink" href="#models" title="Link to this heading">#</a></h2>
<p>The various residual error models tested by <cite>RUVsearch</cite> can be found in the table below together with links to detailed documentation of the
functions used to create them.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Model name</p></th>
<th class="head"><p>Function</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">IIV_on_RUV</span></code></p></td>
<td><p><a class="reference internal" href="api/pharmpy.modeling.set_iiv_on_ruv.html#pharmpy.modeling.set_iiv_on_ruv" title="pharmpy.modeling.set_iiv_on_ruv"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_iiv_on_ruv</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">power</span></code></p></td>
<td><p><a class="reference internal" href="api/pharmpy.modeling.set_power_on_ruv.html#pharmpy.modeling.set_power_on_ruv" title="pharmpy.modeling.set_power_on_ruv"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_power_on_ruv</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">combined</span></code></p></td>
<td><p><a class="reference internal" href="api/pharmpy.modeling.set_combined_error_model.html#pharmpy.modeling.set_combined_error_model" title="pharmpy.modeling.set_combined_error_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_combined_error_model</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">time_varying</span></code></p></td>
<td><p><a class="reference internal" href="api/pharmpy.modeling.set_time_varying_error_model.html#pharmpy.modeling.set_time_varying_error_model" title="pharmpy.modeling.set_time_varying_error_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_time_varying_error_model</span></code></a></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="procedure">
<h2>Procedure<a class="headerlink" href="#procedure" title="Link to this heading">#</a></h2>
<p>RUVsearch is doing modeling on the conditional weighted residual <a class="reference internal" href="#ibrahim" id="id2"><span>[Ibrahim]</span></a> of the fit of the input model to quickly assess which residual
model to select. The input model is then updated with the new residual error model and fit to see if the selected residual error
model was indeed better. This is done multiple times to see if additional features of the residual error model should be added.
(Due to the similarity between the power error model and the combined error model, the combination of these two error models is not considered in the procedure.
E.g., if the power error model is selected in the current iteration, the combined error model will be skipped in the next iteration automatically.)</p>
<div class="graphviz"><object data="_images/graphviz-f0e378d3846caf9d550d25f740b6aa38c12961f7.svg" type="image/svg+xml" class="graphviz">
<p class="warning">digraph G {
  draw [
    label = &quot;Input model&quot;;
    shape = rect;
  ];
  ruvsearch [
    label = &quot;Run residual error models&quot;;
    shape = rect;
  ];
  select [
    label = &quot;Select best model&quot;;
    shape = rect;
  ];
  update [
      label = &quot;Update and run input model&quot;;
      shape = rect;
  ]
  better [
      label = &quot;Significantly better?&quot;;
      shape = diamond;
  ]
  done [
      label = &quot;Done&quot;;
      shape = rect;
  ]

  draw -&gt; ruvsearch -&gt; select -&gt; update -&gt; better;
  better -&gt; done [label = &quot;No&quot;];
  better -&gt; ruvsearch [label = &quot;Yes (max 3 times)&quot;]
}</p></object></div>
<p>Selection is done using the likelihood ratio test and a default p-value of 0.001.</p>
</section>
<section id="the-ruvsearch-results">
<h2>The RUVsearch results<a class="headerlink" href="#the-ruvsearch-results" title="Link to this heading">#</a></h2>
<p>The results object contains the start model, the residual error models based on the conditional weighted residual(CWRES) of the start model,
the candidate models, and the selected best model (based on the input selection criteria). The tool also creates various summary tables which can be accessed in the results object,
as well as files in .csv/.json format.</p>
<p>Consider a standard ruvsearch run:</p>
<div class="pharmpy-snippet docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-1-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-1-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-1-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">run_ruvsearch</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">start_model</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">start_model_results</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-1-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">res</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">run_ruvsearch</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">start_model</span><span class="p">,</span><span class="w"> </span><span class="n">results</span><span class="o">=</span><span class="n">start_model_results</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">cwres_models</span></code> table contains information on the residual error models, such as the iteration times, the changes of OFV compared to the base CWRES model and some key parameter estimates.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>dofv</th>
      <th>parameters</th>
    </tr>
    <tr>
      <th>model</th>
      <th>dvid</th>
      <th>iteration</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>IIV_on_RUV</th>
      <th>1</th>
      <th>1</th>
      <td>10.479721</td>
      <td>{'omega': 0.027766}</td>
    </tr>
    <tr>
      <th>combined</th>
      <th>1</th>
      <th>1</th>
      <td>1.385268</td>
      <td>{'sigma_add': 0.000367, 'sigma_prop': 0.967365}</td>
    </tr>
    <tr>
      <th>power</th>
      <th>1</th>
      <th>1</th>
      <td>0.002792</td>
      <td>{'theta': 0.00123}</td>
    </tr>
    <tr>
      <th>time_varying1</th>
      <th>1</th>
      <th>1</th>
      <td>3.117041</td>
      <td>{'theta': 1.0976}</td>
    </tr>
    <tr>
      <th>time_varying2</th>
      <th>1</th>
      <th>1</th>
      <td>6.555154</td>
      <td>{'theta': 1.12252}</td>
    </tr>
    <tr>
      <th>time_varying3</th>
      <th>1</th>
      <th>1</th>
      <td>6.336641</td>
      <td>{'theta': 1.14299}</td>
    </tr>
    <tr>
      <th>combined</th>
      <th>1</th>
      <th>2</th>
      <td>1.091207</td>
      <td>{'sigma_add': 0.000337, 'sigma_prop': 1.05242}</td>
    </tr>
    <tr>
      <th>power</th>
      <th>1</th>
      <th>2</th>
      <td>0.065738</td>
      <td>{'theta': 0.006105}</td>
    </tr>
    <tr>
      <th>time_varying1</th>
      <th>1</th>
      <th>2</th>
      <td>3.654562</td>
      <td>{'theta': 1.10545}</td>
    </tr>
    <tr>
      <th>time_varying2</th>
      <th>1</th>
      <th>2</th>
      <td>7.046578</td>
      <td>{'theta': 1.12659}</td>
    </tr>
    <tr>
      <th>time_varying3</th>
      <th>1</th>
      <th>2</th>
      <td>7.519115</td>
      <td>{'theta': 1.15573}</td>
    </tr>
    <tr>
      <th>combined</th>
      <th>1</th>
      <th>3</th>
      <td>1.612710</td>
      <td>{'sigma_add': 0.00054, 'sigma_prop': 1.04769}</td>
    </tr>
    <tr>
      <th>power</th>
      <th>1</th>
      <th>3</th>
      <td>1.643741</td>
      <td>{'theta': -0.030825}</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">summary_tool</span></code> table contains information such as which feature each model candidate has, the difference to the
start model, and final ranking:</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>description</th>
      <th>n_params</th>
      <th>d_params</th>
      <th>dofv</th>
      <th>ofv</th>
      <th>parent_model</th>
    </tr>
    <tr>
      <th>step</th>
      <th>model</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <th>mox3</th>
      <td></td>
      <td>8</td>
      <td>0</td>
      <td>0.000000</td>
      <td>-2460.704469</td>
      <td>mox3</td>
    </tr>
    <tr>
      <th>1</th>
      <th>best_ruvsearch_1</th>
      <td>IIV_on_RUV</td>
      <td>9</td>
      <td>1</td>
      <td>12.957378</td>
      <td>-2473.661847</td>
      <td>mox3</td>
    </tr>
    <tr>
      <th>2</th>
      <th>best_ruvsearch_2</th>
      <td>IIV_on_RUV+time_varying3</td>
      <td>10</td>
      <td>1</td>
      <td>35.269102</td>
      <td>-2495.973571</td>
      <td>best_ruvsearch_1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<p>To see information about the actual model runs, such as minimization status, estimation time, and parameter estimates,
you can look at the <code class="docutils literal notranslate"><span class="pre">summary_models</span></code> table. The table is generated with
<a class="reference internal" href="api/pharmpy.tools.summarize_modelfit_results.html#pharmpy.tools.summarize_modelfit_results" title="pharmpy.tools.summarize_modelfit_results"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.tools.summarize_modelfit_results()</span></code></a>.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>description</th>
      <th>minimization_successful</th>
      <th>errors_found</th>
      <th>warnings_found</th>
      <th>ofv</th>
      <th>aic</th>
      <th>bic</th>
      <th>runtime_total</th>
      <th>estimation_runtime</th>
      <th>POP_VC_estimate</th>
      <th>POP_CL_estimate</th>
      <th>POP_MAT_estimate</th>
      <th>IIV_VC_estimate</th>
      <th>IIV_VC_IIV_CL_estimate</th>
      <th>IIV_CL_estimate</th>
      <th>IIV_MAT_estimate</th>
      <th>RUV_PROP_estimate</th>
      <th>IIV_RUV1_estimate</th>
      <th>time_varying_estimate</th>
    </tr>
    <tr>
      <th>step</th>
      <th>model</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <th>mox3</th>
      <td></td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>-2460.704469</td>
      <td>-2444.704469</td>
      <td>-2423.757516</td>
      <td>NaN</td>
      <td>9.73</td>
      <td>106.707</td>
      <td>27.5434</td>
      <td>0.531596</td>
      <td>0.077743</td>
      <td>0.038888</td>
      <td>0.072309</td>
      <td>0.704770</td>
      <td>0.093311</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <th>best_ruvsearch_1</th>
      <td>IIV_on_RUV</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>-2473.661847</td>
      <td>-2455.661847</td>
      <td>-2435.047712</td>
      <td>8.0</td>
      <td>3.80</td>
      <td>105.794</td>
      <td>27.3091</td>
      <td>0.528620</td>
      <td>0.076793</td>
      <td>0.039924</td>
      <td>0.074889</td>
      <td>0.707665</td>
      <td>0.081095</td>
      <td>0.039675</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <th>best_ruvsearch_2</th>
      <td>IIV_on_RUV+time_varying3</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>-2495.973571</td>
      <td>-2475.973571</td>
      <td>-2453.068976</td>
      <td>9.0</td>
      <td>4.71</td>
      <td>106.733</td>
      <td>27.3094</td>
      <td>0.532547</td>
      <td>0.071628</td>
      <td>0.038470</td>
      <td>0.075048</td>
      <td>0.705429</td>
      <td>0.044311</td>
      <td>0.040734</td>
      <td>1.42509</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div role="list" class="citation-list">
<div class="citation" id="ibrahim" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">Ibrahim</a><span class="fn-bracket">]</span></span>
<p>Moustafa M. A. Ibrahim, Rikard Nordgren, Maria C. Kjellsson, Mats O. Karlsson. Model-Based Residual Post-Processing for Residual Model Identification. The AAPS Journal 2018 <a class="reference external" href="https://doi.org/10.1208/s12248-018-0240-7">https://doi.org/10.1208/s12248-018-0240-7</a></p>
</div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="covsearch.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">COVsearch</p>
      </div>
    </a>
    <a class="right-next"
       href="allometry.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">allometry</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running">Running</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#arguments">Arguments</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mandatory">Mandatory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optional">Optional</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#models">Models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#procedure">Procedure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-ruvsearch-results">The RUVsearch results</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2018-2025; the Pharmpy development team.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>
