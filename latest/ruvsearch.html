
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18: http://docutils.sourceforge.net/" />

    <title>ruvsearch &#8212; Pharmpy 0.81.1 documentation</title>
  <script>
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1e1de1a1873e13ef5536" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1e1de1a1873e13ef5536" rel="stylesheet">

  
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/6.1.2/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1e1de1a1873e13ef5536">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/thebelab-helper.js"></script>
    <script src="_static/tabs.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ruvsearch';</script>
    <link rel="shortcut icon" href="_static/Pharmpy_symbol.svg"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="allometry" href="allometry.html" />
    <link rel="prev" title="COVsearch" href="covsearch.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="light">

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="index.html">

  
  
  
  
  
  
  

  
    <img src="_static/Pharmpy_logo.svg" class="logo__image only-light" alt="Logo image">
    <img src="_static/Pharmpy_logo_dark.svg" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                <li class="nav-item">
                    <a class="nav-link" href="contributors.html">
                        About us
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="getting_started.html">
                        Getting started
                    </a>
                </li>
                

                <li class="nav-item current active">
                    <a class="nav-link" href="user_guide.html">
                        User guide
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="api.html">
                        API Reference
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="changelog.html">
                        Changelog
                    </a>
                </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                <li class="nav-item">
                    <a class="nav-link" href="contribute.html">
                        Contribute
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="citation.html">
                        References and citation
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="license.html">
                        License
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="developers.html">
                        Documentation for developers
                    </a>
                </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      <div class="navbar-end-item navbar-end__search-button-container">
        
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
      </div>
      
      <div class="navbar-end-item">
        <span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" data-toggle="tooltip">
    <a class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="fa-regular fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/pharmpy/pharmpy" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/pharmpy/pharmpy/issues" title="Report issues" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa fa-comments"></i></span>
            <label class="sr-only">Report issues</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>


  
  <div class="search-button-container--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
  </div>

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                <li class="nav-item">
                    <a class="nav-link" href="contributors.html">
                        About us
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="getting_started.html">
                        Getting started
                    </a>
                </li>
                

                <li class="nav-item current active">
                    <a class="nav-link" href="user_guide.html">
                        User guide
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="api.html">
                        API Reference
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="changelog.html">
                        Changelog
                    </a>
                </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                <li class="nav-item">
                    <a class="nav-link" href="contribute.html">
                        Contribute
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="citation.html">
                        References and citation
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="license.html">
                        License
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="developers.html">
                        Documentation for developers
                    </a>
                </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" data-toggle="tooltip">
    <a class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="fa-regular fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/pharmpy/pharmpy" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/pharmpy/pharmpy/issues" title="Report issues" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa fa-comments"></i></span>
            <label class="sr-only">Report issues</label></a>
        </li>
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item"><nav class="bd-links" id="bd-docs-nav" aria-label="Section navigation">
  <p class="bd-links__title" role="heading" aria-level="1">
    Section Navigation
  </p>
  <div class="bd-toc-item navbar-nav">
    <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="model.html">The Pharmpy model</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Datasets in Pharmpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="modeling.html">Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="modelfit.html">Reading modelfit results</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="tools.html">Tools</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="amd.html">AMD - automatic model development</a></li>
<li class="toctree-l2"><a class="reference internal" href="modelsearch.html">Modelsearch - search for best structural model for a PK model</a></li>
<li class="toctree-l2"><a class="reference internal" href="iivsearch.html">IIVsearch - search for best IIV structure (both variance and covariance)</a></li>
<li class="toctree-l2"><a class="reference internal" href="iovsearch.html">IOVsearch - search for best IOV structure and trim IIV</a></li>
<li class="toctree-l2"><a class="reference internal" href="covsearch.html">COVsearch - identify covariates that explain some of the IIV</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">RUVsearch - search for best residual error model</a></li>
<li class="toctree-l2"><a class="reference internal" href="allometry.html">allometry - add allometric scaling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="nonmem_plugin.html">Using the NONMEM plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">The Pharmpy command line interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_r.html">Pharmpy in R</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="psn_tools.html">PsN with Pharmpy</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="bootstrap.html">Bootstrap</a></li>
<li class="toctree-l2"><a class="reference internal" href="cdd.html">Case deletion diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="crossval.html">Crossval</a></li>
<li class="toctree-l2"><a class="reference internal" href="frem.html">FREM</a></li>
<li class="toctree-l2"><a class="reference internal" href="linearize.html">Linearize</a></li>
<li class="toctree-l2"><a class="reference internal" href="qa.html">QA</a></li>
<li class="toctree-l2"><a class="reference internal" href="psn_resmod.html">resmod</a></li>
<li class="toctree-l2"><a class="reference internal" href="scm.html">scm</a></li>
<li class="toctree-l2"><a class="reference internal" href="simeval.html">Simeval</a></li>
</ul>
</li>
</ul>

  </div>
</nav>
    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

      </div>
      <main class="bd-main">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            
            <article class="bd-article" role="main">
              
  <section id="ruvsearch">
<span id="id1"></span><h1>ruvsearch<a class="headerlink" href="#ruvsearch" title="Permalink to this heading">#</a></h1>
<p>The RUVsearch tool is a general tool to decide the best residual error model given a start model.</p>
<section id="running">
<h2>Running<a class="headerlink" href="#running" title="Permalink to this heading">#</a></h2>
<p>The RUVsearch tool is available both in Pharmpy/pharmr and from the command line.</p>
<p>To initiate RUVsearch in Python/R:</p>
<div class="pharmpy-snippet docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-0-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-0-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-0-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.tools</span> <span class="kn">import</span> <span class="n">run_ruvsearch</span>

<span class="n">start_model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="s1">&#39;path/to/model&#39;</span><span class="p">)</span>
<span class="n">start_model_results</span> <span class="o">=</span> <span class="n">read_modelfit_results</span><span class="p">(</span><span class="s1">&#39;path/to/model&#39;</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">run_ruvsearch</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">start_model</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">start_model_results</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">start_model</span> <span class="o">&lt;-</span> <span class="nf">read_model</span><span class="p">(</span><span class="s">&#39;path/to/model&#39;</span><span class="p">)</span>
<span class="n">start_model_results</span> <span class="o">&lt;-</span> <span class="nf">read_modelfit_results</span><span class="p">(</span><span class="s">&#39;path/to/model&#39;</span><span class="p">)</span>
<span class="n">res</span> <span class="o">&lt;-</span> <span class="nf">run_ruvsearch</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">start_model</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">start_model_results</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
</div>
<p>To run RUVsearch from the command line, the example code is redefined accordingly:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pharmpy</span> <span class="n">run</span> <span class="n">ruvsearch</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">model</span>
</pre></div>
</div>
</section>
<section id="arguments">
<h2>Arguments<a class="headerlink" href="#arguments" title="Permalink to this heading">#</a></h2>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">groups</span></code></p></td>
<td><p>Number of groups to use for the time varying model (default is 4)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">p_value</span></code></p></td>
<td><p>p-value for model selection (default is 0.05)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">skip</span></code></p></td>
<td><p>List of residual error models to not consider</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">model</span></code></p></td>
<td><p>Start model</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">results</span></code></p></td>
<td><p>ModelfitResults for the start model</p></td>
</tr>
</tbody>
</table>
</section>
<section id="models">
<h2>Models<a class="headerlink" href="#models" title="Permalink to this heading">#</a></h2>
<p>The various residual error models tested by <cite>RUVsearch</cite> can be found in the table below together with links to detailed documentation of the
functions used to create them.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Model name</p></th>
<th class="head"><p>Function</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">IIV_on_RUV</span></code></p></td>
<td><p><a class="reference internal" href="api/pharmpy.modeling.set_iiv_on_ruv.html#pharmpy.modeling.set_iiv_on_ruv" title="pharmpy.modeling.set_iiv_on_ruv"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_iiv_on_ruv</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">power</span></code></p></td>
<td><p><a class="reference internal" href="api/pharmpy.modeling.set_power_on_ruv.html#pharmpy.modeling.set_power_on_ruv" title="pharmpy.modeling.set_power_on_ruv"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_power_on_ruv</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">combined</span></code></p></td>
<td><p><a class="reference internal" href="api/pharmpy.modeling.set_combined_error_model.html#pharmpy.modeling.set_combined_error_model" title="pharmpy.modeling.set_combined_error_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_combined_error_model</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">time_varying</span></code></p></td>
<td><p><a class="reference internal" href="api/pharmpy.modeling.set_time_varying_error_model.html#pharmpy.modeling.set_time_varying_error_model" title="pharmpy.modeling.set_time_varying_error_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_time_varying_error_model</span></code></a></p></td>
</tr>
</tbody>
</table>
</section>
<section id="procedure">
<h2>Procedure<a class="headerlink" href="#procedure" title="Permalink to this heading">#</a></h2>
<p>RUVsearch is doing modeling on the conditional weighted residual <a class="reference internal" href="#ibrahim" id="id2"><span>[Ibrahim]</span></a> of the fit of the input model to quickly assess which residual
model to select. The input model is then updated with the new residual error model and fit to see if the selected residual error
model was indeed better. This is done multiple times to see if additional features of the residual error model should be added.
(Due to the similarity between the power error model and the combined error model, the combination of these two error models is not considered in the procedure.
E.g., if the power error model is selected in the current iteration, the combined error model will be skipped in the next iteration automatically.)</p>
<div class="graphviz"><object data="_images/graphviz-f0e378d3846caf9d550d25f740b6aa38c12961f7.svg" type="image/svg+xml" class="graphviz">
<p class="warning">digraph G {
  draw [
    label = &quot;Input model&quot;;
    shape = rect;
  ];
  ruvsearch [
    label = &quot;Run residual error models&quot;;
    shape = rect;
  ];
  select [
    label = &quot;Select best model&quot;;
    shape = rect;
  ];
  update [
      label = &quot;Update and run input model&quot;;
      shape = rect;
  ]
  better [
      label = &quot;Significantly better?&quot;;
      shape = diamond;
  ]
  done [
      label = &quot;Done&quot;;
      shape = rect;
  ]

  draw -&gt; ruvsearch -&gt; select -&gt; update -&gt; better;
  better -&gt; done [label = &quot;No&quot;];
  better -&gt; ruvsearch [label = &quot;Yes (max 3 times)&quot;]
}</p></object></div>
<p>Selection is done using the likelihood ratio test and a default p-value of 0.05.</p>
</section>
<section id="the-ruvsearch-results">
<h2>The RUVsearch results<a class="headerlink" href="#the-ruvsearch-results" title="Permalink to this heading">#</a></h2>
<p>The results object contains the start model, the residual error models based on the conditional weighted residual(CWRES) of the start model,
the candidate models, and the selected best model (based on the input selection criteria). The tool also creates various summary tables which can be accessed in the results object,
as well as files in .csv/.json format.</p>
<p>Consider a standard ruvsearch run:</p>
<div class="pharmpy-snippet docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-1-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-1-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-1-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">run_ruvsearch</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">start_model</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">start_model_results</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-1-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">&lt;-</span> <span class="nf">run_ruvsearch</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">start_model</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">start_model_results</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">cwres_models</span></code> table contains information on the residual error models, such as the iteration times, the changes of OFV compared to the base CWRES model and some key parameter estimates.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>dofv</th>
      <th>parameters</th>
    </tr>
    <tr>
      <th>model</th>
      <th>dvid</th>
      <th>iteration</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>IIV_on_RUV</th>
      <th>1</th>
      <th>1</th>
      <td>10.479721</td>
      <td>{'omega': 0.027766}</td>
    </tr>
    <tr>
      <th>combined</th>
      <th>1</th>
      <th>1</th>
      <td>1.385268</td>
      <td>{'sigma_add': 0.000367, 'sigma_prop': 0.967365}</td>
    </tr>
    <tr>
      <th>power</th>
      <th>1</th>
      <th>1</th>
      <td>0.002792</td>
      <td>{'theta': 0.00123}</td>
    </tr>
    <tr>
      <th>time_varying1</th>
      <th>1</th>
      <th>1</th>
      <td>3.117041</td>
      <td>{'theta': 1.0976}</td>
    </tr>
    <tr>
      <th>time_varying2</th>
      <th>1</th>
      <th>1</th>
      <td>6.555154</td>
      <td>{'theta': 1.12252}</td>
    </tr>
    <tr>
      <th>time_varying3</th>
      <th>1</th>
      <th>1</th>
      <td>6.336641</td>
      <td>{'theta': 1.14299}</td>
    </tr>
    <tr>
      <th>combined</th>
      <th>1</th>
      <th>2</th>
      <td>1.091207</td>
      <td>{'sigma_add': 0.000337, 'sigma_prop': 1.05242}</td>
    </tr>
    <tr>
      <th>power</th>
      <th>1</th>
      <th>2</th>
      <td>0.065738</td>
      <td>{'theta': 0.006105}</td>
    </tr>
    <tr>
      <th>time_varying1</th>
      <th>1</th>
      <th>2</th>
      <td>3.654562</td>
      <td>{'theta': 1.10545}</td>
    </tr>
    <tr>
      <th>time_varying2</th>
      <th>1</th>
      <th>2</th>
      <td>7.046578</td>
      <td>{'theta': 1.12659}</td>
    </tr>
    <tr>
      <th>time_varying3</th>
      <th>1</th>
      <th>2</th>
      <td>7.519115</td>
      <td>{'theta': 1.15573}</td>
    </tr>
    <tr>
      <th>combined</th>
      <th>1</th>
      <th>3</th>
      <td>1.612710</td>
      <td>{'sigma_add': 0.00054, 'sigma_prop': 1.04769}</td>
    </tr>
    <tr>
      <th>power</th>
      <th>1</th>
      <th>3</th>
      <td>1.643741</td>
      <td>{'theta': -0.030825}</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">summary_tool</span></code> table contains information such as which feature each model candidate has, the difference to the
start model, and final ranking:</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>description</th>
      <th>n_params</th>
      <th>d_params</th>
      <th>dofv</th>
      <th>ofv</th>
      <th>parent_model</th>
    </tr>
    <tr>
      <th>step</th>
      <th>model</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <th>mox3</th>
      <td></td>
      <td>8</td>
      <td>0</td>
      <td>0.000000</td>
      <td>-2460.704469</td>
      <td>mox3</td>
    </tr>
    <tr>
      <th>1</th>
      <th>best_ruvsearch_1</th>
      <td>IIV_on_RUV</td>
      <td>9</td>
      <td>1</td>
      <td>12.957378</td>
      <td>-2473.661847</td>
      <td>mox3</td>
    </tr>
    <tr>
      <th>2</th>
      <th>best_ruvsearch_2</th>
      <td>IIV_on_RUV+time_varying3</td>
      <td>10</td>
      <td>1</td>
      <td>35.269102</td>
      <td>-2495.973571</td>
      <td>best_ruvsearch_1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<p>To see information about the actual model runs, such as minimization status, estimation time, and parameter estimates,
you can look at the <code class="docutils literal notranslate"><span class="pre">summary_models</span></code> table. The table is generated with
<a class="reference internal" href="api/pharmpy.tools.summarize_modelfit_results.html#pharmpy.tools.summarize_modelfit_results" title="pharmpy.tools.summarize_modelfit_results"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.tools.summarize_modelfit_results()</span></code></a>.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>description</th>
      <th>minimization_successful</th>
      <th>errors_found</th>
      <th>warnings_found</th>
      <th>ofv</th>
      <th>aic</th>
      <th>bic</th>
      <th>runtime_total</th>
      <th>estimation_runtime</th>
      <th>POP_VC_estimate</th>
      <th>POP_CL_estimate</th>
      <th>POP_MAT_estimate</th>
      <th>IIV_VC_estimate</th>
      <th>IIV_VC_IIV_CL_estimate</th>
      <th>IIV_CL_estimate</th>
      <th>IIV_MAT_estimate</th>
      <th>RUV_PROP_estimate</th>
      <th>IIV_RUV1_estimate</th>
      <th>time_varying_estimate</th>
    </tr>
    <tr>
      <th>step</th>
      <th>model</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <th>mox3</th>
      <td></td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>-2460.704469</td>
      <td>-2444.704469</td>
      <td>-2423.757516</td>
      <td>NaN</td>
      <td>9.73</td>
      <td>106.707</td>
      <td>27.5434</td>
      <td>0.531596</td>
      <td>0.077743</td>
      <td>0.038888</td>
      <td>0.072309</td>
      <td>0.704770</td>
      <td>0.093311</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <th>best_ruvsearch_1</th>
      <td>IIV_on_RUV</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>-2473.661847</td>
      <td>-2455.661847</td>
      <td>-2435.047712</td>
      <td>8.0</td>
      <td>3.80</td>
      <td>105.794</td>
      <td>27.3091</td>
      <td>0.528620</td>
      <td>0.076793</td>
      <td>0.039924</td>
      <td>0.074889</td>
      <td>0.707665</td>
      <td>0.081095</td>
      <td>0.039675</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <th>best_ruvsearch_2</th>
      <td>IIV_on_RUV+time_varying3</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>-2495.973571</td>
      <td>-2475.973571</td>
      <td>-2453.068976</td>
      <td>9.0</td>
      <td>4.71</td>
      <td>106.733</td>
      <td>27.3094</td>
      <td>0.532547</td>
      <td>0.071628</td>
      <td>0.038470</td>
      <td>0.075048</td>
      <td>0.705429</td>
      <td>0.044311</td>
      <td>0.040734</td>
      <td>1.42509</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<p>A summary table of predicted influential individuals and outliers can be seen in <code class="docutils literal notranslate"><span class="pre">summary_individuals_count</span></code>.
See <a class="reference internal" href="api/pharmpy.tools.summarize_individuals_count_table.html#pharmpy.tools.summarize_individuals_count_table" title="pharmpy.tools.summarize_individuals_count_table"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.tools.summarize_individuals_count_table()</span></code></a> for information on the content of this table.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>parent_model</th>
      <th>inf_selection</th>
      <th>inf_params</th>
      <th>out_obs</th>
      <th>out_ind</th>
      <th>inf_outlier</th>
    </tr>
    <tr>
      <th>model</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mox3</th>
      <td>mox3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>best_ruvsearch_1</th>
      <td>mox3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>best_ruvsearch_2</th>
      <td>best_ruvsearch_1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<p>Finally, you can see different individual statistics <code class="docutils literal notranslate"><span class="pre">summary_individuals</span></code>.
See <a class="reference internal" href="api/pharmpy.tools.summarize_individuals.html#pharmpy.tools.summarize_individuals" title="pharmpy.tools.summarize_individuals"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.tools.summarize_individuals()</span></code></a> for information on the content of this table.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>parent_model</th>
      <th>outlier_count</th>
      <th>ofv</th>
      <th>dofv_vs_parent</th>
      <th>predicted_dofv</th>
      <th>predicted_residual</th>
    </tr>
    <tr>
      <th>model</th>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">mox3</th>
      <th>110</th>
      <td>mox3</td>
      <td>0.0</td>
      <td>-16.215727</td>
      <td>0.000000</td>
      <td>0.164274</td>
      <td>0.450202</td>
    </tr>
    <tr>
      <th>112</th>
      <td>mox3</td>
      <td>0.0</td>
      <td>-25.655144</td>
      <td>0.000000</td>
      <td>0.195425</td>
      <td>0.960585</td>
    </tr>
    <tr>
      <th>113</th>
      <td>mox3</td>
      <td>0.0</td>
      <td>-39.708324</td>
      <td>0.000000</td>
      <td>0.090461</td>
      <td>-0.848498</td>
    </tr>
    <tr>
      <th>121</th>
      <td>mox3</td>
      <td>0.0</td>
      <td>-39.762729</td>
      <td>0.000000</td>
      <td>0.052021</td>
      <td>-1.239462</td>
    </tr>
    <tr>
      <th>123</th>
      <td>mox3</td>
      <td>0.0</td>
      <td>-25.236530</td>
      <td>0.000000</td>
      <td>0.065148</td>
      <td>-0.571348</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">best_ruvsearch_2</th>
      <th>1403</th>
      <td>best_ruvsearch_1</td>
      <td>0.0</td>
      <td>-12.229762</td>
      <td>0.244582</td>
      <td>0.161981</td>
      <td>1.509910</td>
    </tr>
    <tr>
      <th>1404</th>
      <td>best_ruvsearch_1</td>
      <td>0.0</td>
      <td>-20.715966</td>
      <td>-0.373696</td>
      <td>0.084489</td>
      <td>0.647643</td>
    </tr>
    <tr>
      <th>1405</th>
      <td>best_ruvsearch_1</td>
      <td>0.0</td>
      <td>-24.423148</td>
      <td>1.344772</td>
      <td>0.083776</td>
      <td>-0.259395</td>
    </tr>
    <tr>
      <th>1406</th>
      <td>best_ruvsearch_1</td>
      <td>0.0</td>
      <td>-39.419741</td>
      <td>0.101415</td>
      <td>0.024651</td>
      <td>-0.443542</td>
    </tr>
    <tr>
      <th>1407</th>
      <td>best_ruvsearch_1</td>
      <td>0.0</td>
      <td>-48.774540</td>
      <td>0.124023</td>
      <td>0.183089</td>
      <td>0.977222</td>
    </tr>
  </tbody>
</table>
<p>219 rows Ã— 6 columns</p>
</div></div></div>
</div>
</div>
<div role="list" class="citation-list">
<div class="citation" id="ibrahim" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">Ibrahim</a><span class="fn-bracket">]</span></span>
<p>Moustafa M. A. Ibrahim, Rikard Nordgren, Maria C. Kjellsson, Mats O. Karlsson. Model-Based Residual Post-Processing for Residual Model Identification. The AAPS Journal 2018 <a class="reference external" href="https://doi.org/10.1208/s12248-018-0240-7">https://doi.org/10.1208/s12248-018-0240-7</a></p>
</div>
</div>
</section>
</section>


            </article>
            
            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="covsearch.html" title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">COVsearch</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="allometry.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">allometry</p>
  </div>
  <i class="fa-solid fa-angle-right"></i>
  </a>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#running">
   Running
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#arguments">
   Arguments
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#models">
   Models
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#procedure">
   Procedure
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-ruvsearch-results">
   The RUVsearch results
  </a>
 </li>
</ul>

</nav>
</div>

<div class="toc-item">
  
<div id="searchbox"></div>
</div>

<div class="toc-item">
  
</div>

<div class="toc-item">
  
</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1e1de1a1873e13ef5536"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright 2018-2022; the Pharmpy development team.<br>

</p>

  </div>
  
  <div class="footer-item">
    
<p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br>
</p>

  </div>
  
</div>
  </footer>
  </body>
</html>