
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>FREM &#8212; Pharmpy 0.72.0 documentation</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=fb52004a9691e5b75515" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=fb52004a9691e5b75515" rel="stylesheet">


  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=fb52004a9691e5b75515">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.0-rc.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Linearize" href="linearize.html" />
    <link rel="prev" title="Crossval" href="crossval.html" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="None">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="index.html">
<p class="title">Pharmpy</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="contributors.html">
  About us
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="getting_started.html">
  Getting started
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="user_guide.html">
  User guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="api.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="changelog.html">
  Changelog
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="contribute.html">
  Contribute
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="citation.html">
  References and citation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="license.html">
  License
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
<h3><a href="index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="contributors.html">About us</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="user_guide.html">User guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="model.html">The Pharmpy model</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html">Datasets in Pharmpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="modeling.html">Modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="modelfit.html">Modelfit</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="psn_tools.html">PsN with Pharmpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="plots.html">Plots in Pharmpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="nonmem_plugin.html">Using the NONMEM plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli.html">The Pharmpy command line interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="using_r.html">Pharmpy in R</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="contribute.html">Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">References and citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-frem-postprocessing-and-results">
   The FREM postprocessing and results
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#covariate-effects">
     Covariate effects
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parameter-covariate-coefficients">
     Parameter covariate coefficients
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#individual-covariate-effects">
     Individual covariate effects
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#unexplained-variability">
     Unexplained variability
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parameter-estimates">
     Parameter estimates
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ofv">
     OFV
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#estimated-covariate-values">
     Estimated covariate values
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#references">
     References
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
    </div>
    
    <div class="toc-item">
      
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section id="frem">
<h1>FREM<a class="headerlink" href="#frem" title="Permalink to this headline">#</a></h1>
<p>Pharmpy handles the postprocessing, plotting and creation of model_3b of the PsN FREM <a class="reference internal" href="#yngman" id="id1"><span>[Yngman]</span></a> tool.</p>
<div class="math notranslate nohighlight">
\[\]</div>
<section id="the-frem-postprocessing-and-results">
<h2>The FREM postprocessing and results<a class="headerlink" href="#the-frem-postprocessing-and-results" title="Permalink to this headline">#</a></h2>
<p>The postprocessing starts after estimating the parameters <span class="math notranslate nohighlight">\(P\)</span> of the FREM model together with their uncertainty covariance matrix <span class="math notranslate nohighlight">\(\operatorname{Cov}(P)\)</span>. Let us denote the random variables representing the model parameters <span class="math notranslate nohighlight">\(\eta_i\)</span> for <span class="math notranslate nohighlight">\(1 \leq i \leq n_{par}\)</span> and the random variables for the covariates
<span class="math notranslate nohighlight">\(\eta_k\)</span> for <span class="math notranslate nohighlight">\(n_{par} + 1 \leq k \leq n_{cov} + n_{par}\)</span>. Then</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
    \eta_1 \\
    \vdots \\
        \eta_{n_{par}} \\
        \eta_{n_{par} + 1} \\
        \vdots \\
        \eta_{n_{par} + n_{cov}} \\
 \end{bmatrix}
\sim \mathcal{N}(\mu, \Omega)\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}    \mu =
\begin{bmatrix}
    0 \\
    \vdots \\
    0 \\
    \overline{C}_{1} \\
    \vdots \\
        \overline{C}_{n_{cov}} \\
\end{bmatrix}
=
\begin{bmatrix}
    \mu_1 \\
    \mu_2 \\
\end{bmatrix}\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split} \Omega =
 \begin{bmatrix}
     \omega_{11} &amp; \omega_{21} &amp; \cdots &amp; \omega_{n1} \\
     \omega_{21} &amp; \omega_{22} &amp; \cdots &amp; \omega_{n2} \\
     \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
     \omega_{n1} &amp; \omega_{n2} &amp; \cdots &amp; \omega_{nn} \\
 \end{bmatrix} =
 \begin{bmatrix}
     \Omega_{11} &amp; \Omega_{12} \\
     \Omega_{21} &amp; \Omega_{22} \\
\end{bmatrix}\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(\overline{C}_k\)</span> is the covariate reference. For continuous covariates the reference is the mean of the baselines and for categoricals it is the non-mode value of the baselines.
The latter partition being for parameters (index 1) and covariates (index 2), i.e.
<span class="math notranslate nohighlight">\(\Omega_{11}\)</span> is the original parameter matrix, <span class="math notranslate nohighlight">\(\Omega_{22}\)</span> is the covariate matrix and <span class="math notranslate nohighlight">\(\Omega_{21}\)</span> and <span class="math notranslate nohighlight">\(\Omega_{12}^T\)</span> is the parameter-covariate covariance block.</p>
<section id="covariate-effects">
<h3>Covariate effects<a class="headerlink" href="#covariate-effects" title="Permalink to this headline">#</a></h3>
<p>The effects of each covariate on each parameter is calculated with uncertainty and summarized in the <code class="docutils literal notranslate"><span class="pre">covariate_effects</span></code> table.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>p5</th>
      <th>mean</th>
      <th>p95</th>
    </tr>
    <tr>
      <th>parameter</th>
      <th>covariate</th>
      <th>condition</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">CL</th>
      <th rowspan="2" valign="top">APGR</th>
      <th>5th</th>
      <td>0.630859</td>
      <td>0.868770</td>
      <td>1.176754</td>
    </tr>
    <tr>
      <th>95th</th>
      <td>0.925602</td>
      <td>1.082310</td>
      <td>1.244607</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">WGT</th>
      <th>5th</th>
      <td>0.569077</td>
      <td>0.600360</td>
      <td>0.632538</td>
    </tr>
    <tr>
      <th>95th</th>
      <td>2.532478</td>
      <td>2.824355</td>
      <td>3.138312</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">V</th>
      <th rowspan="2" valign="top">APGR</th>
      <th>5th</th>
      <td>0.577861</td>
      <td>0.761430</td>
      <td>0.991915</td>
    </tr>
    <tr>
      <th>95th</th>
      <td>1.003863</td>
      <td>1.148763</td>
      <td>1.297579</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">WGT</th>
      <th>5th</th>
      <td>0.600771</td>
      <td>0.631260</td>
      <td>0.661025</td>
    </tr>
    <tr>
      <th>95th</th>
      <td>2.315965</td>
      <td>2.549669</td>
      <td>2.811532</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<p>The effects are given as fractions where 1 means no effect and are calculated conditioned on the 5th and 95th percentile of the covariate values respectively.</p>
<p>Assume that the estimated parameter vector is joint normally distributed with mean vector <span class="math notranslate nohighlight">\(P\)</span> and covariance matrix <span class="math notranslate nohighlight">\(\operatorname{Cov}(P)\)</span>. Then the marginal distribution of the <span class="math notranslate nohighlight">\(\omega_{ij}\)</span> of <span class="math notranslate nohighlight">\(\Omega\)</span> will also be joint normal. Sample 1000 times from this marginal distribution to get <span class="math notranslate nohighlight">\(\omega_{ijk}\)</span> and <span class="math notranslate nohighlight">\(\Omega_k\)</span> for <span class="math notranslate nohighlight">\(1\leq k \leq 1000\)</span>.</p>
<p>If the covariate etas were scaled in the FREM model the scaling needs to be applied to all <span class="math notranslate nohighlight">\(\Omega_k\)</span> by first creating the scaling matrix</p>
<div class="math notranslate nohighlight">
\[\begin{split}    S=
\begin{bmatrix}
    1 &amp; &amp; &amp; &amp; \\
    &amp; 1 &amp; &amp; &amp; \\
    &amp; &amp; \ddots &amp; &amp;\\
    &amp; &amp; &amp; \sigma_1 &amp;\\
    &amp; &amp; &amp; &amp; \sigma_2 \\
\end{bmatrix}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma_i\)</span> is the standard deviation of the i:th covariate in the data, and then get each scaled matrix as <span class="math notranslate nohighlight">\(S \Omega_k S\)</span>.</p>
<p>Do for each sample:
For each covariate <span class="math notranslate nohighlight">\(k\)</span> create the marginal distribution of all parameters and that single covariate. Calculate the means of the parameters given the covariate values in the 5th and 95th percentile of the dataset in turn. The vector of the means would be given by the conditional joint normal distribution as:</p>
<div class="math notranslate nohighlight">
\[\bar{\mu} = \mu_1 + \Omega_{12}\Omega_{22}^{-1}(a - \mu_2)\]</div>
<p>where <span class="math notranslate nohighlight">\(a\)</span> is the given value of the covariate.</p>
<p>For each parameter and covariate calculate the mean, 5:th and 95:th percentile over all conditional parameter means. These are the covariate effects and their uncertainties. I.e. the conditional mean of the parameter given in turn the 5th and the 95th percentile of the covariate data. Since we currently assume log-normally distributed individual parameters each mean is exponentiated.</p>
<p>The covariate effect plots give the covariate effects in percent with uncertainty for each parameter and covariate in turn. The red figures are the 5th and 95th percentile covariate values.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-a5083537aa874f63ae94a878220ac2f9"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-a5083537aa874f63ae94a878220ac2f9") {
      outputDiv = document.getElementById("altair-viz-a5083537aa874f63ae94a878220ac2f9");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.17.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "4.17.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"axis": {"labelFontSize": 11, "titleFontSize": 13}, "legend": {"labelFontSize": 12, "titleFontSize": 13}}, "vconcat": [{"facet": {"row": {"field": "covariate", "title": null, "type": "nominal"}}, "spec": {"layer": [{"mark": {"type": "errorbar", "ticks": true}, "encoding": {"x": {"field": "p5", "scale": {"zero": false}, "title": "Effect size in percent", "type": "quantitative"}, "x2": {"field": "p95"}, "y": {"field": "condition", "title": null, "type": "nominal"}}}, {"mark": {"type": "rule", "color": "gray", "strokeDash": [10, 4]}, "encoding": {"x": {"field": "xzero", "type": "quantitative"}}, "transform": [{"calculate": "0", "as": "xzero"}]}, {"mark": {"type": "point", "color": "black", "filled": true}, "encoding": {"x": {"field": "mean", "type": "quantitative"}, "y": {"field": "condition", "type": "nominal"}}}, {"mark": {"type": "text", "color": "red", "dy": -15}, "encoding": {"text": {"field": "value", "type": "quantitative"}, "x": {"field": "mean", "type": "quantitative"}, "y": {"field": "condition", "type": "nominal"}}}], "height": 100, "width": 700}, "columns": 1.0, "data": {"name": "data-89b030eed97fbe1e249c2a01c54d3ef9"}, "resolve": {"scale": {"y": "independent"}}, "title": "CL"}, {"facet": {"row": {"field": "covariate", "title": null, "type": "nominal"}}, "spec": {"layer": [{"mark": {"type": "errorbar", "ticks": true}, "encoding": {"x": {"field": "p5", "scale": {"zero": false}, "title": "Effect size in percent", "type": "quantitative"}, "x2": {"field": "p95"}, "y": {"field": "condition", "title": null, "type": "nominal"}}}, {"mark": {"type": "rule", "color": "gray", "strokeDash": [10, 4]}, "encoding": {"x": {"field": "xzero", "type": "quantitative"}}, "transform": [{"calculate": "0", "as": "xzero"}]}, {"mark": {"type": "point", "color": "black", "filled": true}, "encoding": {"x": {"field": "mean", "type": "quantitative"}, "y": {"field": "condition", "type": "nominal"}}}, {"mark": {"type": "text", "color": "red", "dy": -15}, "encoding": {"text": {"field": "value", "type": "quantitative"}, "x": {"field": "mean", "type": "quantitative"}, "y": {"field": "condition", "type": "nominal"}}}], "height": 100, "width": 700}, "columns": 1.0, "data": {"name": "data-a3e1ea761b20f7980a62bf137382e9f1"}, "resolve": {"scale": {"y": "independent"}}, "title": "V"}], "datasets": {"data-89b030eed97fbe1e249c2a01c54d3ef9": [{"covariate": "APGR", "condition": "5th", "p5": -36.914081509999995, "mean": -13.123047719999992, "p95": 17.67538243, "value": 1.0}, {"covariate": "APGR", "condition": "95th", "p5": -7.439789359999994, "mean": 8.231013009999998, "p95": 24.460658819999992, "value": 9.0}, {"covariate": "WGT", "condition": "5th", "p5": -43.09229599, "mean": -39.96403612, "p95": -36.74624313, "value": 0.7000000000000001}, {"covariate": "WGT", "condition": "95th", "p5": 153.24775711000004, "mean": 182.43552521, "p95": 213.83117273000002, "value": 3.2}], "data-a3e1ea761b20f7980a62bf137382e9f1": [{"covariate": "APGR", "condition": "5th", "p5": -42.213909169999994, "mean": -23.85701026, "p95": -0.8084764299999936, "value": 1.0}, {"covariate": "APGR", "condition": "95th", "p5": 0.3863330800000009, "mean": 14.876304819999998, "p95": 29.757934860000002, "value": 9.0}, {"covariate": "WGT", "condition": "5th", "p5": -39.92285835, "mean": -36.8740294, "p95": -33.8974577, "value": 0.7000000000000001}, {"covariate": "WGT", "condition": "95th", "p5": 131.59647363, "mean": 154.96690116, "p95": 181.15319135000001, "value": 3.2}]}, "resolve": {"scale": {"x": "shared"}}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json"}, {"mode": "vega-lite"});
</script></div></div>
</div>
</div>
</section>
<section id="parameter-covariate-coefficients">
<h3>Parameter covariate coefficients<a class="headerlink" href="#parameter-covariate-coefficients" title="Permalink to this headline">#</a></h3>
<p>The parameter covariate coefficients for each covariate separately and for all taken together are available in <code class="docutils literal notranslate"><span class="pre">coefficients</span></code>. The definition for one coefficient is
<cite>Cov(Par, Covariate) / Var(Covariate)</cite> and generalized for all together by the matrix <span class="math notranslate nohighlight">\(\Sigma_{12}\Sigma_{22}^{-1}\)</span></p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>APGR</th>
      <th>WGT</th>
    </tr>
    <tr>
      <th>condition</th>
      <th>parameter</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">all</th>
      <th>CL</th>
      <td>-0.020503</td>
      <td>0.628814</td>
    </tr>
    <tr>
      <th>V</th>
      <td>0.009309</td>
      <td>0.544459</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">each</th>
      <th>CL</th>
      <td>0.026950</td>
      <td>0.613127</td>
    </tr>
    <tr>
      <th>V</th>
      <td>0.050396</td>
      <td>0.551581</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</section>
<section id="individual-covariate-effects">
<h3>Individual covariate effects<a class="headerlink" href="#individual-covariate-effects" title="Permalink to this headline">#</a></h3>
<p>The combined effects of all covariates on the parameters of each individual is calculated with uncertainty and summarized in the <code class="docutils literal notranslate"><span class="pre">individual_effects</span></code> table.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>observed</th>
      <th>p5</th>
      <th>p95</th>
    </tr>
    <tr>
      <th>ID</th>
      <th>parameter</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">1.0</th>
      <th>CL</th>
      <td>0.913307</td>
      <td>0.899565</td>
      <td>0.923297</td>
    </tr>
    <tr>
      <th>V</th>
      <td>0.939015</td>
      <td>0.926632</td>
      <td>0.948404</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">2.0</th>
      <th>CL</th>
      <td>0.933506</td>
      <td>0.894967</td>
      <td>0.970755</td>
    </tr>
    <tr>
      <th>V</th>
      <td>1.010192</td>
      <td>0.973823</td>
      <td>1.047109</td>
    </tr>
    <tr>
      <th>3.0</th>
      <th>CL</th>
      <td>0.992728</td>
      <td>0.986142</td>
      <td>0.999404</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>57.0</th>
      <th>V</th>
      <td>1.361911</td>
      <td>1.322628</td>
      <td>1.418737</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">58.0</th>
      <th>CL</th>
      <td>0.894772</td>
      <td>0.868658</td>
      <td>0.917333</td>
    </tr>
    <tr>
      <th>V</th>
      <td>0.947797</td>
      <td>0.923656</td>
      <td>0.969732</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">59.0</th>
      <th>CL</th>
      <td>0.771958</td>
      <td>0.748072</td>
      <td>0.790423</td>
    </tr>
    <tr>
      <th>V</th>
      <td>0.790120</td>
      <td>0.768277</td>
      <td>0.806911</td>
    </tr>
  </tbody>
</table>
<p>118 rows Ã— 3 columns</p>
</div></div></div>
</div>
</div>
<p>The conditional distribution as above is calculated for the estimated parameters (observed in the table) and the samples (that gives p5 and p95). The same <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(\Omega\)</span> are used, but the given condition is instead the covariate baseline as estimated from the model for each individual.</p>
<p>The plot shows the individuals with the lowest and the highest percentual covariate effect and the uncertainty.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-d1909658584e45759ad9ad0df6209ea7"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-d1909658584e45759ad9ad0df6209ea7") {
      outputDiv = document.getElementById("altair-viz-d1909658584e45759ad9ad0df6209ea7");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.17.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "4.17.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"axis": {"labelFontSize": 11, "titleFontSize": 13}, "legend": {"labelFontSize": 12, "titleFontSize": 13}}, "vconcat": [{"layer": [{"mark": {"type": "point", "color": "black", "filled": true, "size": 40}, "encoding": {"x": {"field": "observed", "type": "quantitative"}, "y": {"field": "ID", "sort": ["48", "56", "51", "25", "52", "4", "45", "29", "7", "18", "...", "43", "14", "13", "59", "50", "16", "37", "17", "19", "55", "8", "11", "40", "20", "6", "38", "49", "15", "12", "9", "58", "31", "44", "1", "10", "5", "2", "22", "3", "36", "53", "33", "41", "54", "30", "34", "21", "39", "27", "57", "47", "35", "42", "28", "23", "24", "26", "32"], "type": "nominal"}}}, {"mark": {"type": "errorbar", "ticks": true}, "encoding": {"tooltip": [{"field": "ID", "type": "nominal"}, {"field": "p5", "type": "quantitative"}, {"field": "observed", "type": "quantitative"}, {"field": "p95", "type": "quantitative"}, {"field": "APGR", "type": "quantitative"}, {"field": "WGT", "type": "quantitative"}], "x": {"field": "p5", "scale": {"zero": false}, "title": "Effect size in percent", "type": "quantitative"}, "x2": {"field": "p95"}, "y": {"field": "ID", "sort": ["48", "56", "51", "25", "52", "4", "45", "29", "7", "18", "...", "43", "14", "13", "59", "50", "16", "37", "17", "19", "55", "8", "11", "40", "20", "6", "38", "49", "15", "12", "9", "58", "31", "44", "1", "10", "5", "2", "22", "3", "36", "53", "33", "41", "54", "30", "34", "21", "39", "27", "57", "47", "35", "42", "28", "23", "24", "26", "32"], "title": "ID", "type": "nominal"}}}, {"mark": {"type": "rule", "color": "gray", "strokeDash": [10, 2]}, "encoding": {"x": {"field": "xzero", "type": "quantitative"}}, "transform": [{"calculate": "0", "as": "xzero"}]}], "data": {"name": "data-c05434568a64b5806249965535bd54a3"}, "title": "Individuals for parameter CL", "transform": [{"window": [{"op": "row_number", "field": "observed", "as": "rank"}], "sort": [{"field": "observed", "order": "ascending"}]}, {"window": [{"op": "row_number", "field": "observed", "as": "nrank"}], "sort": [{"field": "observed", "order": "descending"}]}, {"filter": "datum.rank <= 10 | datum.nrank <= 11"}, {"calculate": "datum.nrank == 11 ? '...' : datum.ID", "as": "ID"}, {"calculate": "datum.nrank == 11 ? '...' : datum.p5", "as": "p5"}, {"calculate": "datum.nrank == 11 ? '...' : datum.p95", "as": "p95"}, {"calculate": "datum.nrank == 11 ? '...' : datum.observed", "as": "observed"}], "width": 700}, {"layer": [{"mark": {"type": "point", "color": "black", "filled": true, "size": 40}, "encoding": {"x": {"field": "observed", "type": "quantitative"}, "y": {"field": "ID", "sort": ["56", "25", "45", "48", "43", "4", "19", "52", "51", "18", "...", "29", "40", "55", "17", "59", "50", "13", "14", "46", "6", "20", "8", "11", "16", "37", "12", "15", "38", "49", "1", "10", "44", "5", "58", "9", "31", "36", "3", "22", "2", "34", "41", "33", "53", "21", "54", "30", "27", "39", "57", "35", "47", "42", "23", "24", "28", "26", "32"], "type": "nominal"}}}, {"mark": {"type": "errorbar", "ticks": true}, "encoding": {"tooltip": [{"field": "ID", "type": "nominal"}, {"field": "p5", "type": "quantitative"}, {"field": "observed", "type": "quantitative"}, {"field": "p95", "type": "quantitative"}, {"field": "APGR", "type": "quantitative"}, {"field": "WGT", "type": "quantitative"}], "x": {"field": "p5", "scale": {"zero": false}, "title": "Effect size in percent", "type": "quantitative"}, "x2": {"field": "p95"}, "y": {"field": "ID", "sort": ["56", "25", "45", "48", "43", "4", "19", "52", "51", "18", "...", "29", "40", "55", "17", "59", "50", "13", "14", "46", "6", "20", "8", "11", "16", "37", "12", "15", "38", "49", "1", "10", "44", "5", "58", "9", "31", "36", "3", "22", "2", "34", "41", "33", "53", "21", "54", "30", "27", "39", "57", "35", "47", "42", "23", "24", "28", "26", "32"], "title": "ID", "type": "nominal"}}}, {"mark": {"type": "rule", "color": "gray", "strokeDash": [10, 2]}, "encoding": {"x": {"field": "xzero", "type": "quantitative"}}, "transform": [{"calculate": "0", "as": "xzero"}]}], "data": {"name": "data-723037bd94636615bf53117361a0c562"}, "title": "Individuals for parameter V", "transform": [{"window": [{"op": "row_number", "field": "observed", "as": "rank"}], "sort": [{"field": "observed", "order": "ascending"}]}, {"window": [{"op": "row_number", "field": "observed", "as": "nrank"}], "sort": [{"field": "observed", "order": "descending"}]}, {"filter": "datum.rank <= 10 | datum.nrank <= 11"}, {"calculate": "datum.nrank == 11 ? '...' : datum.ID", "as": "ID"}, {"calculate": "datum.nrank == 11 ? '...' : datum.p5", "as": "p5"}, {"calculate": "datum.nrank == 11 ? '...' : datum.p95", "as": "p95"}, {"calculate": "datum.nrank == 11 ? '...' : datum.observed", "as": "observed"}], "width": 700}], "datasets": {"data-c05434568a64b5806249965535bd54a3": [{"ID": "48", "observed": -42.383274439999994, "p5": -46.56979917999999, "p95": -39.27138787, "APGR": 700.0, "WGT": -29.999999999999993}, {"ID": "56", "observed": -41.27036605999999, "p5": -45.474923499999996, "p95": -37.70426203, "APGR": 300.0, "WGT": -39.99999999999999}, {"ID": "51", "observed": -35.98777025, "p5": -40.44854891999999, "p95": -32.63619582999999, "APGR": 800.0, "WGT": -9.999999999999998}, {"ID": "25", "observed": -33.49121559999999, "p5": -39.656263, "p95": -27.416119539999993, "APGR": 0.0, "WGT": -29.999999999999993}, {"ID": "52", "observed": -33.308343480000005, "p5": -36.65063851, "p95": -30.89226142, "APGR": 600.0, "WGT": -9.999999999999998}, {"ID": "4", "observed": -31.92684871, "p5": -35.0638251, "p95": -29.527912619999995, "APGR": 500.0, "WGT": -9.999999999999998}, {"ID": "45", "observed": -30.612154599999997, "p5": -36.06436710999999, "p95": -25.350319209999995, "APGR": 100.0, "WGT": -19.999999999999996}, {"ID": "29", "observed": -28.98000905, "p5": -32.026041809999995, "p95": -26.79953172999999, "APGR": 600.0, "WGT": 0.0}, {"ID": "7", "observed": -26.00722849999999, "p5": -29.08789195, "p95": -23.46720388, "APGR": 400.0, "WGT": 0.0}, {"ID": "18", "observed": -26.00722849999999, "p5": -29.08789195, "p95": -23.46720388, "APGR": 400.0, "WGT": 0.0}, {"ID": "46", "observed": -25.905632169999993, "p5": -29.32675052, "p95": -23.42602156, "APGR": 700.0, "WGT": 10.000000000000009}, {"ID": "43", "observed": -24.578075349999995, "p5": -31.147523359999994, "p95": -17.852351079999995, "APGR": 0.0, "WGT": -9.999999999999998}, {"ID": "14", "observed": -24.370796239999994, "p5": -27.09734521, "p95": -22.46255196, "APGR": 600.0, "WGT": 10.000000000000009}, {"ID": "13", "observed": -22.804163239999998, "p5": -25.1927766, "p95": -20.957747819999994, "APGR": 500.0, "WGT": 10.000000000000009}, {"ID": "59", "observed": -22.804163239999998, "p5": -25.1927766, "p95": -20.957747819999994, "APGR": 500.0, "WGT": 10.000000000000009}, {"ID": "50", "observed": -22.804163239999998, "p5": -25.1927766, "p95": -20.957747819999994, "APGR": 500.0, "WGT": 10.000000000000009}, {"ID": "16", "observed": -22.69814885, "p5": -26.798706709999998, "p95": -19.306306539999994, "APGR": 800.0, "WGT": 19.999999999999996}, {"ID": "37", "observed": -22.69814885, "p5": -26.798706709999998, "p95": -19.306306539999994, "APGR": 800.0, "WGT": 19.999999999999996}, {"ID": "17", "observed": -21.205081589999995, "p5": -24.026380189999998, "p95": -18.847829399999995, "APGR": 400.0, "WGT": 10.000000000000009}, {"ID": "19", "observed": -19.683140499999997, "p5": -26.505156379999995, "p95": -12.640429089999994, "APGR": 0.0, "WGT": 0.0}, {"ID": "55", "observed": -19.572821499999993, "p5": -23.128844849999997, "p95": -16.21576122, "APGR": 300.0, "WGT": 10.000000000000009}, {"ID": "8", "observed": -19.462444509999997, "p5": -21.793727539999995, "p95": -17.80049576, "APGR": 600.0, "WGT": 19.999999999999996}, {"ID": "11", "observed": -19.46237315, "p5": -21.79365071, "p95": -17.80042801, "APGR": 600.0, "WGT": 19.999999999999996}, {"ID": "40", "observed": -17.906803869999997, "p5": -22.588517969999998, "p95": -13.296323589999993, "APGR": 200.0, "WGT": 10.000000000000009}, {"ID": "20", "observed": -17.79410027, "p5": -19.75396772, "p95": -16.278261949999994, "APGR": 500.0, "WGT": 19.999999999999996}, {"ID": "6", "observed": -16.091237120000002, "p5": -18.612939880000003, "p95": -13.86114945, "APGR": 400.0, "WGT": 19.999999999999996}, {"ID": "38", "observed": -15.975988330000002, "p5": -18.874721709999996, "p95": -13.666650939999991, "APGR": 700.0, "WGT": 30.000000000000004}, {"ID": "49", "observed": -15.975988330000002, "p5": -18.874721709999996, "p95": -13.666650939999991, "APGR": 700.0, "WGT": 30.000000000000004}, {"ID": "15", "observed": -14.235463699999995, "p5": -16.139378479999998, "p95": -12.914173309999999, "APGR": 600.0, "WGT": 30.000000000000004}, {"ID": "12", "observed": -12.458880769999992, "p5": -13.930022629999995, "p95": -11.294572189999997, "APGR": 500.0, "WGT": 30.000000000000004}, {"ID": "9", "observed": -10.522811759999994, "p5": -13.134211539999995, "p95": -8.266677830000003, "APGR": 700.0, "WGT": 39.99999999999999}, {"ID": "58", "observed": -10.522811759999994, "p5": -13.134211539999995, "p95": -8.266677830000003, "APGR": 700.0, "WGT": 39.99999999999999}, {"ID": "31", "observed": -10.522811759999994, "p5": -13.134211539999995, "p95": -8.266677830000003, "APGR": 700.0, "WGT": 39.99999999999999}, {"ID": "44", "observed": -8.66932669999999, "p5": -10.043479839999991, "p95": -7.670328809999994, "APGR": 600.0, "WGT": 39.99999999999999}, {"ID": "1", "observed": -8.66932669999999, "p5": -10.043479839999991, "p95": -7.670328809999994, "APGR": 600.0, "WGT": 39.99999999999999}, {"ID": "10", "observed": -8.66932669999999, "p5": -10.043479839999991, "p95": -7.670328809999994, "APGR": 600.0, "WGT": 39.99999999999999}, {"ID": "5", "observed": -8.669286239999996, "p5": -10.04343876, "p95": -7.670291359999992, "APGR": 600.0, "WGT": 39.99999999999999}, {"ID": "2", "observed": -6.6494437999999985, "p5": -10.503309429999996, "p95": -2.9244760400000014, "APGR": 800.0, "WGT": 50.0}, {"ID": "22", "observed": -4.715693290000001, "p5": -7.165295589999998, "p95": -2.4043247599999984, "APGR": 700.0, "WGT": 50.0}, {"ID": "3", "observed": -0.7272174199999926, "p5": -1.3857946100000018, "p95": -0.05964709999999318, "APGR": 500.0, "WGT": 50.0}, {"ID": "36", "observed": 1.329157099999989, "p5": -0.8534957899999918, "p95": 3.637847659999993, "APGR": 400.0, "WGT": 50.0}, {"ID": "53", "observed": 8.053654420000012, "p5": 5.4049886700000105, "p95": 10.926268800000006, "APGR": 700.0, "WGT": 70.00000000000001}, {"ID": "33", "observed": 8.053654420000012, "p5": 5.4049886700000105, "p95": 10.926268800000006, "APGR": 700.0, "WGT": 70.00000000000001}, {"ID": "41", "observed": 10.291943719999995, "p5": 8.974294230000002, "p95": 11.945832180000004, "APGR": 600.0, "WGT": 70.00000000000001}, {"ID": "54", "observed": 15.06636001999999, "p5": 12.054417230000002, "p95": 18.510357929999998, "APGR": 700.0, "WGT": 80.0}, {"ID": "30", "observed": 15.066410999999992, "p5": 12.054462999999993, "p95": 18.51040718000001, "APGR": 700.0, "WGT": 80.0}, {"ID": "34", "observed": 17.288897320000007, "p5": 12.9074036, "p95": 22.718183009999994, "APGR": 300.0, "WGT": 70.00000000000001}, {"ID": "21", "observed": 17.449914779999997, "p5": 15.511749029999988, "p95": 19.970165660000006, "APGR": 600.0, "WGT": 80.0}, {"ID": "39", "observed": 17.61121619999999, "p5": 11.237411660000006, "p95": 24.76208594, "APGR": 900.0, "WGT": 89.99999999999999}, {"ID": "27", "observed": 30.307767279999997, "p5": 26.54943873, "p95": 35.88718063, "APGR": 400.0, "WGT": 89.99999999999999}, {"ID": "57", "observed": 44.771871360000006, "p5": 40.14562930000001, "p95": 51.62772253000001, "APGR": 500.0, "WGT": 110.00000000000001}, {"ID": "47", "observed": 86.42994554999999, "p5": 74.40334923, "p95": 102.78105991999999, "APGR": 800.0, "WGT": 160.0}, {"ID": "35", "observed": 90.03096492, "p5": 79.2969998, "p95": 106.97375793999998, "APGR": 400.0, "WGT": 150.0}, {"ID": "42", "observed": 111.41463268999998, "p5": 95.83544137, "p95": 133.00378680999998, "APGR": 800.0, "WGT": 179.99999999999997}, {"ID": "28", "observed": 171.87541371, "p5": 147.23744485, "p95": 207.84676297, "APGR": 800.0, "WGT": 220.00000000000003}, {"ID": "23", "observed": 188.72699962000002, "p5": 160.42537966, "p95": 234.57092801, "APGR": 200.0, "WGT": 210.0}, {"ID": "24", "observed": 213.83433222, "p5": 179.61114958, "p95": 271.34455062, "APGR": 100.0, "WGT": 220.00000000000003}, {"ID": "26", "observed": 228.32052112999997, "p5": 193.8630511, "p95": 280.12742137000004, "APGR": 800.0, "WGT": 250.0}, {"ID": "32", "observed": 249.62843923999998, "p5": 210.89398009, "p95": 307.86920018, "APGR": 800.0, "WGT": 260.0}], "data-723037bd94636615bf53117361a0c562": [{"ID": "56", "observed": -40.92832265999999, "p5": -44.74642729, "p95": -37.78367027, "APGR": 300.0, "WGT": -39.99999999999999}, {"ID": "25", "observed": -39.34089547999999, "p5": -44.47607291, "p95": -34.54511602, "APGR": 0.0, "WGT": -29.999999999999993}, {"ID": "45", "observed": -35.34767393, "p5": -39.97633414999999, "p95": -31.097546050000002, "APGR": 100.0, "WGT": -19.999999999999996}, {"ID": "48", "observed": -35.25650828, "p5": -39.4135387, "p95": -32.08986602, "APGR": 700.0, "WGT": -29.999999999999993}, {"ID": "43", "observed": -32.36249484, "p5": -37.75629812, "p95": -27.142606729999997, "APGR": 0.0, "WGT": -9.999999999999998}, {"ID": "4", "observed": -29.139867479999992, "p5": -32.05534175, "p95": -26.917304879999993, "APGR": 500.0, "WGT": -9.999999999999998}, {"ID": "19", "observed": -28.577802860000002, "p5": -34.13262088, "p95": -23.162754369999995, "APGR": 0.0, "WGT": 0.0}, {"ID": "52", "observed": -28.477145949999993, "p5": -31.65286424, "p95": -26.14262413, "APGR": 600.0, "WGT": -9.999999999999998}, {"ID": "51", "observed": -27.133019569999995, "p5": -31.59744647, "p95": -23.648899349999997, "APGR": 800.0, "WGT": -9.999999999999998}, {"ID": "18", "observed": -25.868170319999994, "p5": -28.651533809999997, "p95": -23.633278689999994, "APGR": 400.0, "WGT": 0.0}, {"ID": "7", "observed": -25.868170319999994, "p5": -28.651533809999997, "p95": -23.633278689999994, "APGR": 400.0, "WGT": 0.0}, {"ID": "29", "observed": -24.47504723999999, "p5": -27.341601259999994, "p95": -22.38607229999999, "APGR": 600.0, "WGT": 0.0}, {"ID": "40", "observed": -23.164032150000004, "p5": -27.162010640000002, "p95": -19.41827843, "APGR": 200.0, "WGT": 10.000000000000009}, {"ID": "55", "observed": -22.445423060000003, "p5": -25.564291159999996, "p95": -19.629201509999994, "APGR": 300.0, "WGT": 10.000000000000009}, {"ID": "17", "observed": -21.72011504, "p5": -24.253540909999995, "p95": -19.668157199999992, "APGR": 400.0, "WGT": 10.000000000000009}, {"ID": "59", "observed": -20.98800169999999, "p5": -23.17225904, "p95": -19.308949659999996, "APGR": 500.0, "WGT": 10.000000000000009}, {"ID": "50", "observed": -20.98800169999999, "p5": -23.17225904, "p95": -19.308949659999996, "APGR": 500.0, "WGT": 10.000000000000009}, {"ID": "13", "observed": -20.98800169999999, "p5": -23.17225904, "p95": -19.308949659999996, "APGR": 500.0, "WGT": 10.000000000000009}, {"ID": "14", "observed": -20.249039599999996, "p5": -22.7913123, "p95": -18.43115837, "APGR": 600.0, "WGT": 10.000000000000009}, {"ID": "46", "observed": -19.503168019999993, "p5": -22.77069802, "p95": -17.05374558, "APGR": 700.0, "WGT": 10.000000000000009}, {"ID": "6", "observed": -17.339923140000003, "p5": -19.591238599999993, "p95": -15.421251839999995, "APGR": 400.0, "WGT": 19.999999999999996}, {"ID": "20", "observed": -16.566844009999993, "p5": -18.346792550000004, "p95": -15.203338259999999, "APGR": 500.0, "WGT": 19.999999999999996}, {"ID": "8", "observed": -15.786565209999992, "p5": -17.93879172999999, "p95": -14.209385339999992, "APGR": 600.0, "WGT": 19.999999999999996}, {"ID": "11", "observed": -15.786500599999997, "p5": -17.93872175, "p95": -14.209324299999992, "APGR": 600.0, "WGT": 19.999999999999996}, {"ID": "16", "observed": -14.203945199999989, "p5": -18.185693329999996, "p95": -10.767753130000003, "APGR": 800.0, "WGT": 19.999999999999996}, {"ID": "37", "observed": -14.203945199999989, "p5": -18.185693329999996, "p95": -10.767753130000003, "APGR": 800.0, "WGT": 19.999999999999996}, {"ID": "12", "observed": -11.898298129999995, "p5": -13.22699463, "p95": -10.863765269999991, "APGR": 500.0, "WGT": 30.000000000000004}, {"ID": "15", "observed": -11.074324299999994, "p5": -12.810148139999999, "p95": -9.829163929999996, "APGR": 600.0, "WGT": 30.000000000000004}, {"ID": "38", "observed": -10.242646099999996, "p5": -12.949708510000002, "p95": -7.9816534300000015, "APGR": 700.0, "WGT": 30.000000000000004}, {"ID": "49", "observed": -10.242646099999996, "p5": -12.949708510000002, "p95": -7.9816534300000015, "APGR": 700.0, "WGT": 30.000000000000004}, {"ID": "1", "observed": -6.098477629999999, "p5": -7.336771379999996, "p95": -5.159618059999993, "APGR": 600.0, "WGT": 39.99999999999999}, {"ID": "10", "observed": -6.098477629999999, "p5": -7.336771379999996, "p95": -5.159618059999993, "APGR": 600.0, "WGT": 39.99999999999999}, {"ID": "44", "observed": -6.098477629999999, "p5": -7.336771379999996, "p95": -5.159618059999993, "APGR": 600.0, "WGT": 39.99999999999999}, {"ID": "5", "observed": -6.098441609999994, "p5": -7.336733849999999, "p95": -5.159582679999996, "APGR": 600.0, "WGT": 39.99999999999999}, {"ID": "58", "observed": -5.220262779999995, "p5": -7.634364649999991, "p95": -3.026753119999992, "APGR": 700.0, "WGT": 39.99999999999999}, {"ID": "9", "observed": -5.220262779999995, "p5": -7.634364649999991, "p95": -3.026753119999992, "APGR": 700.0, "WGT": 39.99999999999999}, {"ID": "31", "observed": -5.220262779999995, "p5": -7.634364649999991, "p95": -3.026753119999992, "APGR": 700.0, "WGT": 39.99999999999999}, {"ID": "36", "observed": -2.6731876299999957, "p5": -4.589036579999995, "p95": -0.75202714, "APGR": 400.0, "WGT": 50.0}, {"ID": "3", "observed": -1.7629188799999973, "p5": -2.3585079899999917, "p95": -1.1892452100000006, "APGR": 500.0, "WGT": 50.0}, {"ID": "22", "observed": 0.08317547000000758, "p5": -2.1498592799999994, "p95": 2.3086813699999986, "APGR": 700.0, "WGT": 50.0}, {"ID": "2", "observed": 1.0192010799999984, "p5": -2.617657979999999, "p95": 4.710865680000009, "APGR": 800.0, "WGT": 50.0}, {"ID": "34", "observed": 7.517879290000007, "p5": 3.8324617700000063, "p95": 11.839281810000003, "APGR": 300.0, "WGT": 70.00000000000001}, {"ID": "41", "observed": 10.562880500000006, "p5": 9.402420280000001, "p95": 12.057425789999998, "APGR": 600.0, "WGT": 70.00000000000001}, {"ID": "33", "observed": 11.596920849999993, "p5": 9.21581453, "p95": 14.304671639999999, "APGR": 700.0, "WGT": 70.00000000000001}, {"ID": "53", "observed": 11.596920849999993, "p5": 9.21581453, "p95": 14.304671639999999, "APGR": 700.0, "WGT": 70.00000000000001}, {"ID": "21", "observed": 16.74943952000001, "p5": 15.047257639999989, "p95": 18.995842610000004, "APGR": 600.0, "WGT": 80.0}, {"ID": "54", "observed": 17.841339719999993, "p5": 15.145034820000003, "p95": 21.03733888999999, "APGR": 700.0, "WGT": 80.0}, {"ID": "30", "observed": 17.841384930000004, "p5": 15.145075420000008, "p95": 21.03738233000001, "APGR": 700.0, "WGT": 80.0}, {"ID": "27", "observed": 21.008121959999993, "p5": 17.817146769999994, "p95": 25.536722589999993, "APGR": 400.0, "WGT": 89.99999999999999}, {"ID": "39", "observed": 26.77367131000001, "p5": 20.77575357999999, "p95": 33.800495839999996, "APGR": 900.0, "WGT": 89.99999999999999}, {"ID": "57", "observed": 36.191072469999995, "p5": 32.26276878000001, "p95": 41.873703920000004, "APGR": 500.0, "WGT": 110.00000000000001}, {"ID": "35", "observed": 67.75975273000002, "p5": 59.15741692, "p95": 80.86846026, "APGR": 400.0, "WGT": 150.0}, {"ID": "47", "observed": 83.86733582, "p5": 73.37281841000001, "p95": 98.30493915000001, "APGR": 800.0, "WGT": 160.0}, {"ID": "42", "observed": 105.02028600000001, "p5": 91.60940759, "p95": 123.70668028999998, "APGR": 800.0, "WGT": 179.99999999999997}, {"ID": "23", "observed": 128.28397245, "p5": 107.85913168999998, "p95": 159.90122087, "APGR": 200.0, "WGT": 210.0}, {"ID": "24", "observed": 138.82393356999998, "p5": 115.02449997, "p95": 176.8625755, "APGR": 100.0, "WGT": 220.00000000000003}, {"ID": "28", "observed": 154.90479584000002, "p5": 134.32207128, "p95": 184.88287671, "APGR": 800.0, "WGT": 220.00000000000003}, {"ID": "26", "observed": 200.13424515999998, "p5": 172.01660445, "p95": 242.12379462999996, "APGR": 800.0, "WGT": 250.0}, {"ID": "32", "observed": 216.92817068000002, "p5": 185.53759376, "p95": 263.69494151000004, "APGR": 800.0, "WGT": 260.0}]}, "resolve": {"scale": {"x": "shared"}}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json"}, {"mode": "vega-lite"});
</script></div></div>
</div>
</div>
</section>
<section id="unexplained-variability">
<h3>Unexplained variability<a class="headerlink" href="#unexplained-variability" title="Permalink to this headline">#</a></h3>
<p>The unexplained variability is calculated and summarized in the <code class="docutils literal notranslate"><span class="pre">unexplained_variability</span></code> table.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>sd_observed</th>
      <th>sd_5th</th>
      <th>sd_95th</th>
    </tr>
    <tr>
      <th>parameter</th>
      <th>covariate</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">CL</th>
      <th>none</th>
      <td>0.469535</td>
      <td>0.359934</td>
      <td>0.547612</td>
    </tr>
    <tr>
      <th>APGR</th>
      <td>0.465490</td>
      <td>0.352335</td>
      <td>0.538174</td>
    </tr>
    <tr>
      <th>WGT</th>
      <td>0.165502</td>
      <td>0.141580</td>
      <td>0.190726</td>
    </tr>
    <tr>
      <th>all</th>
      <td>0.159149</td>
      <td>0.134989</td>
      <td>0.183613</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">V</th>
      <th>none</th>
      <td>0.420471</td>
      <td>0.327104</td>
      <td>0.490419</td>
    </tr>
    <tr>
      <th>APGR</th>
      <td>0.404440</td>
      <td>0.306148</td>
      <td>0.467046</td>
    </tr>
    <tr>
      <th>WGT</th>
      <td>0.143317</td>
      <td>0.122348</td>
      <td>0.166012</td>
    </tr>
    <tr>
      <th>all</th>
      <td>0.141826</td>
      <td>0.120282</td>
      <td>0.163610</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<p>For each sample the conditional distribution is calculated given no covariates, each covariate in turn and all covariates at the same time. The variability will be given by the conditional covariance matrix that can be calculated as:</p>
<div class="math notranslate nohighlight">
\[\bar{\Omega} = \Omega_{11} - \Omega_{12} \Omega_{22}^{-1} \Omega_{21} =  \Omega_{11} - \Omega_{21}^T \Omega_{22}^{-1} \Omega_{21}\]</div>
<p>The presented results are the 5th and 95th percetiles of the standard deviations of the parameters from <span class="math notranslate nohighlight">\(\bar{\Omega}\)</span>. The observed standard deviation is the conditional.</p>
<p>The plot display the original unexplained variability with the uncertainty for all parameter and covariate combinations.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-c0083b31c5e0401d98d70b4271a3ea59"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-c0083b31c5e0401d98d70b4271a3ea59") {
      outputDiv = document.getElementById("altair-viz-c0083b31c5e0401d98d70b4271a3ea59");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.17.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "4.17.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"axis": {"labelFontSize": 11, "titleFontSize": 13}, "legend": {"labelFontSize": 12, "titleFontSize": 13}}, "vconcat": [{"layer": [{"mark": {"type": "point", "color": "black", "filled": true, "size": 40}, "encoding": {"x": {"field": "sd_observed", "type": "quantitative"}, "y": {"field": "covariate", "sort": ["none", "APGR", "WGT", "all"], "type": "nominal"}}}, {"mark": {"type": "errorbar", "ticks": true}, "encoding": {"tooltip": [{"field": "sd_5th", "type": "quantitative"}, {"field": "sd_observed", "type": "quantitative"}, {"field": "sd_95th", "type": "quantitative"}, {"field": "covariate", "type": "nominal"}], "x": {"field": "sd_5th", "scale": {"zero": false}, "title": "SD of unexplained variability", "type": "quantitative"}, "x2": {"field": "sd_95th"}, "y": {"field": "covariate", "sort": ["none", "APGR", "WGT", "all"], "title": "covariate", "type": "nominal"}}}, {"mark": {"type": "rule", "color": "gray", "strokeDash": [10, 2]}, "encoding": {"x": {"field": "xzero", "type": "quantitative"}}, "transform": [{"calculate": "0", "as": "xzero"}]}], "data": {"name": "data-4a426c8d46466a9e7ca4ef332a1d8b48"}, "title": "Unexplained variability on CL", "width": 700}, {"layer": [{"mark": {"type": "point", "color": "black", "filled": true, "size": 40}, "encoding": {"x": {"field": "sd_observed", "type": "quantitative"}, "y": {"field": "covariate", "sort": ["none", "APGR", "WGT", "all"], "type": "nominal"}}}, {"mark": {"type": "errorbar", "ticks": true}, "encoding": {"tooltip": [{"field": "sd_5th", "type": "quantitative"}, {"field": "sd_observed", "type": "quantitative"}, {"field": "sd_95th", "type": "quantitative"}, {"field": "covariate", "type": "nominal"}], "x": {"field": "sd_5th", "scale": {"zero": false}, "title": "SD of unexplained variability", "type": "quantitative"}, "x2": {"field": "sd_95th"}, "y": {"field": "covariate", "sort": ["none", "APGR", "WGT", "all"], "title": "covariate", "type": "nominal"}}}, {"mark": {"type": "rule", "color": "gray", "strokeDash": [10, 2]}, "encoding": {"x": {"field": "xzero", "type": "quantitative"}}, "transform": [{"calculate": "0", "as": "xzero"}]}], "data": {"name": "data-8f8fa33f872355738f1a0425f878875d"}, "title": "Unexplained variability on V", "width": 700}], "datasets": {"data-4a426c8d46466a9e7ca4ef332a1d8b48": [{"covariate": "none", "sd_observed": 0.4695348762, "sd_5th": 0.35993355590000004, "sd_95th": 0.547611779}, {"covariate": "APGR", "sd_observed": 0.4654903178, "sd_5th": 0.3523352576, "sd_95th": 0.538173949}, {"covariate": "WGT", "sd_observed": 0.1655015423, "sd_5th": 0.14157986990000002, "sd_95th": 0.1907264948}, {"covariate": "all", "sd_observed": 0.1591486057, "sd_5th": 0.1349891406, "sd_95th": 0.18361312100000002}], "data-8f8fa33f872355738f1a0425f878875d": [{"covariate": "none", "sd_observed": 0.42047116430000003, "sd_5th": 0.3271036918, "sd_95th": 0.4904193626}, {"covariate": "APGR", "sd_observed": 0.4044398154, "sd_5th": 0.3061480714, "sd_95th": 0.4670457897}, {"covariate": "WGT", "sd_observed": 0.14331686600000001, "sd_5th": 0.1223484668, "sd_95th": 0.1660120463}, {"covariate": "all", "sd_observed": 0.1418257746, "sd_5th": 0.12028234460000001, "sd_95th": 0.1636101164}]}, "resolve": {"scale": {"x": "shared"}}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json"}, {"mode": "vega-lite"});
</script></div></div>
</div>
</div>
<p>All variability parameters given the estimated parameters conditioned on each covariate in turn can be found in <code class="docutils literal notranslate"><span class="pre">parameter_variability</span></code>.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>CL</th>
      <th>V</th>
    </tr>
    <tr>
      <th>condition</th>
      <th>parameter</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">all</th>
      <th>CL</th>
      <td>0.025328</td>
      <td>0.022571</td>
    </tr>
    <tr>
      <th>V</th>
      <td>0.022571</td>
      <td>0.020115</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">APGR</th>
      <th>CL</th>
      <td>0.216681</td>
      <td>0.188254</td>
    </tr>
    <tr>
      <th>V</th>
      <td>0.188254</td>
      <td>0.163572</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">WGT</th>
      <th>CL</th>
      <td>0.027391</td>
      <td>0.021634</td>
    </tr>
    <tr>
      <th>V</th>
      <td>0.021634</td>
      <td>0.020540</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</section>
<section id="parameter-estimates">
<h3>Parameter estimates<a class="headerlink" href="#parameter-estimates" title="Permalink to this headline">#</a></h3>
<p>The parameter initial estimates and final estimates of the base model (model_1), all intermediate models and the FREM model (model_4) are tabled in <code class="docutils literal notranslate"><span class="pre">parameter_inits_and_estimates</span></code>.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>TVCL</th>
      <th>TVV</th>
      <th>IVCL</th>
      <th>OMEGA(2,1)</th>
      <th>IVV</th>
      <th>OMEGA(3,1)</th>
      <th>OMEGA(3,2)</th>
      <th>BSV_APGR</th>
      <th>OMEGA(4,1)</th>
      <th>OMEGA(4,2)</th>
      <th>OMEGA(4,3)</th>
      <th>BSV_WGT</th>
      <th>SIGMA(1,1)</th>
    </tr>
    <tr>
      <th>model</th>
      <th>type</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">model_1</th>
      <th>init</th>
      <td>0.004693</td>
      <td>1.00916</td>
      <td>0.030963</td>
      <td>NaN</td>
      <td>0.031128</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.013241</td>
    </tr>
    <tr>
      <th>estimate</th>
      <td>0.005818</td>
      <td>1.44555</td>
      <td>0.111053</td>
      <td>NaN</td>
      <td>0.201526</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.016418</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">model_2</th>
      <th>init</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.244579</td>
      <td>1.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>estimate</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.244579</td>
      <td>1.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">model_3</th>
      <th>init</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.115195</td>
      <td>0.007066</td>
      <td>0.209016</td>
      <td>-0.010583</td>
      <td>0.107027</td>
      <td>1.000008</td>
      <td>0.171529</td>
      <td>0.404278</td>
      <td>0.244448</td>
      <td>1.002173</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>estimate</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.115195</td>
      <td>0.007066</td>
      <td>0.209016</td>
      <td>-0.010583</td>
      <td>0.107027</td>
      <td>1.000010</td>
      <td>0.171529</td>
      <td>0.404278</td>
      <td>0.244448</td>
      <td>1.002170</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">model_3b</th>
      <th>init</th>
      <td>0.005818</td>
      <td>1.44555</td>
      <td>0.125999</td>
      <td>0.020191</td>
      <td>0.224959</td>
      <td>-0.012042</td>
      <td>0.115427</td>
      <td>1.000032</td>
      <td>0.208475</td>
      <td>0.415588</td>
      <td>0.244080</td>
      <td>1.007763</td>
      <td>0.016418</td>
    </tr>
    <tr>
      <th>estimate</th>
      <td>0.005818</td>
      <td>1.44555</td>
      <td>0.126000</td>
      <td>0.020191</td>
      <td>0.224959</td>
      <td>-0.012042</td>
      <td>0.115427</td>
      <td>1.000030</td>
      <td>0.208475</td>
      <td>0.415588</td>
      <td>0.244080</td>
      <td>1.007760</td>
      <td>0.016418</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">model_4</th>
      <th>init</th>
      <td>0.005818</td>
      <td>1.44555</td>
      <td>0.126000</td>
      <td>0.020191</td>
      <td>0.224959</td>
      <td>-0.012042</td>
      <td>0.115427</td>
      <td>1.000030</td>
      <td>0.208475</td>
      <td>0.415588</td>
      <td>0.244080</td>
      <td>1.007760</td>
      <td>0.016418</td>
    </tr>
    <tr>
      <th>estimate</th>
      <td>0.007084</td>
      <td>1.38635</td>
      <td>0.220463</td>
      <td>0.195326</td>
      <td>0.176796</td>
      <td>0.062712</td>
      <td>0.117271</td>
      <td>1.039930</td>
      <td>0.446939</td>
      <td>0.402075</td>
      <td>0.249237</td>
      <td>1.034610</td>
      <td>0.015250</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<p>Relative difference between of the base model parameters estimates and the final model parameter estimates are calculated in <code class="docutils literal notranslate"><span class="pre">base_parameter_change</span></code>.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>relative_change</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>TVCL</th>
      <td>21.773218</td>
    </tr>
    <tr>
      <th>TVV</th>
      <td>-4.095327</td>
    </tr>
    <tr>
      <th>IVCL</th>
      <td>98.520526</td>
    </tr>
    <tr>
      <th>IVV</th>
      <td>-12.271369</td>
    </tr>
    <tr>
      <th>SIGMA(1,1)</th>
      <td>-7.110618</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</section>
<section id="ofv">
<h3>OFV<a class="headerlink" href="#ofv" title="Permalink to this headline">#</a></h3>
<p>OFV of the base model, all intermediate models and the final FREM model are collected into <code class="docutils literal notranslate"><span class="pre">ofv</span></code>.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ofv</th>
    </tr>
    <tr>
      <th>model_name</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>model_1</th>
      <td>730.894727</td>
    </tr>
    <tr>
      <th>model_2</th>
      <td>896.974324</td>
    </tr>
    <tr>
      <th>model_3</th>
      <td>868.657803</td>
    </tr>
    <tr>
      <th>model_3b</th>
      <td>852.803483</td>
    </tr>
    <tr>
      <th>model_4</th>
      <td>753.302743</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</section>
<section id="estimated-covariate-values">
<h3>Estimated covariate values<a class="headerlink" href="#estimated-covariate-values" title="Permalink to this headline">#</a></h3>
<p>The FREM model also gives an estimate of the covariate values themselves. Ideally these values should be close to the ones in the dataset. Summary statistics for the estimated
covariate values are put into <code class="docutils literal notranslate"><span class="pre">estimated_covariates</span></code>.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>stdev</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>APGR</th>
      <td>6.423728</td>
      <td>2.237640</td>
    </tr>
    <tr>
      <th>WGT</th>
      <td>1.525424</td>
      <td>0.704565</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Permalink to this headline">#</a></h3>
<dl class="citation">
<dt class="label" id="yngman"><span class="brackets"><a class="fn-backref" href="#id1">Yngman</a></span></dt>
<dd><p>Yngman G, Nyberg HB, Nyberg J, Jonsson EN, Karlsson MO. An introduction to the full random effects model. CPT Pharmacometrics Syst Pharmacol. 2021;00:1â€“ 12. <a class="reference external" href="https://doi.org/10.1002/psp4.12741">https://doi.org/10.1002/psp4.12741</a></p>
</dd>
</dl>
</section>
</section>
</section>


              </article>
              

              
              <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="crossval.html" title="previous page">
      <i class="fas fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">Crossval</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="linearize.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">Linearize</p>
  </div>
  <i class="fas fa-angle-right"></i>
  </a>
</div>
              </footer>
              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=fb52004a9691e5b75515"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright 2018-2022; the Pharmpy development team.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>