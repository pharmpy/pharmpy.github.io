
<!DOCTYPE html>


<html lang="en" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Structsearch &#8212; Pharmpy 0.103.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=ac02cc09edc035673794" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d10597a4" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css?v=a5c4661c" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=63439bfe" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=ac02cc09edc035673794" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=ac02cc09edc035673794"></script>

    <script src="_static/documentation_options.js?v=5091d9c7"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/thebelab-helper.js"></script>
    <script src="_static/tabs.js?v=3030b3cb"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'structsearch';</script>
    <link rel="icon" href="_static/Pharmpy_symbol.svg"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="IIVsearch" href="iivsearch.html" />
    <link rel="prev" title="Modelsearch" href="modelsearch.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Oct 12, 2023"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
    
    
    
    <img src="_static/Pharmpy_logo.svg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/Pharmpy_logo_dark.svg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="contributors.html">
                        About us
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="getting_started.html">
                        Getting started
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="user_guide.html">
                        User guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="api.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="changelog.html">
                        Changelog
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    More
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="contribute.html">
                        Contribute
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="citation.html">
                        References and citation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="license.html">
                        License
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="developers.html">
                        Documentation for developers
                      </a>
                    </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pharmpy/pharmpy" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pharmpy/pharmpy/issues" title="Report issues" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa fa-comments fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Report issues</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="contributors.html">
                        About us
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="getting_started.html">
                        Getting started
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="user_guide.html">
                        User guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="api.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="changelog.html">
                        Changelog
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    More
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="contribute.html">
                        Contribute
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="citation.html">
                        References and citation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="license.html">
                        License
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="developers.html">
                        Documentation for developers
                      </a>
                    </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pharmpy/pharmpy" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pharmpy/pharmpy/issues" title="Report issues" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa fa-comments fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Report issues</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="tools.html">Tools</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="amd.html">AMD - automatic model development</a></li>
<li class="toctree-l2"><a class="reference internal" href="modelsearch.html">Modelsearch - search for best structural model for a PK model</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Structsearch - search for best structural model for PKPD and drug metabolite models</a></li>
<li class="toctree-l2"><a class="reference internal" href="iivsearch.html">IIVsearch - search for best IIV structure (both variance and covariance)</a></li>
<li class="toctree-l2"><a class="reference internal" href="iovsearch.html">IOVsearch - search for best IOV structure and trim IIV</a></li>
<li class="toctree-l2"><a class="reference internal" href="covsearch.html">COVsearch - identify covariates that explain some of the IIV</a></li>
<li class="toctree-l2"><a class="reference internal" href="ruvsearch.html">RUVsearch - search for best residual error model</a></li>
<li class="toctree-l2"><a class="reference internal" href="allometry.html">allometry - add allometric scaling</a></li>
<li class="toctree-l2"><a class="reference internal" href="estmethod.html">estmethod - compare estimation methods and/or solvers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modelfit.html">Model estimation and results</a></li>
<li class="toctree-l1"><a class="reference internal" href="modeling.html">Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">The Pharmpy model</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Datasets in Pharmpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_r.html">Pharmpy in R</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">The Pharmpy command line interface</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="psn_tools.html">PsN with Pharmpy</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="bootstrap.html">Bootstrap</a></li>
<li class="toctree-l2"><a class="reference internal" href="cdd.html">Case deletion diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="crossval.html">Crossval</a></li>
<li class="toctree-l2"><a class="reference internal" href="frem.html">FREM</a></li>
<li class="toctree-l2"><a class="reference internal" href="linearize.html">Linearize</a></li>
<li class="toctree-l2"><a class="reference internal" href="qa.html">QA</a></li>
<li class="toctree-l2"><a class="reference internal" href="psn_resmod.html">resmod</a></li>
<li class="toctree-l2"><a class="reference internal" href="scm.html">scm</a></li>
<li class="toctree-l2"><a class="reference internal" href="simeval.html">Simeval</a></li>
</ul>
</li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="user_guide.html" class="nav-link">User guide</a></li>
    
    
    <li class="breadcrumb-item"><a href="tools.html" class="nav-link">Tools</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Structsearch</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="structsearch">
<span id="id1"></span><h1>Structsearch<a class="headerlink" href="#structsearch" title="Link to this heading">#</a></h1>
<p>The structsearch tool is a tool to find the best structural model given a base model and a specific model scope to test.
This tool will always return a model of the specified type.
Currently, supported model types are PKPD and drug metabolite.</p>
<section id="running">
<h2>Running<a class="headerlink" href="#running" title="Link to this heading">#</a></h2>
<p>The structsearch tool is available both in Pharmpy/pharmr.</p>
<p>The code to initiate structsearch for a PKPD model in Python/R is stated below:</p>
<div class="pharmpy-snippet docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-0-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-0-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-0-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pharmpy.modeling</span> <span class="kn">import</span> <span class="n">read_model</span>
<span class="kn">from</span> <span class="nn">pharmpy.tools</span> <span class="n">read_modelfit_results</span><span class="p">,</span> <span class="n">run_structsearch</span>

<span class="n">start_model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="s1">&#39;path/to/model&#39;</span><span class="p">)</span>
<span class="n">start_model_results</span> <span class="o">=</span> <span class="n">read_modelfit_results</span><span class="p">(</span><span class="s1">&#39;path/to/model&#39;</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">run_structsearch</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;pkpd&#39;</span><span class="p">,</span>
                        <span class="n">search_space</span><span class="o">=</span><span class="s2">&quot;DIRECTEFFECT(*)&quot;</span><span class="p">,</span>
                        <span class="n">model</span><span class="o">=</span><span class="n">start_model</span><span class="p">,</span>
                        <span class="n">results</span><span class="o">=</span><span class="n">start_model_results</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">from</span><span class="w"> </span><span class="n">pharmpy</span><span class="o">$</span><span class="n">tools</span><span class="w"> </span><span class="n">read_modelfit_results</span><span class="p">,</span><span class="w"> </span><span class="n">run_structsearch</span>

<span class="n">start_model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_model</span><span class="p">(</span><span class="s">&#39;path/to/model&#39;</span><span class="p">)</span>
<span class="n">start_model_results</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_modelfit_results</span><span class="p">(</span><span class="s">&#39;path/to/model&#39;</span><span class="p">)</span>
<span class="n">res</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">run_structsearch</span><span class="p">(</span><span class="n">type</span><span class="o">=</span><span class="s">&#39;pkpd&#39;</span><span class="p">,</span>
<span class="w">                        </span><span class="n">search_space</span><span class="o">=</span><span class="s">&quot;DIRECTEFFECT(*)&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="n">model</span><span class="o">=</span><span class="n">start_model</span><span class="p">,</span>
<span class="w">                        </span><span class="n">results</span><span class="o">=</span><span class="n">start_model_results</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
</div>
<p>This will take an input model <code class="docutils literal notranslate"><span class="pre">model</span></code> with a <code class="docutils literal notranslate"><span class="pre">search_space</span></code> that includes all direct effect PKPD models.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For PKPD models the input model has to be a PK model with a PKPD dataset.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For drug_metabolite models, the argument ‘route’ need to be set according to the table below.</p>
</div>
<section id="arguments">
<h3>Arguments<a class="headerlink" href="#arguments" title="Link to this heading">#</a></h3>
<p>The arguments of the structsearch tool are listed below.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#the-model-types"><span class="std std-ref">type</span></a></p></td>
<td><p>Type of model. Can be either pkpd or drug_metabolite</p></td>
</tr>
<tr class="row-odd"><td><p>route</p></td>
<td><p>Type of administration. Currently ‘oral’, ‘iv’ and ‘ivoral’
(currently only for drug_metabolite models)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="modelsearch.html#the-search-space"><span class="std std-ref">search_space</span></a></p></td>
<td><p>Search space of models to test (currently only for PKPD models)</p></td>
</tr>
<tr class="row-odd"><td><p>b_init (optional, default is 0.1)</p></td>
<td><p>Initial estimate for baseline effect (only for PKPD models)</p></td>
</tr>
<tr class="row-even"><td><p>emax_init (optional, default is 0.1)</p></td>
<td><p>Initial estimate for E <sub>max</sub> parameter (only for PKPD models)</p></td>
</tr>
<tr class="row-odd"><td><p>ec50_init (optional, default is 0.1)</p></td>
<td><p>Initial estimate for EC <sub>50</sub> parameter (only for PKPD models)</p></td>
</tr>
<tr class="row-even"><td><p>met_init (optional, default is 0.1)</p></td>
<td><p>Initial estimate for mean equilibration time  (only for PKPD models)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">model</span></code></p></td>
<td><p>PK start model</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">results</span></code></p></td>
<td><p>ModelfitResults of the start model</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="the-model-types">
<span id="id2"></span><h2>The model types<a class="headerlink" href="#the-model-types" title="Link to this heading">#</a></h2>
<p>Structsearch is currently available for PKPD and drug metabolite models.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">pkpd</span></code></p></td>
<td><p>PKPD models</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">drug_metabolite</span></code></p></td>
<td><p>Drug metabolite models</p></td>
</tr>
</tbody>
</table>
<p>When creating candidate models for the specified model type, some candidate models will be derived from the base model
and others from another candidate model. When computing the results, each candidate models’
results is compared to that of its parent. The candidate models should not be compared to the base model due to them  being
of different model types. For this reason, the least complex candidate model is chosen as the default model for this tool.
This model replaces the parent of all candidate models which have the base model as its parent. In the graphs below, this model
is represented by a rectangel. This ensures correct comparison of model results as well as establishing that a model of the
speciefied type will always be returned.</p>
<section id="pkpd-models">
<h3>PKPD models<a class="headerlink" href="#pkpd-models" title="Link to this heading">#</a></h3>
<p>Currently implemented PKPD models are:</p>
<ul class="simple">
<li><p><a class="reference internal" href="api/pharmpy.modeling.set_direct_effect.html#pharmpy.modeling.set_direct_effect" title="pharmpy.modeling.set_direct_effect"><code class="xref py py-func docutils literal notranslate"><span class="pre">Direct</span> <span class="pre">effect</span> <span class="pre">models</span></code></a>.</p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.add_effect_compartment.html#pharmpy.modeling.add_effect_compartment" title="pharmpy.modeling.add_effect_compartment"><code class="xref py py-func docutils literal notranslate"><span class="pre">Effect</span> <span class="pre">compartment</span> <span class="pre">models</span></code></a>.</p></li>
<li><p><a class="reference internal" href="api/pharmpy.modeling.add_indirect_effect.html#pharmpy.modeling.add_indirect_effect" title="pharmpy.modeling.add_indirect_effect"><code class="xref py py-func docutils literal notranslate"><span class="pre">Indirect</span> <span class="pre">effect</span> <span class="pre">models</span></code></a>.</p></li>
</ul>
<div class="graphviz"><object data="_images/graphviz-5943ab619be535d1e87b4826375dff016b5b935f.svg" type="image/svg+xml" class="graphviz">
<p class="warning">digraph BST {
        node [fontname=&quot;Arial&quot;]
        base [label=&quot;Base model&quot;]
        s1 [label=&quot;Baseline&quot;;shape = rect;]
        s2 [label=&quot;direct effect linear&quot;]
        s3 [label=&quot;direct effect emax&quot;]
        s4 [label=&quot;direct effect sigmoid&quot;]
        s5 [label=&quot;effect compartment linear&quot;]
        s6 [label=&quot;...&quot;]

        base -&gt; s1
        base -&gt; s2
        base -&gt; s3
        base -&gt; s4
        base -&gt; s5
        base -&gt; s6
}</p></object></div>
<p>Note : The figure above is only showing a subset of all candidate models created, indicated by “…”</p>
<p>Regarding DVID, DVID=1 is representing PK observations while DVID=2 is connected to PD observations.</p>
</section>
<section id="drug-metabolite">
<h3>Drug metabolite<a class="headerlink" href="#drug-metabolite" title="Link to this heading">#</a></h3>
<p>Currently implemented drug metabolite models are:</p>
<ul>
<li><p>Base metabolite</p>
<blockquote>
<div><ul class="simple">
<li><p>Single metabolite compartment with parent -&gt; metabolite conversion of 100%</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Base metabolite with a (metabolite) peripheral compartment</p></li>
<li><p>Presystemic drug metabolite</p>
<blockquote>
<div><ul class="simple">
<li><p>Presystemic metabolite compartment with parent -&gt; metabolite conversion of 100%</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Presystemic drug metabolite with a (metabolite) peripheral compartment</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Presystemic drug metabolite models are only created if route is set to ‘oral’ or ‘ivoral’</p>
</div>
<div class="graphviz"><object data="_images/graphviz-e24bbe0e0b1a83bcbcb81cf308a967b6fa95ad77.svg" type="image/svg+xml" class="graphviz">
<p class="warning">digraph BST {
        node [fontname=&quot;Arial&quot;]
        base [label=&quot;Base model&quot;]
        s1 [label=&quot;Base metabolite&quot;;shape = rect;]
        s2 [label=&quot;Base metabolite with peripheral&quot;]
        s3 [label=&quot;Presystemic metabolite&quot;]
        s4 [label=&quot;Presystemic metabolite with peripheral&quot;]

        base -&gt; s1
        s1 -&gt; s2
        base -&gt; s3
        s3 -&gt; s4
}</p></object></div>
<p>Regarding DVID, DVID=1 is connected to the parent metabolite while DVID=2 is representing the metabolite.</p>
</section>
</section>
<section id="the-search-space">
<span id="id3"></span><h2>The search space<a class="headerlink" href="#the-search-space" title="Link to this heading">#</a></h2>
<p>The model feature search space is a set of possible combinations of model features that will be applied and tested on
the input model. The supported features cover absorption, absorption delay, elimination, and distribution. The search
space is given as a string with a specific grammar, according to the <cite>Model Feature Language</cite> (MFL) (see <a class="reference internal" href="tools.html#mfl"><span class="std std-ref">detailed description</span></a>).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>At the moment a search space is only defined for PKPD models.</p>
</div>
<section id="pkpd">
<h3>PKPD<a class="headerlink" href="#pkpd" title="Link to this heading">#</a></h3>
<p>MFL support the following model features:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Category</p></th>
<th class="head"><p>Options</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>DIRECTEFFECT</p></td>
<td><p><cite>model</cite></p></td>
<td><p>Direct effect PD models.</p></td>
</tr>
<tr class="row-odd"><td><p>EFFECTCOMP</p></td>
<td><p><cite>model</cite></p></td>
<td><p>Effect comprtment PD models.</p></td>
</tr>
<tr class="row-even"><td><p>INDIRECTEFFECT</p></td>
<td><p><cite>model</cite>, <cite>option</cite></p></td>
<td><p>Indirect effect PD models. <cite>option</cite> can be
either production or degradation.</p></td>
</tr>
</tbody>
</table>
<p>The option <cite>model</cite> describes a PKPD model, such as E <sub>max</sub>. For more details
check <a class="reference internal" href="#the-model-types"><span class="std std-ref">model types</span></a>.</p>
<p>To test all direct effect models the search space looks as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DIRECTEFFECT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
</pre></div>
</div>
<p>Search space for testing linear and emax models for direct effect and effect compartment models:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DIRECTEFFECT</span><span class="p">([</span><span class="n">linear</span><span class="p">,</span> <span class="n">emax</span><span class="p">])</span>
<span class="n">EFFECTCOMP</span><span class="p">([</span><span class="n">linear</span><span class="p">,</span> <span class="n">emax</span><span class="p">])</span>
</pre></div>
</div>
</section>
</section>
<section id="the-structsearch-results">
<span id="id4"></span><h2>The Structsearch results<a class="headerlink" href="#the-structsearch-results" title="Link to this heading">#</a></h2>
<p>The results object contains various summary tables which can be accessed in the results object, as well as files in
.csv/.json format. The name of the selected best model (based on the input selection criteria) is also included.</p>
<p>Below is an example for a PKPD run. Drug metabolite results follow the same structure.</p>
<div class="pharmpy-snippet docutils container">
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-1-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-1-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-1-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">run_structsearch</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;pkpd&#39;</span><span class="p">,</span>
                        <span class="n">search_space</span><span class="o">=</span><span class="n">DIRECTEFFECT</span><span class="p">(</span><span class="n">emax</span><span class="p">);</span><span class="n">EFFECTCOMP</span><span class="p">([</span><span class="n">linear</span><span class="p">,</span><span class="n">emax</span><span class="p">])</span><span class="s2">&quot;,</span>
                        <span class="n">model</span><span class="o">=</span><span class="n">start_model</span><span class="p">,</span>
                        <span class="n">results</span><span class="o">=</span><span class="n">start_model_results</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-1-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">res</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">run_structsearch</span><span class="p">(</span><span class="n">type</span><span class="o">=</span><span class="s">&#39;pkpd&#39;</span><span class="p">,</span>
<span class="w">                        </span><span class="n">search_space</span><span class="o">=</span><span class="nf">DIRECTEFFECT</span><span class="p">(</span><span class="n">emax</span><span class="p">);</span><span class="nf">EFFECTCOMP</span><span class="p">([</span><span class="n">linear</span><span class="p">,</span><span class="n">emax</span><span class="p">])</span><span class="s">&quot;</span><span class="err">,</span>
<span class="w">                        </span><span class="n">model</span><span class="o">=</span><span class="n">start_model</span><span class="p">,</span>
<span class="w">                        </span><span class="n">results</span><span class="o">=</span><span class="n">start_model_results</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">summary_tool</span></code> table contains information such as which feature each model candidate has, the difference to the
start model (in this case comparing BIC), and final ranking:</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>description</th>
      <th>n_params</th>
      <th>d_params</th>
      <th>dbic</th>
      <th>bic</th>
      <th>rank</th>
      <th>parent_model</th>
    </tr>
    <tr>
      <th>model</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>structsearch_run2</th>
      <td>EFFECTCOMP_LINEAR</td>
      <td>6</td>
      <td>3</td>
      <td>1.215004</td>
      <td>27.745013</td>
      <td>1</td>
      <td>baseline_model</td>
    </tr>
    <tr>
      <th>structsearch_run1</th>
      <td>DIRECT_EMAX</td>
      <td>6</td>
      <td>3</td>
      <td>1.212603</td>
      <td>27.747413</td>
      <td>2</td>
      <td>baseline_model</td>
    </tr>
    <tr>
      <th>baseline_model</th>
      <td>baseline_model</td>
      <td>3</td>
      <td>0</td>
      <td>0.000000</td>
      <td>28.960017</td>
      <td>3</td>
      <td>baseline_model</td>
    </tr>
    <tr>
      <th>structsearch_run3</th>
      <td>EFFECTCOMP_EMAX</td>
      <td>7</td>
      <td>4</td>
      <td>-0.984380</td>
      <td>29.944396</td>
      <td>4</td>
      <td>baseline_model</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<p>To see information about the actual model runs, such as minimization status, estimation time, and parameter estimates,
you can look at the <code class="docutils literal notranslate"><span class="pre">summary_models</span></code> table. The table is generated with
<a class="reference internal" href="api/pharmpy.tools.summarize_modelfit_results.html#pharmpy.tools.summarize_modelfit_results" title="pharmpy.tools.summarize_modelfit_results"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.tools.summarize_modelfit_results()</span></code></a>.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>description</th>
      <th>minimization_successful</th>
      <th>errors_found</th>
      <th>warnings_found</th>
      <th>ofv</th>
      <th>runtime_total</th>
      <th>estimation_runtime</th>
      <th>TVCL_estimate</th>
      <th>TVV_estimate</th>
      <th>IVCL_estimate</th>
      <th>...</th>
      <th>SIGMA_1_1_estimate</th>
      <th>POP_B_estimate</th>
      <th>IIV_B_estimate</th>
      <th>sigma_estimate</th>
      <th>POP_E_MAX_estimate</th>
      <th>POP_EC_50_estimate</th>
      <th>IIV_E_MAX_estimate</th>
      <th>POP_MET_estimate</th>
      <th>POP_SLOPE_estimate</th>
      <th>IIV_SLOPE_estimate</th>
    </tr>
    <tr>
      <th>step</th>
      <th>model</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <th>pheno_pd_filtered</th>
      <td>PHENOBARB SIMPLE MODEL. Filtered dataset.</td>
      <td>True</td>
      <td>0</td>
      <td>2</td>
      <td>10.213077</td>
      <td>3.0</td>
      <td>0.00</td>
      <td>0.002739</td>
      <td>1.44718</td>
      <td>0.000003</td>
      <td>...</td>
      <td>0.006308</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">1</th>
      <th>baseline_model</th>
      <td>baseline_model</td>
      <td>True</td>
      <td>0</td>
      <td>2</td>
      <td>23.872420</td>
      <td>3.0</td>
      <td>0.02</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>5.750050</td>
      <td>0.000009</td>
      <td>0.338363</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>structsearch_run1</th>
      <td>DIRECT_EMAX</td>
      <td>True</td>
      <td>0</td>
      <td>2</td>
      <td>17.572221</td>
      <td>6.0</td>
      <td>0.04</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.057501</td>
      <td>0.000009</td>
      <td>0.093417</td>
      <td>144566.0</td>
      <td>35393.8</td>
      <td>0.000009</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>structsearch_run2</th>
      <td>EFFECTCOMP_LINEAR</td>
      <td>True</td>
      <td>0</td>
      <td>2</td>
      <td>17.569820</td>
      <td>7.0</td>
      <td>1.90</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.094082</td>
      <td>0.000009</td>
      <td>0.093266</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.099993</td>
      <td>2.47537</td>
      <td>0.000009</td>
    </tr>
    <tr>
      <th>structsearch_run3</th>
      <td>EFFECTCOMP_EMAX</td>
      <td>True</td>
      <td>0</td>
      <td>2</td>
      <td>17.571979</td>
      <td>8.0</td>
      <td>3.55</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.057501</td>
      <td>0.000009</td>
      <td>0.093323</td>
      <td>177469.0</td>
      <td>43433.8</td>
      <td>0.000009</td>
      <td>0.101217</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div></div></div>
</div>
</div>
<p>A summary table of predicted influential individuals and outliers can be seen in <code class="docutils literal notranslate"><span class="pre">summary_individuals_count</span></code>.
See <a class="reference internal" href="api/pharmpy.tools.summarize_individuals_count_table.html#pharmpy.tools.summarize_individuals_count_table" title="pharmpy.tools.summarize_individuals_count_table"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.tools.summarize_individuals_count_table()</span></code></a> for information on the content of this table.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>description</th>
      <th>dbic</th>
      <th>inf_selection</th>
      <th>inf_params</th>
      <th>out_obs</th>
      <th>out_ind</th>
      <th>inf_outlier</th>
      <th>parent_model</th>
    </tr>
    <tr>
      <th>model</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>structsearch_run2</th>
      <td>EFFECTCOMP_LINEAR</td>
      <td>1.215004</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>baseline_model</td>
    </tr>
    <tr>
      <th>structsearch_run1</th>
      <td>DIRECT_EMAX</td>
      <td>1.212603</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>baseline_model</td>
    </tr>
    <tr>
      <th>baseline_model</th>
      <td>baseline_model</td>
      <td>0.000000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>baseline_model</td>
    </tr>
    <tr>
      <th>structsearch_run3</th>
      <td>EFFECTCOMP_EMAX</td>
      <td>-0.984380</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>baseline_model</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<p>You can see different individual statistics in <code class="docutils literal notranslate"><span class="pre">summary_individuals</span></code>.
See <a class="reference internal" href="api/pharmpy.tools.summarize_individuals.html#pharmpy.tools.summarize_individuals" title="pharmpy.tools.summarize_individuals"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.tools.summarize_individuals()</span></code></a> for information on the content of this table.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>description</th>
      <th>parent_model</th>
      <th>outlier_count</th>
      <th>ofv</th>
      <th>dofv_vs_parent</th>
      <th>predicted_dofv</th>
      <th>predicted_residual</th>
    </tr>
    <tr>
      <th>model</th>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">baseline_model</th>
      <th>1</th>
      <td>baseline_model</td>
      <td>baseline_model</td>
      <td>0.0</td>
      <td>11.337360</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>baseline_model</td>
      <td>baseline_model</td>
      <td>0.0</td>
      <td>12.535060</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">structsearch_run1</th>
      <th>1</th>
      <td>DIRECT_EMAX</td>
      <td>baseline_model</td>
      <td>0.0</td>
      <td>9.328655</td>
      <td>2.008705</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>DIRECT_EMAX</td>
      <td>baseline_model</td>
      <td>0.0</td>
      <td>8.243566</td>
      <td>4.291495</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">structsearch_run2</th>
      <th>1</th>
      <td>EFFECTCOMP_LINEAR</td>
      <td>baseline_model</td>
      <td>0.0</td>
      <td>9.355828</td>
      <td>1.981532</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>EFFECTCOMP_LINEAR</td>
      <td>baseline_model</td>
      <td>0.0</td>
      <td>8.213992</td>
      <td>4.321069</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">structsearch_run3</th>
      <th>1</th>
      <td>EFFECTCOMP_EMAX</td>
      <td>baseline_model</td>
      <td>0.0</td>
      <td>9.330943</td>
      <td>2.006418</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>EFFECTCOMP_EMAX</td>
      <td>baseline_model</td>
      <td>0.0</td>
      <td>8.241037</td>
      <td>4.294024</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<p>Finally, you can see a summary of different errors and warnings in <code class="docutils literal notranslate"><span class="pre">summary_errors</span></code>.
See <a class="reference internal" href="api/pharmpy.tools.summarize_errors.html#pharmpy.tools.summarize_errors" title="pharmpy.tools.summarize_errors"><code class="xref py py-func docutils literal notranslate"><span class="pre">pharmpy.tools.summarize_errors()</span></code></a> for information on the content of this table.</p>
<div class="pharmpy-snippet with-output docutils container">
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>time</th>
      <th>message</th>
    </tr>
    <tr>
      <th>model</th>
      <th>category</th>
      <th>error_no</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">baseline_model</th>
      <th rowspan="2" valign="top">WARNING</th>
      <th>0</th>
      <td>2023-09-27 14:01:01.779</td>
      <td>THE NUMBER OF PARAMETERS TO BE ESTIMATED\nEXCEEDS THE NUMBER OF INDIVIDUALS WITH DATA.</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2023-09-27 14:01:01.779</td>
      <td>PARAMETER ESTIMATE IS NEAR ITS BOUNDARY</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">structsearch_run1</th>
      <th rowspan="2" valign="top">WARNING</th>
      <th>0</th>
      <td>2023-09-27 14:01:01.779</td>
      <td>THE NUMBER OF PARAMETERS TO BE ESTIMATED\nEXCEEDS THE NUMBER OF INDIVIDUALS WITH DATA.</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2023-09-27 14:01:01.779</td>
      <td>PARAMETER ESTIMATE IS NEAR ITS BOUNDARY</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">structsearch_run2</th>
      <th rowspan="2" valign="top">WARNING</th>
      <th>0</th>
      <td>2023-09-27 14:01:01.779</td>
      <td>THE NUMBER OF PARAMETERS TO BE ESTIMATED\nEXCEEDS THE NUMBER OF INDIVIDUALS WITH DATA.</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2023-09-27 14:01:01.779</td>
      <td>PARAMETER ESTIMATE IS NEAR ITS BOUNDARY</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">structsearch_run3</th>
      <th rowspan="2" valign="top">WARNING</th>
      <th>0</th>
      <td>2023-09-27 14:01:01.779</td>
      <td>THE NUMBER OF PARAMETERS TO BE ESTIMATED\nEXCEEDS THE NUMBER OF INDIVIDUALS WITH DATA.</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2023-09-27 14:01:01.779</td>
      <td>PARAMETER ESTIMATE IS NEAR ITS BOUNDARY</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="modelsearch.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Modelsearch</p>
      </div>
    </a>
    <a class="right-next"
       href="iivsearch.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">IIVsearch</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running">Running</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#arguments">Arguments</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-model-types">The model types</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pkpd-models">PKPD models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#drug-metabolite">Drug metabolite</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-search-space">The search space</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pkpd">PKPD</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-structsearch-results">The Structsearch results</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=ac02cc09edc035673794"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2018-2023; the Pharmpy development team.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>